<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Babaganoush | Smart Financial Tools</title>
  <meta name="description" content="Free premium financial calculators â€” business valuation, M&A analysis, mortgage calculator, investment returns, RRSP/TFSA optimizer. Built by finance professionals, for everyone." />
  <meta name="keywords" content="financial calculator, business valuation, DCF calculator, mortgage calculator Canada, M&A accretion dilution, RRSP TFSA, investment returns, compound interest" />
  <meta property="og:title" content="Babaganoush | Smart Financial Tools" />
  <meta property="og:description" content="Free premium financial calculators built by finance professionals." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://rajkcho.github.io/Babaganoush/" />
  <meta name="twitter:card" content="summary_large_image" />
  <link rel="canonical" href="https://rajkcho.github.io/Babaganoush/" />
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" />
  
  <!-- Google Analytics (uncomment and replace G-XXXXXXXXXX with your Measurement ID) -->
  <!--
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script>
  -->

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#6366f1" />

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ§®</text></svg>" />

  <!-- Structured Data: WebApplication -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Babaganoush",
    "description": "Free premium financial calculators â€” business valuation, M&A analysis, mortgage calculator, investment returns, RRSP/TFSA optimizer, compound interest, startup runway, net worth tracker.",
    "url": "https://rajkcho.github.io/Babaganoush/",
    "applicationCategory": "FinanceApplication",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "CAD"
    }
  }
  </script>

  <!-- Structured Data: FAQPage -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "Is Babaganoush free to use?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, all financial calculators on Babaganoush are 100% free with no sign-up required."
        }
      },
      {
        "@type": "Question",
        "name": "Is my financial data safe?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Absolutely. All calculations run entirely in your browser. No data is sent to any server â€” your numbers never leave your device."
        }
      },
      {
        "@type": "Question",
        "name": "What calculators are available?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Babaganoush includes 8 professional-grade calculators: Business Valuation (DCF, Multiples, Asset-based), M&A Deal Analyzer, Canadian Mortgage Calculator, Investment Returns (CAGR & DCA), RRSP vs TFSA Optimizer, Compound Interest Visualizer, Startup Runway Calculator, and Net Worth Tracker."
        }
      },
      {
        "@type": "Question",
        "name": "How accurate are the mortgage calculations for Canada?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The mortgage calculator uses Canadian semi-annual compounding as required by law, includes CMHC insurance premiums, provincial land transfer taxes, and OSFI B-20 stress test calculations."
        }
      },
      {
        "@type": "Question",
        "name": "Should I choose RRSP or TFSA?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "It depends on your current vs. expected retirement tax rate. Generally, RRSP is better if your current tax rate is higher than your expected retirement rate. Use our RRSP vs TFSA Optimizer to compare based on your specific situation."
        }
      }
    ]
  }
  </script>
  
  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       BABAGANOUSH â€” Premium Financial Tools
       Design System & Core Styles
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    :root {
      /* Brand Colors */
      --brand-primary: #6366f1;
      --brand-secondary: #8b5cf6;
      --brand-accent: #06b6d4;
      --brand-success: #10b981;
      --brand-warning: #f59e0b;
      --brand-danger: #ef4444;
      
      /* Dark Theme */
      --bg-primary: #0f1117;
      --bg-secondary: #161922;
      --bg-card: #1a1d28;
      --bg-card-hover: #222633;
      --bg-elevated: #1e2230;
      --border-primary: #262a3a;
      --border-hover: #363c52;
      --text-primary: #f4f4f8;
      --text-secondary: #a0a6b8;
      --text-muted: #6c7490;
      --glass-bg: rgba(26, 29, 40, 0.75);
      --glass-border: rgba(255, 255, 255, 0.08);
      
      /* Spacing */
      --space-xs: 0.25rem;
      --space-sm: 0.5rem;
      --space-md: 1rem;
      --space-lg: 1.5rem;
      --space-xl: 2rem;
      --space-2xl: 3rem;
      --space-3xl: 4rem;
      
      /* Radius */
      --radius-sm: 0.5rem;
      --radius-md: 0.75rem;
      --radius-lg: 1rem;
      --radius-xl: 1.5rem;
      --radius-full: 9999px;
      
      /* Shadows */
      --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 8px 30px rgba(0, 0, 0, 0.5);
      --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.6);
      --shadow-glow: 0 0 30px rgba(99, 102, 241, 0.15);
      --shadow-glow-accent: 0 0 30px rgba(6, 182, 212, 0.15);
    }
    
    /* Light Theme */
    .light {
      --bg-primary: #f8f9fc;
      --bg-secondary: #ffffff;
      --bg-card: #ffffff;
      --bg-card-hover: #f5f6fa;
      --bg-elevated: #f0f1f5;
      --border-primary: #e2e4ec;
      --border-hover: #c8ccd8;
      --text-primary: #1a1d2e;
      --text-secondary: #525872;
      --text-muted: #8b90a5;
      --glass-bg: rgba(255, 255, 255, 0.85);
      --glass-border: rgba(99, 102, 241, 0.08);
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.08);
      --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.1);
      --shadow-glow: 0 0 30px rgba(99, 102, 241, 0.06);
    }
    
    /* â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    
    html {
      scroll-behavior: smooth;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
      transition: background-color 0.4s ease, color 0.4s ease;
    }
    
    /* â”€â”€ Scrollbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg-secondary); }
    ::-webkit-scrollbar-thumb { background: var(--border-hover); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--brand-primary); }
    
    /* â”€â”€ Typography â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    h1, h2, h3, h4, h5, h6 {
      font-weight: 700;
      line-height: 1.2;
      letter-spacing: -0.02em;
    }
    
    .mono { font-family: 'JetBrains Mono', monospace; }
    
    .gradient-text {
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary), var(--brand-accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    /* â”€â”€ Animations â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.1); }
      50% { box-shadow: 0 0 40px rgba(99, 102, 241, 0.25); }
    }
    
    @keyframes gradient-shift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    @keyframes orbit {
      from { transform: rotate(0deg) translateX(60px) rotate(0deg); }
      to { transform: rotate(360deg) translateX(60px) rotate(-360deg); }
    }
    
    @keyframes counter-orbit {
      from { transform: rotate(0deg) translateX(40px) rotate(0deg); }
      to { transform: rotate(-360deg) translateX(40px) rotate(360deg); }
    }
    
    @keyframes morphBlob {
      0%, 100% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
      25% { border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%; }
      50% { border-radius: 50% 60% 30% 60% / 30% 70% 60% 40%; }
      75% { border-radius: 60% 30% 60% 40% / 60% 40% 30% 70%; }
    }
    
    @keyframes typewriter {
      from { width: 0; }
      to { width: 100%; }
    }
    
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
    
    @keyframes countUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes ripple {
      0% { transform: scale(0); opacity: 0.6; }
      100% { transform: scale(4); opacity: 0; }
    }
    
    @keyframes borderGlow {
      0%, 100% { border-color: rgba(99, 102, 241, 0.2); }
      50% { border-color: rgba(99, 102, 241, 0.5); }
    }
    
    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .animate-fade-up { animation: fadeInUp 0.6s ease both; }
    .animate-fade-up-1 { animation: fadeInUp 0.6s ease 0.1s both; }
    .animate-fade-up-2 { animation: fadeInUp 0.6s ease 0.2s both; }
    .animate-fade-up-3 { animation: fadeInUp 0.6s ease 0.3s both; }
    .animate-fade-up-4 { animation: fadeInUp 0.6s ease 0.4s both; }
    .animate-fade-in { animation: fadeIn 0.6s ease both; }
    .animate-scale-in { animation: scaleIn 0.5s ease both; }
    .animate-slide-left { animation: slideInLeft 0.6s ease both; }
    .animate-slide-right { animation: slideInRight 0.6s ease both; }
    
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    
    /* â”€â”€ Glass Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .glass-card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      transition: all 0.3s ease;
    }
    
    .glass-card:hover {
      border-color: var(--border-hover);
      box-shadow: var(--shadow-lg);
    }
    
    /* â”€â”€ Tool Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tool-card {
      background: var(--bg-card);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-lg);
      padding: 1.25rem;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }
    
    .tool-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary), var(--brand-accent));
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .tool-card:hover {
      transform: translateY(-4px);
      border-color: var(--border-hover);
      box-shadow: var(--shadow-xl), var(--shadow-glow);
      background: var(--bg-card-hover);
    }
    
    .tool-card:hover::before { opacity: 1; }
    
    .tool-card .tool-icon {
      width: 56px;
      height: 56px;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      transition: transform 0.3s ease;
    }
    
    .tool-card:hover .tool-icon { transform: scale(1.1) rotate(-3deg); }
    
    /* â”€â”€ Button System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      border-radius: var(--radius-md);
      font-weight: 600;
      font-size: 0.875rem;
      border: none;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      text-decoration: none;
    }
    
    .btn::after {
      content: '';
      position: absolute;
      inset: 0;
      background: white;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .btn:hover::after { opacity: 0.1; }
    .btn:active { transform: scale(0.97); }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
      color: white;
      box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }
    
    .btn-primary:hover {
      box-shadow: 0 6px 25px rgba(99, 102, 241, 0.4);
      transform: translateY(-1px);
    }
    
    .btn-secondary {
      background: var(--bg-card);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
    }
    
    .btn-secondary:hover {
      background: var(--bg-card-hover);
      border-color: var(--border-hover);
    }
    
    .btn-ghost {
      background: transparent;
      color: var(--text-secondary);
    }
    
    .btn-ghost:hover { color: var(--text-primary); }
    
    .btn-lg { padding: 1rem 2rem; font-size: 1rem; border-radius: var(--radius-lg); }
    .btn-sm { padding: 0.5rem 1rem; font-size: 0.8rem; }
    
    /* â”€â”€ Input System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .input-group {
      display: flex;
      flex-direction: column;
      gap: 0.375rem;
    }
    
    .input-group label {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .input-group input, .input-group select {
      background: var(--bg-secondary);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-md);
      padding: 0.75rem 1rem;
      color: var(--text-primary);
      font-size: 0.95rem;
      font-family: 'JetBrains Mono', monospace;
      transition: all 0.3s ease;
      width: 100%;
    }
    
    .input-group input:focus, .input-group select:focus {
      outline: none;
      border-color: var(--brand-primary);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
    }
    
    .input-group input::placeholder { color: var(--text-muted); }
    
    .input-help {
      font-size: 0.72rem;
      color: var(--text-muted);
      margin-top: 0.125rem;
    }
    
    /* â”€â”€ Range Slider â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 6px;
      background: var(--border-primary);
      border-radius: 3px;
      outline: none;
      cursor: pointer;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
      box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    
    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.2);
    }
    
    /* â”€â”€ Result Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .result-card {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.08), rgba(139, 92, 246, 0.05));
      border: 1px solid rgba(99, 102, 241, 0.2);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      animation: scaleIn 0.4s ease both;
    }
    
    .result-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .result-label {
      font-size: 0.8rem;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 600;
    }
    
    /* â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .nav-bar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      background: var(--glass-bg);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border-bottom: 1px solid var(--glass-border);
      padding: 0.75rem 1.5rem;
      transition: all 0.3s ease;
      animation: fadeInDown 0.6s ease both;
    }
    
    .nav-bar.scrolled {
      box-shadow: var(--shadow-md);
    }
    
    .nav-inner {
      max-width: 1280px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .nav-logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
      font-weight: 800;
      font-size: 1.1rem;
      color: var(--text-primary);
    }
    
    .nav-logo-icon {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-sm);
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      color: white;
      font-weight: 800;
    }
    
    .nav-links {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      list-style: none;
    }
    
    .nav-links a {
      padding: 0.5rem 0.75rem;
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.85rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .nav-links a:hover, .nav-links a.active {
      color: var(--text-primary);
      background: rgba(99, 102, 241, 0.1);
    }
    
    .nav-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .theme-toggle {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-primary);
      background: var(--bg-card);
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      transition: all 0.3s ease;
    }
    
    .theme-toggle:hover {
      background: var(--bg-card-hover);
      color: var(--text-primary);
      border-color: var(--border-hover);
    }
    
    /* Mobile nav */
    .mobile-menu-btn {
      display: none;
      width: 40px;
      height: 40px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-primary);
      background: var(--bg-card);
      color: var(--text-primary);
      cursor: pointer;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }
    
    @media (max-width: 768px) {
      .nav-links { display: none; }
      .mobile-menu-btn { display: flex; }
      .nav-links.mobile-open {
        display: flex;
        flex-direction: column;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--bg-secondary);
        border-bottom: 1px solid var(--border-primary);
        padding: 1rem;
        gap: 0.25rem;
      }
      .nav-links.mobile-open a {
        padding: 0.75rem 1rem;
        width: 100%;
      }
    }
    
    /* â”€â”€ Hero Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .hero {
      min-height: 85vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 7rem 2rem 3rem;
      position: relative;
      overflow: hidden;
    }
    
    .hero-bg {
      position: absolute;
      inset: 0;
      z-index: 0;
    }
    
    .hero-blob {
      position: absolute;
      border-radius: 50%;
      filter: blur(80px);
      opacity: 0.12;
    }
    
    .light .hero-blob {
      opacity: 0.08;
      filter: blur(100px);
    }
    
    .hero-blob-1 {
      width: 600px;
      height: 600px;
      background: var(--brand-primary);
      top: -200px;
      right: -100px;
      animation: morphBlob 20s ease-in-out infinite;
    }
    
    .hero-blob-2 {
      width: 400px;
      height: 400px;
      background: var(--brand-accent);
      bottom: -100px;
      left: -50px;
      animation: morphBlob 15s ease-in-out infinite reverse;
    }
    
    .hero-blob-3 {
      width: 300px;
      height: 300px;
      background: var(--brand-secondary);
      top: 40%;
      left: 50%;
      animation: morphBlob 25s ease-in-out infinite 5s;
    }
    
    /* Grid pattern */
    .hero-grid {
      position: absolute;
      inset: 0;
      background-image: 
        linear-gradient(rgba(99, 102, 241, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(99, 102, 241, 0.03) 1px, transparent 1px);
      background-size: 60px 60px;
      mask-image: radial-gradient(ellipse at center, black 30%, transparent 70%);
      -webkit-mask-image: radial-gradient(ellipse at center, black 30%, transparent 70%);
    }
    
    .hero-content {
      position: relative;
      z-index: 1;
      max-width: 800px;
    }
    
    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      background: rgba(99, 102, 241, 0.1);
      border: 1px solid rgba(99, 102, 241, 0.2);
      border-radius: var(--radius-full);
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--brand-primary);
      margin-bottom: 1.5rem;
      animation: fadeInUp 0.6s ease both;
    }
    
    .hero-badge .pulse-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--brand-success);
      animation: pulse-glow 2s ease-in-out infinite;
    }
    
    .hero h1 {
      font-size: clamp(2.5rem, 6vw, 4.5rem);
      font-weight: 900;
      letter-spacing: -0.03em;
      margin-bottom: 1.25rem;
      line-height: 1.05;
      animation: fadeInUp 0.6s ease 0.1s both;
    }
    
    .hero p {
      font-size: clamp(1rem, 2vw, 1.25rem);
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto 2rem;
      line-height: 1.7;
      animation: fadeInUp 0.6s ease 0.2s both;
    }
    
    .hero-cta {
      display: flex;
      align-items: center;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      animation: fadeInUp 0.6s ease 0.3s both;
    }
    
    .hero-stats {
      display: flex;
      gap: 3rem;
      margin-top: 4rem;
      animation: fadeInUp 0.6s ease 0.4s both;
    }
    
    .hero-stat {
      text-align: center;
    }
    
    .hero-stat-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--text-primary);
    }
    
    .hero-stat-label {
      font-size: 0.75rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-top: 0.25rem;
    }
    
    @media (max-width: 640px) {
      .hero-stats { gap: 1.5rem; }
      .hero-stat-value { font-size: 1.25rem; }
    }
    
    /* â”€â”€ Sections â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .section {
      padding: 4rem 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .section-header {
      text-align: center;
      margin-bottom: 2.5rem;
    }
    
    .section-label {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--brand-primary);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 0.75rem;
    }
    
    .section-label .label-line {
      width: 24px;
      height: 2px;
      background: linear-gradient(90deg, var(--brand-primary), var(--brand-accent));
      border-radius: 1px;
    }
    
    .section-title {
      font-size: clamp(1.75rem, 4vw, 2.5rem);
      letter-spacing: -0.03em;
      margin-bottom: 0.75rem;
    }
    
    .section-desc {
      font-size: 1.05rem;
      color: var(--text-secondary);
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* â”€â”€ Tools Grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.25rem;
    }
    
    @media (max-width: 640px) {
      .tools-grid { grid-template-columns: 1fr; }
    }
    
    /* â”€â”€ Calculator Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .calc-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }
    
    .calc-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .calc-back {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.85rem;
      font-weight: 500;
      margin-bottom: 1rem;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    
    .calc-back:hover { color: var(--text-primary); }
    
    .calc-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }
    
    .calc-inputs {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    .calc-results {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    
    @media (max-width: 768px) {
      .calc-grid { grid-template-columns: 1fr; }
    }
    
    /* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .footer {
      border-top: 1px solid var(--border-primary);
      padding: 3rem 1.5rem;
      text-align: center;
    }
    
    .footer-content {
      max-width: 1280px;
      margin: 0 auto;
    }
    
    .footer-brand {
      font-weight: 800;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }
    
    .footer-text {
      font-size: 0.8rem;
      color: var(--text-muted);
      max-width: 500px;
      margin: 0 auto 1.5rem;
      line-height: 1.7;
    }
    
    .footer-links {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .footer-links a {
      font-size: 0.8rem;
      color: var(--text-muted);
      text-decoration: none;
      transition: color 0.3s ease;
    }
    
    .footer-links a:hover { color: var(--text-primary); }
    
    /* â”€â”€ Utility â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
    
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }
    
    /* â”€â”€ Tab System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tabs {
      display: flex;
      gap: 0.25rem;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      padding: 0.25rem;
      border: 1px solid var(--border-primary);
    }
    
    .tab {
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-secondary);
      background: transparent;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
      flex: 1;
      text-align: center;
    }
    
    .tab:hover { color: var(--text-primary); }
    
    .tab.active {
      background: var(--brand-primary);
      color: white;
      box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
    }
    
    /* â”€â”€ Metric pill â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .metric-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.375rem;
      padding: 0.375rem 0.75rem;
      border-radius: var(--radius-full);
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'JetBrains Mono', monospace;
    }
    
    .metric-pill.positive {
      background: rgba(16, 185, 129, 0.1);
      color: var(--brand-success);
      border: 1px solid rgba(16, 185, 129, 0.2);
    }
    
    .metric-pill.negative {
      background: rgba(239, 68, 68, 0.1);
      color: var(--brand-danger);
      border: 1px solid rgba(239, 68, 68, 0.2);
    }
    
    .metric-pill.neutral {
      background: rgba(99, 102, 241, 0.1);
      color: var(--brand-primary);
      border: 1px solid rgba(99, 102, 241, 0.2);
    }
    
    /* â”€â”€ Divider â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .divider {
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--border-primary), transparent);
      margin: 2rem 0;
    }
    
    /* â”€â”€ Tooltip â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tooltip-wrapper {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .tooltip-icon {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--border-primary);
      color: var(--text-muted);
      font-size: 0.6rem;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: help;
    }
    
    .tooltip-wrapper:hover .tooltip-content {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
    }
    
    .tooltip-content {
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%) translateY(5px);
      background: var(--bg-elevated);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-sm);
      padding: 0.5rem 0.75rem;
      font-size: 0.72rem;
      color: var(--text-secondary);
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s ease;
      z-index: 10;
      box-shadow: var(--shadow-lg);
      max-width: 250px;
      white-space: normal;
    }
    
    /* â”€â”€ Chart Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .chart-container {
      background: var(--bg-card);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      margin: 1rem 0;
    }
    
    .chart-bar {
      height: 8px;
      border-radius: 4px;
      background: var(--border-primary);
      overflow: hidden;
      margin: 0.5rem 0;
    }
    
    .chart-bar-fill {
      height: 100%;
      border-radius: 4px;
      transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
      background: linear-gradient(90deg, var(--brand-primary), var(--brand-accent));
    }
    
    /* â”€â”€ Sensitivity Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .sensitivity-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
    }
    
    .sensitivity-table th {
      background: var(--bg-elevated);
      color: var(--text-secondary);
      font-weight: 600;
      padding: 0.625rem 0.75rem;
      text-align: center;
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 1px solid var(--border-primary);
    }
    
    .sensitivity-table th:first-child {
      border-radius: var(--radius-sm) 0 0 0;
      text-align: left;
    }
    
    .sensitivity-table th:last-child {
      border-radius: 0 var(--radius-sm) 0 0;
    }
    
    .sensitivity-table td {
      padding: 0.5rem 0.75rem;
      text-align: center;
      border-bottom: 1px solid var(--border-primary);
      transition: background 0.2s ease;
    }
    
    .sensitivity-table td:first-child {
      text-align: left;
      font-weight: 600;
      color: var(--text-secondary);
    }
    
    .sensitivity-table tr:hover td {
      background: rgba(99, 102, 241, 0.05);
    }
    
    .sensitivity-table .highlight {
      background: rgba(99, 102, 241, 0.1);
      font-weight: 700;
      color: var(--brand-primary);
    }
    
    .sensitivity-table .positive-val { color: var(--brand-success); }
    .sensitivity-table .negative-val { color: var(--brand-danger); }
    
    /* â”€â”€ Notification Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      z-index: 200;
      background: var(--bg-elevated);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-md);
      padding: 1rem 1.5rem;
      box-shadow: var(--shadow-xl);
      animation: slideInRight 0.4s ease both;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.85rem;
    }
    
    .toast.hidden { display: none; }
    
    /* â”€â”€ Page transitions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .page { display: none; }
    .page.active { display: block; animation: fadeIn 0.4s ease both; }
    
    /* â”€â”€ Intersection Observer reveals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .reveal {
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .reveal.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    /* â”€â”€ Noise overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .noise::before {
      content: '';
      position: fixed;
      inset: 0;
      opacity: 0.015;
      pointer-events: none;
      z-index: 1000;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    }
    
    /* â”€â”€ Gradient border card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .gradient-border-card {
      position: relative;
      border-radius: var(--radius-xl);
      padding: 1px;
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary), var(--brand-accent));
      background-size: 200% 200%;
      animation: gradient-shift 6s ease infinite;
    }
    
    .gradient-border-card-inner {
      background: var(--bg-card);
      border-radius: calc(var(--radius-xl) - 1px);
      padding: var(--space-xl);
    }
    
    /* â”€â”€ Accordion â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .accordion-item {
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-md);
      margin-bottom: 0.5rem;
      overflow: hidden;
    }
    
    .accordion-header {
      padding: 1rem 1.25rem;
      background: var(--bg-card);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-weight: 600;
      font-size: 0.9rem;
      transition: background 0.3s ease;
    }
    
    .accordion-header:hover { background: var(--bg-card-hover); }
    
    .accordion-arrow {
      transition: transform 0.3s ease;
      color: var(--text-muted);
    }
    
    .accordion-item.open .accordion-arrow {
      transform: rotate(180deg);
    }
    
    .accordion-body {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease;
    }
    
    .accordion-item.open .accordion-body {
      max-height: 2000px;
    }
    
    .accordion-body-inner {
      padding: 1rem 1.25rem;
      border-top: 1px solid var(--border-primary);
    }
    
    /* â”€â”€ How It Works â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .how-it-works-steps {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 0;
      position: relative;
      padding: 2rem 0;
    }
    .how-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      flex: 1;
      max-width: 260px;
      position: relative;
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .how-step.visible { opacity: 1; transform: translateY(0); }
    .how-step:nth-child(2) { transition-delay: 0.15s; }
    .how-step:nth-child(3) { transition-delay: 0.3s; }
    .how-step-num {
      width: 64px; height: 64px; border-radius: 50%;
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
      color: white; font-size: 1.5rem; font-weight: 800;
      display: flex; align-items: center; justify-content: center;
      position: relative; z-index: 2;
      box-shadow: 0 4px 20px rgba(99, 102, 241, 0.3);
    }
    .how-step h3 { font-size: 1.05rem; margin: 1rem 0 0.5rem; }
    .how-step p { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6; }
    .how-connector {
      position: absolute; top: 32px; left: calc(50% + 32px); right: calc(-50% + 32px);
      height: 2px;
      background: linear-gradient(90deg, var(--brand-primary), var(--brand-accent));
      opacity: 0.3; z-index: 1;
    }
    .how-step:last-child .how-connector { display: none; }
    @media (max-width: 640px) {
      .how-it-works-steps { flex-direction: column; align-items: center; gap: 2rem; }
      .how-connector { display: none; }
    }

    /* â”€â”€ Testimonials â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .testimonial-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    .testimonial-card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      padding: var(--space-xl);
      transition: all 0.3s ease;
    }
    .testimonial-card:hover {
      border-color: var(--border-hover);
      box-shadow: var(--shadow-lg), var(--shadow-glow);
      transform: translateY(-2px);
    }
    .testimonial-stars { color: #f59e0b; font-size: 0.9rem; margin-bottom: 0.75rem; }
    .testimonial-quote { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.7; margin-bottom: 1.25rem; font-style: italic; }
    .testimonial-author { display: flex; align-items: center; gap: 0.75rem; }
    .testimonial-avatar {
      width: 40px; height: 40px; border-radius: 50%;
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
      color: white; font-weight: 700; font-size: 0.8rem;
      display: flex; align-items: center; justify-content: center;
    }
    .testimonial-name { font-size: 0.85rem; font-weight: 600; }
    .testimonial-role { font-size: 0.72rem; color: var(--text-muted); }

    /* â”€â”€ Newsletter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .newsletter-section {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.08), rgba(139, 92, 246, 0.05));
      border: 1px solid rgba(99, 102, 241, 0.15);
      border-radius: var(--radius-xl);
      padding: var(--space-3xl) var(--space-xl);
      text-align: center;
      max-width: 640px;
      margin: 0 auto;
    }
    .newsletter-form {
      display: flex; gap: 0.5rem; max-width: 420px; margin: 1.5rem auto 0;
    }
    .newsletter-form input {
      flex: 1; padding: 0.75rem 1rem; border-radius: var(--radius-md);
      border: 1px solid var(--border-primary); background: var(--bg-secondary);
      color: var(--text-primary); font-size: 0.9rem; font-family: inherit;
    }
    .newsletter-form input:focus { outline: none; border-color: var(--brand-primary); box-shadow: 0 0 0 3px rgba(99,102,241,0.15); }
    .newsletter-social-proof { font-size: 0.75rem; color: var(--text-muted); margin-top: 0.75rem; }
    @media (max-width: 480px) { .newsletter-form { flex-direction: column; } }

    /* â”€â”€ FAQ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .faq-list { max-width: 720px; margin: 0 auto; }

    /* â”€â”€ Cookie Banner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .cookie-banner {
      position: fixed; bottom: 0; left: 0; right: 0; z-index: 300;
      background: var(--bg-elevated);
      border-top: 1px solid var(--border-primary);
      padding: 1rem 1.5rem;
      display: flex; align-items: center; justify-content: center; gap: 1rem;
      font-size: 0.85rem; color: var(--text-secondary);
      animation: fadeInUp 0.4s ease both;
      box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
    }
    .cookie-banner.hidden { display: none; }
    .cookie-banner-btns { display: flex; gap: 0.5rem; }
    @media (max-width: 640px) {
      .cookie-banner { flex-direction: column; text-align: center; gap: 0.75rem; }
    }

    /* â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .toast-success {
      position: fixed; bottom: 2rem; right: 2rem; z-index: 400;
      background: var(--bg-elevated); border: 1px solid rgba(16,185,129,0.3);
      border-radius: var(--radius-md); padding: 1rem 1.5rem;
      box-shadow: var(--shadow-xl); animation: slideInRight 0.4s ease both;
      font-size: 0.85rem; color: var(--brand-success); display: flex; align-items: center; gap: 0.5rem;
    }

    /* â”€â”€ Progress Ring â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .progress-ring {
      transform: rotate(-90deg);
    }
    
    .progress-ring-bg {
      stroke: var(--border-primary);
      fill: none;
    }
    
    .progress-ring-fill {
      fill: none;
      stroke-linecap: round;
      transition: stroke-dashoffset 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* â”€â”€ Scroll Progress Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #scroll-progress {
      position: fixed;
      top: 0;
      left: 0;
      width: 0%;
      height: 3px;
      background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary), var(--brand-accent));
      z-index: 9999;
      transition: width 0.1s linear;
      pointer-events: none;
    }

    /* â”€â”€ Input Ripple Effect â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .input-group input,
    .input-group select {
      position: relative;
    }
    .input-group {
      position: relative;
    }
    .input-group .input-ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(99, 102, 241, 0.25);
      transform: scale(0);
      animation: ripple 0.6s ease-out forwards;
      pointer-events: none;
      z-index: 1;
    }

    /* â”€â”€ Page Fade Transitions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .page.fade-out {
      animation: pageFadeOut 0.15s ease forwards;
    }
    .page.fade-in {
      animation: pageFadeIn 0.25s ease forwards;
    }
    @keyframes pageFadeOut {
      from { opacity: 1; transform: translateY(0); }
      to { opacity: 0; transform: translateY(-8px); }
    }
    @keyframes pageFadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* â”€â”€ Loading Skeleton â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .skeleton-overlay {
      position: absolute;
      inset: 0;
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      z-index: 5;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      padding: var(--space-lg);
    }
    .skeleton-line {
      height: 16px;
      border-radius: 4px;
      background: linear-gradient(90deg, var(--border-primary) 25%, var(--bg-elevated) 50%, var(--border-primary) 75%);
      background-size: 200% 100%;
      animation: shimmer 1.5s ease infinite;
    }
    .skeleton-line.short { width: 60%; }
    .skeleton-line.medium { width: 80%; }
    .skeleton-line.tall { height: 48px; width: 50%; }

    /* â”€â”€ Chart Bar Tooltips â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .chart-bar-tooltip {
      position: relative;
      cursor: pointer;
    }
    .chart-bar-tooltip::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: calc(100% + 6px);
      left: 50%;
      transform: translateX(-50%) scale(0.8);
      background: var(--bg-elevated);
      color: var(--text-primary);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-sm);
      padding: 0.25rem 0.5rem;
      font-size: 0.65rem;
      font-family: 'JetBrains Mono', monospace;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: all 0.2s ease;
      box-shadow: var(--shadow-md);
      z-index: 10;
    }
    .chart-bar-tooltip:hover::after {
      opacity: 1;
      transform: translateX(-50%) scale(1);
    }

    /* â”€â”€ Confetti Easter Egg â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @keyframes confettiFall {
      0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    .confetti-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 10000;
      overflow: hidden;
    }
    .confetti-piece {
      position: absolute;
      width: 8px;
      height: 8px;
      top: -10px;
      animation: confettiFall 3s ease-in forwards;
    }

    /* Affiliate CTA banners */
    .affiliate-cta {
      margin-top: 1rem;
      padding: 0.75rem 1rem;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-md);
      backdrop-filter: blur(12px);
      font-size: 0.8rem;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .affiliate-cta .ad-label {
      font-size: 0.6rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-muted);
      border: 1px solid var(--border-primary);
      padding: 0.1rem 0.35rem;
      border-radius: 3px;
      flex-shrink: 0;
    }
    .affiliate-cta a {
      color: var(--brand-accent);
      text-decoration: none;
      font-weight: 500;
    }
    .affiliate-cta a:hover { text-decoration: underline; }

    /* â”€â”€ Print / PDF Export â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media print {
      body { background: white !important; color: black !important; font-size: 12pt; }
      .nav-bar, .cookie-banner, .no-print, .footer, .btn, .action-buttons,
      .theme-toggle, .mobile-menu-btn, .newsletter-section, .hero-cta { display: none !important; }
      * { box-shadow: none !important; text-shadow: none !important; }
      .page { display: block !important; }
      .glass-card, .result-card, .tool-card { background: white !important; border: 1px solid #ddd !important; break-inside: avoid; }
      .section, .calc-container { page-break-inside: avoid; }
      h1, h2, h3 { page-break-after: avoid; color: #1a1a2e !important; -webkit-text-fill-color: #1a1a2e !important; }
      .result-value { -webkit-text-fill-color: #333 !important; color: #333 !important; }
      a { text-decoration: underline; color: #333 !important; }
      @page { margin: 2cm; }
      .page.active::before {
        content: "Babaganoush â€” Smart Financial Tools";
        display: block; text-align: center; font-size: 14pt; font-weight: 700;
        color: #6366f1; border-bottom: 2px solid #6366f1; padding-bottom: 0.5rem; margin-bottom: 1.5rem;
      }
    }
    .action-buttons { display: flex; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap; }
    .action-buttons .btn { font-size: 0.78rem; padding: 0.5rem 1rem; }

    /* â”€â”€ Accessibility â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .skip-to-content {
      position: absolute;
      top: -100%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--brand-primary);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 0 0 var(--radius-md) var(--radius-md);
      z-index: 10000;
      font-weight: 600;
      font-size: 0.9rem;
      text-decoration: none;
      transition: top 0.2s ease;
    }
    .skip-to-content:focus {
      top: 0;
    }

    /* Focus-visible outlines for all interactive elements */
    a:focus-visible,
    button:focus-visible,
    input:focus-visible,
    select:focus-visible,
    [tabindex]:focus-visible {
      outline: 2px solid var(--brand-primary);
      outline-offset: 2px;
    }

    /* â”€â”€ Mobile Optimization â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 768px) {
      .section { padding: 3rem 1rem; }
      .calc-container { padding: 1.5rem 1rem; }
      .glass-card { padding: var(--space-lg) !important; }
      .btn { width: 100%; }
      .hero-cta .btn { width: auto; min-width: 140px; }
      .action-buttons .btn { flex: 1; min-width: 120px; }
      .tools-grid { grid-template-columns: 1fr; }
      [style*="grid-template-columns: repeat(3"] { grid-template-columns: 1fr !important; }
      [style*="grid-template-columns: 1fr 1fr 1fr"] { grid-template-columns: 1fr !important; }
      .testimonial-grid { grid-template-columns: 1fr; }
      .result-value { font-size: 1.5rem; }
      #page-networth [style*="grid-template-columns: 1fr 1fr 1fr"] { grid-template-columns: 1fr !important; }
      #page-networth [style*="grid-template-columns: 1fr 1fr;"] { grid-template-columns: 1fr !important; }
    }

    /* Touch-friendly sliders (44px min touch target) */
    input[type="range"] {
      height: 8px;
      padding: 18px 0;
      margin: 0;
      box-sizing: content-box;
    }
    input[type="range"]::-webkit-slider-thumb {
      width: 28px;
      height: 28px;
    }
    input[type="range"]::-moz-range-thumb {
      width: 28px;
      height: 28px;
      border: none;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
      box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
      cursor: pointer;
    }

    /* â”€â”€ Performance: will-change on animated elements â”€â”€ */
    .hero-blob { will-change: transform; }
    .tool-card { will-change: transform; }
    .animate-fade-up, .animate-scale-in { will-change: transform, opacity; }

    /* â”€â”€ Keyboard Shortcuts Help Overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .shortcuts-overlay {
      position: fixed;
      inset: 0;
      z-index: 10000;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.2s ease;
    }
    .shortcuts-overlay.hidden { display: none; }
    .shortcuts-card {
      background: var(--bg-card);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-xl);
      padding: 2rem;
      max-width: 420px;
      width: 90%;
      box-shadow: var(--shadow-xl);
    }
    .shortcuts-card h2 { font-size: 1.25rem; margin-bottom: 1.25rem; }
    .shortcut-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--border-primary);
      font-size: 0.85rem;
    }
    .shortcut-row:last-child { border-bottom: none; }
    .shortcut-key {
      display: inline-block;
      background: var(--bg-elevated);
      border: 1px solid var(--border-primary);
      border-radius: 4px;
      padding: 0.15rem 0.5rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      font-weight: 600;
      min-width: 28px;
      text-align: center;
    }
  </style>
</head>
<body class="noise">
  <!-- Skip to Content (Accessibility) -->
  <a href="#main-content" class="skip-to-content">Skip to main content</a>

  <!-- Keyboard Shortcuts Overlay -->
  <div class="shortcuts-overlay hidden" id="shortcuts-overlay" role="dialog" aria-label="Keyboard shortcuts" onclick="if(event.target===this)this.classList.add('hidden')">
    <div class="shortcuts-card">
      <h2>âŒ¨ï¸ Keyboard Shortcuts</h2>
      <div class="shortcut-row"><span>Show this help</span><span class="shortcut-key">?</span></div>
      <div class="shortcut-row"><span>Business Valuation</span><span class="shortcut-key">1</span></div>
      <div class="shortcut-row"><span>M&A Analyzer</span><span class="shortcut-key">2</span></div>
      <div class="shortcut-row"><span>Mortgage Calculator</span><span class="shortcut-key">3</span></div>
      <div class="shortcut-row"><span>Investment Returns</span><span class="shortcut-key">4</span></div>
      <div class="shortcut-row"><span>RRSP vs TFSA</span><span class="shortcut-key">5</span></div>
      <div class="shortcut-row"><span>Compound Interest</span><span class="shortcut-key">6</span></div>
      <div class="shortcut-row"><span>Startup Runway</span><span class="shortcut-key">7</span></div>
      <div class="shortcut-row"><span>Net Worth Tracker</span><span class="shortcut-key">8</span></div>
      <div class="shortcut-row"><span>Back to Home</span><span class="shortcut-key">Esc</span></div>
      <div class="shortcut-row"><span>Toggle Dark/Light</span><span class="shortcut-key">D</span></div>
    </div>
  </div>

  <!-- Scroll Progress Bar -->
  <div id="scroll-progress"></div>

  <!-- Navigation -->
  <nav class="nav-bar" id="navbar">
    <div class="nav-inner">
      <a href="#" class="nav-logo" onclick="showPage('home'); return false;">
        <div class="nav-logo-icon">B</div>
        <span>Babaganoush</span>
      </a>
      
      <ul class="nav-links" id="nav-links">
        <li><a href="#tools" onclick="showPage('home')">Tools</a></li>
        <li><a href="#" onclick="showPage('valuation'); return false;">Valuation</a></li>
        <li><a href="#" onclick="showPage('mortgage'); return false;">Mortgage</a></li>
        <li><a href="#" onclick="showPage('investment'); return false;">Investment</a></li>
        <li><a href="#" onclick="showPage('retirement'); return false;">Retirement</a></li>
        <li><a href="#" onclick="showPage('compound'); return false;">Compound</a></li>
        <li><a href="#" onclick="showPage('salary'); return false;">Salary</a></li>
        <li><a href="#" onclick="showPage('debt'); return false;">Debt</a></li>
        <li><a href="#" onclick="showPage('compare'); return false;">Compare</a></li>
        <li><a href="#" onclick="showPage('currency'); return false;">Currency</a></li>
      </ul>
      
      <div class="nav-actions">
        <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">ğŸŒ™</button>
        <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Menu">â˜°</button>
      </div>
    </div>
  </nav>
  
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HOME PAGE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <main id="main-content">
  <div class="page active" id="page-home">
    
    <!-- Hero -->
    <section class="hero" id="hero">
      <div class="hero-bg">
        <div class="hero-blob hero-blob-1"></div>
        <div class="hero-blob hero-blob-2"></div>
        <div class="hero-blob hero-blob-3"></div>
        <div class="hero-grid"></div>
      </div>
      
      <div class="hero-content">
        <div class="hero-badge">
          <span class="pulse-dot"></span>
          Free Forever Â· No Sign-up Required
        </div>
        
        <h1>
          Financial tools that<br />
          <span class="gradient-text">actually make sense</span>
        </h1>
        
        <p>
          Professional-grade calculators for business valuation, M&A analysis, 
          mortgage planning, and investment returns. Built by finance professionals 
          with 15+ years of experience.
        </p>
        
        <div class="hero-cta">
          <a href="#tools" class="btn btn-primary btn-lg">
            Explore Tools â†’
          </a>
          <a href="#about" class="btn btn-secondary btn-lg">
            Learn More
          </a>
        </div>
        
        <div class="hero-stats">
          <div class="hero-stat">
            <div class="hero-stat-value" data-count="12">0</div>
            <div class="hero-stat-label">Free Tools</div>
          </div>
          <div class="hero-stat">
            <div class="hero-stat-value" id="global-calc-counter">0</div>
            <div class="hero-stat-label">Calculations Run</div>
          </div>
          <div class="hero-stat">
            <div class="hero-stat-value">$0</div>
            <div class="hero-stat-label">Cost â€” Always Free</div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- How It Works -->
    <section class="section" style="padding-bottom: 2rem;">
      <div class="section-header reveal">
        <div class="section-label">
          <span class="label-line"></span>
          How It Works
          <span class="label-line"></span>
        </div>
        <h2 class="section-title">Three steps to <span class="gradient-text">smarter decisions</span></h2>
        <p class="section-desc">No accounts, no downloads, no complexity. Just answers.</p>
      </div>
      <div class="how-it-works-steps">
        <div class="how-step reveal">
          <div class="how-connector"></div>
          <div class="how-step-num">1</div>
          <h3>Choose a tool</h3>
          <p>Pick from 8 professional-grade calculators covering valuation, M&A, mortgage, and more.</p>
        </div>
        <div class="how-step reveal">
          <div class="how-connector"></div>
          <div class="how-step-num">2</div>
          <h3>Enter your numbers</h3>
          <p>Fill in the inputs with your data. Smart defaults help you get started instantly.</p>
        </div>
        <div class="how-step reveal">
          <div class="how-step-num">3</div>
          <h3>Get instant results</h3>
          <p>See real-time calculations, sensitivity tables, and visual breakdowns â€” all in your browser.</p>
        </div>
      </div>
    </section>

    <!-- Tools Grid -->
    <section class="section" id="tools">
      <div class="section-header reveal">
        <div class="section-label">
          <span class="label-line"></span>
          Calculator Suite
          <span class="label-line"></span>
        </div>
        <h2 class="section-title">Everything you need, <span class="gradient-text">all in one place</span></h2>
        <p class="section-desc">Professional financial calculators that would cost hundreds at a consulting firm. Free, instant, private.</p>
      </div>
      
      <div class="tools-grid">
        <!-- Business Valuation -->
        <div class="tool-card reveal" onclick="showPage('valuation')" role="button" tabindex="0" aria-label="Business Valuation Calculator">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(99, 102, 241, 0.05));">ğŸ¢</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Business Valuation</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">DCF, multiples, and asset-based valuation. Perfect for M&A, fundraising, and exit planning.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">DCF</span>
            <span class="metric-pill neutral">Multiples</span>
            <span class="metric-pill neutral">Asset</span>
          </div>
        </div>
        
        <!-- M&A Analyzer -->
        <div class="tool-card reveal" onclick="showPage('merger')" role="button" tabindex="0" aria-label="M&A Deal Analyzer">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(139, 92, 246, 0.05));">ğŸ¤</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">M&A Deal Analyzer</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Accretion/dilution analysis, synergy valuation, and deal structure optimization.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">EPS Impact</span>
            <span class="metric-pill neutral">Synergies</span>
          </div>
        </div>
        
        <!-- Mortgage Calculator -->
        <div class="tool-card reveal" onclick="showPage('mortgage')" role="button" tabindex="0" aria-label="Canadian Mortgage Calculator">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(6, 182, 212, 0.05));">ğŸ </div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Canadian Mortgage</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Mortgage payments with OSFI stress test, land transfer tax, and amortization schedule.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Stress Test</span>
            <span class="metric-pill neutral">ğŸ‡¨ğŸ‡¦ Canada</span>
          </div>
        </div>
        
        <!-- Investment Returns -->
        <div class="tool-card reveal" onclick="showPage('investment')" role="button" tabindex="0" aria-label="Investment Returns Calculator">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.05));">ğŸ“ˆ</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Investment Returns</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">CAGR calculator, dollar-cost averaging simulator, and portfolio growth projections.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">CAGR</span>
            <span class="metric-pill neutral">DCA</span>
          </div>
        </div>
        
        <!-- RRSP vs TFSA -->
        <div class="tool-card reveal" onclick="showPage('retirement')" role="button" tabindex="0" aria-label="RRSP vs TFSA Optimizer">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(245, 158, 11, 0.05));">ğŸ¦</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">RRSP vs TFSA</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Optimize your Canadian retirement strategy. Compare tax-sheltered growth scenarios.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">RRSP</span>
            <span class="metric-pill neutral">TFSA</span>
            <span class="metric-pill neutral">ğŸ‡¨ğŸ‡¦</span>
          </div>
        </div>
        
        <!-- Compound Interest -->
        <div class="tool-card reveal" onclick="showPage('compound')" role="button" tabindex="0" aria-label="Compound Interest Visualizer">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(236, 72, 153, 0.15), rgba(236, 72, 153, 0.05));">ğŸ“Š</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Compound Interest</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Visualize the power of compound growth. See how small contributions become fortunes.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Visual</span>
            <span class="metric-pill neutral">Chart</span>
          </div>
        </div>
        
        <!-- Startup Runway -->
        <div class="tool-card reveal" onclick="showPage('runway')" role="button" tabindex="0" aria-label="Startup Runway Calculator">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.15), rgba(168, 85, 247, 0.05));">ğŸš€</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Startup Runway</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Calculate your burn rate, runway, and when you need to raise. Scenario planning included.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Burn Rate</span>
            <span class="metric-pill neutral">Runway</span>
          </div>
        </div>
        
        <!-- Net Worth -->
        <div class="tool-card reveal" onclick="showPage('networth')" role="button" tabindex="0" aria-label="Net Worth Tracker">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.05));">ğŸ’°</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Net Worth Tracker</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Track assets vs liabilities. See your complete financial picture with visual breakdowns.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Assets</span>
            <span class="metric-pill neutral">Liabilities</span>
          </div>
        </div>
        
        <!-- Salary & Compensation -->
        <div class="tool-card reveal" onclick="showPage('salary')" role="button" tabindex="0" aria-label="Salary & Compensation Analyzer">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(20, 184, 166, 0.15), rgba(20, 184, 166, 0.05));">ğŸ’¼</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Salary & Compensation</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Analyze total comp including base, bonus, equity, and benefits. Canadian tax estimates included.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Total Comp</span>
            <span class="metric-pill neutral">Take-Home</span>
          </div>
        </div>
        
        <!-- Debt Payoff -->
        <div class="tool-card reveal" onclick="showPage('debt')" role="button" tabindex="0" aria-label="Debt Payoff Calculator">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(249, 115, 22, 0.05));">ğŸ’³</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Debt Payoff Calculator</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Compare avalanche vs snowball strategies. See your debt-free date and interest savings.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Avalanche</span>
            <span class="metric-pill neutral">Snowball</span>
          </div>
        </div>

        <!-- Side-by-Side Comparison -->
        <div class="tool-card reveal" onclick="showPage('compare')" role="button" tabindex="0" aria-label="Side-by-Side Comparison">
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.15), rgba(168, 85, 247, 0.05));">âš–ï¸</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Side-by-Side Compare</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Compare two mortgage or investment scenarios side by side. See which option saves you more.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Mortgage</span>
            <span class="metric-pill neutral">A vs B</span>
          </div>
        </div>

        <!-- Currency Converter -->
        <div class="tool-card reveal" onclick="showPage('currency')" role="button" tabindex="0" aria-label="Currency Converter" style="position: relative;">
          <div style="position: absolute; top: 0.75rem; right: 0.75rem; background: var(--brand-primary); color: white; font-size: 0.65rem; padding: 0.15rem 0.5rem; border-radius: 999px; font-weight: 600;">Quick Tool</div>
          <div class="tool-icon" style="background: linear-gradient(135deg, rgba(20, 184, 166, 0.15), rgba(20, 184, 166, 0.05));">ğŸ’±</div>
          <h3 style="font-size: 1.1rem; margin: 0.75rem 0 0.5rem;">Currency Converter</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.6;">Instantly convert CAD to USD, EUR, GBP, INR, and JPY with approximate rates.</p>
          <div style="display: flex; gap: 0.375rem; margin-top: 1rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">CAD</span>
            <span class="metric-pill neutral">5 Currencies</span>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Why Section -->
    <section class="section" id="about">
      <div class="section-header reveal">
        <div class="section-label">
          <span class="label-line"></span>
          Why Babaganoush
          <span class="label-line"></span>
        </div>
        <h2 class="section-title">Built different</h2>
        <p class="section-desc">Financial tools built by someone who's spent 15+ years actually doing deals, not just building software.</p>
      </div>
      
      <div class="tools-grid" style="grid-template-columns: repeat(3, 1fr);">
        <div class="glass-card reveal" style="padding: var(--space-xl); text-align: center;">
          <div style="font-size: 2rem; margin-bottom: 1rem;">ğŸ”’</div>
          <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">100% Private</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary);">All calculations run in your browser. Your data never leaves your device.</p>
        </div>
        <div class="glass-card reveal" style="padding: var(--space-xl); text-align: center;">
          <div style="font-size: 2rem; margin-bottom: 1rem;">âš¡</div>
          <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">Instant Results</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary);">No loading, no servers. Calculations happen in real-time as you type.</p>
        </div>
        <div class="glass-card reveal" style="padding: var(--space-xl); text-align: center;">
          <div style="font-size: 2rem; margin-bottom: 1rem;">ğŸ“</div>
          <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">IB-Grade Models</h3>
          <p style="font-size: 0.85rem; color: var(--text-secondary);">Same methodologies used at bulge bracket banks and top PE firms.</p>
        </div>
      </div>
    </section>
    
    <!-- FAQ -->
    <section class="section">
      <div class="section-header reveal">
        <div class="section-label">
          <span class="label-line"></span>
          FAQ
          <span class="label-line"></span>
        </div>
        <h2 class="section-title">Frequently asked <span class="gradient-text">questions</span></h2>
      </div>
      <div class="faq-list">
        <div class="accordion-item reveal">
          <div class="accordion-header" onclick="this.parentElement.classList.toggle('open')">
            <span>Are these tools really free?</span>
            <span class="accordion-arrow">â–¼</span>
          </div>
          <div class="accordion-body"><div class="accordion-body-inner" style="color:var(--text-secondary);font-size:0.9rem;line-height:1.7;">Yes, forever. All core calculators are completely free with no sign-up required. We monetize through optional premium exports â€” PDF reports and Excel downloads coming soon.</div></div>
        </div>
        <div class="accordion-item reveal">
          <div class="accordion-header" onclick="this.parentElement.classList.toggle('open')">
            <span>Is my data safe?</span>
            <span class="accordion-arrow">â–¼</span>
          </div>
          <div class="accordion-body"><div class="accordion-body-inner" style="color:var(--text-secondary);font-size:0.9rem;line-height:1.7;">Absolutely. All calculations run locally in your browser. We never see your numbers, and nothing is sent to any server. Your financial data stays on your device.</div></div>
        </div>
        <div class="accordion-item reveal">
          <div class="accordion-header" onclick="this.parentElement.classList.toggle('open')">
            <span>How accurate are the calculations?</span>
            <span class="accordion-arrow">â–¼</span>
          </div>
          <div class="accordion-body"><div class="accordion-body-inner" style="color:var(--text-secondary);font-size:0.9rem;line-height:1.7;">We use the same methodologies as investment banks and PE firms. Our DCF, accretion/dilution, and valuation models follow industry-standard formulas used in professional deal analysis.</div></div>
        </div>
        <div class="accordion-item reveal">
          <div class="accordion-header" onclick="this.parentElement.classList.toggle('open')">
            <span>Can I export results?</span>
            <span class="accordion-arrow">â–¼</span>
          </div>
          <div class="accordion-body"><div class="accordion-body-inner" style="color:var(--text-secondary);font-size:0.9rem;line-height:1.7;">PDF and Excel exports are coming soon for premium users. You'll be able to generate presentation-ready reports with a single click.</div></div>
        </div>
        <div class="accordion-item reveal">
          <div class="accordion-header" onclick="this.parentElement.classList.toggle('open')">
            <span>Who built this?</span>
            <span class="accordion-arrow">â–¼</span>
          </div>
          <div class="accordion-body"><div class="accordion-body-inner" style="color:var(--text-secondary);font-size:0.9rem;line-height:1.7;">Finance professionals with 15+ years of M&A and corporate development experience. We built the tools we wished existed when we were doing deals.</div></div>
        </div>
      </div>
    </section>

    <!-- Newsletter -->
    <section class="section">
      <div class="newsletter-section reveal">
        <div style="font-size: 2rem; margin-bottom: 0.75rem;">ğŸ“¬</div>
        <h2 style="font-size: 1.5rem; margin-bottom: 0.5rem;">Get weekly financial insights</h2>
        <p style="color: var(--text-secondary); font-size: 0.9rem;">Valuation frameworks, deal analysis tips, and new tool updates â€” straight to your inbox.</p>
        <div class="newsletter-form" id="newsletter-form">
          <input type="email" id="newsletter-email" placeholder="you@company.com" aria-label="Email address" />
          <button class="btn btn-primary" onclick="subscribeNewsletter()">Subscribe</button>
        </div>
        <p class="newsletter-social-proof">âœ“ Join 2,000+ finance professionals Â· No spam, ever</p>
      </div>
    </section>

    <!-- Built By -->
    <section style="padding: 2.5rem 1.5rem; text-align: center; border-top: 1px solid var(--border-color);">
      <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; flex-wrap: wrap;">
        <div style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, var(--brand-primary), var(--brand-accent)); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.1rem;">RK</div>
        <div style="text-align: left;">
          <p style="font-size: 0.9rem; color: var(--text-primary); margin: 0; font-weight: 500;">Built by a finance professional with 15+ years in M&A and corporate development</p>
          <a href="#" style="font-size: 0.8rem; color: var(--brand-primary); text-decoration: none;">Connect on LinkedIn â†’</a>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-brand gradient-text">Babaganoush</div>
        <p class="footer-text">
          Smart financial tools built by finance professionals. All calculations are for educational and informational purposes only. Not financial advice.
        </p>
        <div class="footer-links">
          <a href="#">Privacy Policy</a>
          <a href="#">Terms of Use</a>
          <a href="#">Contact</a>
          <a href="https://github.com/rajkcho/Babaganoush" target="_blank">GitHub</a>
        </div>
        <p style="font-size: 0.72rem; color: var(--text-muted); margin-top: 1.5rem;">Â© 2026 Babaganoush. Made in ğŸ‡¨ğŸ‡¦ Canada.</p>
      </div>
    </footer>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       BUSINESS VALUATION PAGE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-valuation" role="region" aria-label="Business Valuation Calculator">
    <div class="calc-container" style="padding-top: 6rem;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>
      
      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ¢</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Business Valuation Calculator</h1>
        <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">Estimate business value using DCF, comparable multiples, and asset-based approaches.</p>
      </div>
      
      <!-- Method Tabs -->
      <div class="tabs" style="max-width: 400px; margin: 2rem auto;" id="val-tabs">
        <button class="tab active" onclick="switchValTab('dcf')">DCF</button>
        <button class="tab" onclick="switchValTab('multiples')">Multiples</button>
        <button class="tab" onclick="switchValTab('asset')">Asset-Based</button>
      </div>
      
      <!-- Action Buttons -->
      <div class="action-buttons" style="justify-content: center; margin-bottom: 1rem;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport(document.getElementById('val-dcf').style.display!=='none'?'Business Valuation (DCF)':document.getElementById('val-multiples').style.display!=='none'?'Business Valuation (Multiples)':'Business Valuation (Asset-Based)')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults(document.getElementById('val-dcf').style.display!=='none'?'Business Valuation (DCF)':document.getElementById('val-multiples').style.display!=='none'?'Business Valuation (Multiples)':'Business Valuation (Asset-Based)')">ğŸ“‹ Copy Results</button>
      </div>

      <!-- Compare All Methods -->
      <div id="val-compare" class="chart-container" style="margin-bottom: 2rem; display: none;">
        <div style="font-size: 0.85rem; font-weight: 700; margin-bottom: 1rem;">ğŸ“Š Compare All Methods (Football Field)</div>
        <div id="val-compare-chart"></div>
      </div>

      <!-- DCF Method -->
      <div id="val-dcf" class="animate-fade-up" style="margin-top: 2rem;">
        <div class="calc-grid">
          <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
            <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Assumptions</h3>
            
            <div class="input-group">
              <label>
                Annual Free Cash Flow (FCF)
                <span class="tooltip-wrapper">
                  <span class="tooltip-icon">?</span>
                  <span class="tooltip-content">Net cash generated by the business after all operating expenses and capital expenditures</span>
                </span>
              </label>
              <input type="number" id="dcf-fcf" value="1000000" placeholder="1,000,000" oninput="calculateDCF()" />
              <span class="input-help">Current annual free cash flow ($)</span>
            </div>
            
            <div class="input-group">
              <label>
                Growth Rate (Year 1-5)
                <span class="tooltip-wrapper">
                  <span class="tooltip-icon">?</span>
                  <span class="tooltip-content">Expected annual growth rate for the projection period</span>
                </span>
              </label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="dcf-growth" min="0" max="30" value="10" step="0.5" oninput="calculateDCF(); document.getElementById('dcf-growth-val').textContent = this.value + '%'" />
                <span id="dcf-growth-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right; color: var(--brand-primary);">10%</span>
              </div>
            </div>
            
            <div class="input-group">
              <label>
                Terminal Growth Rate
                <span class="tooltip-wrapper">
                  <span class="tooltip-icon">?</span>
                  <span class="tooltip-content">Long-term sustainable growth rate (typically 2-3%, matching GDP growth)</span>
                </span>
              </label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="dcf-terminal" min="0" max="5" value="2.5" step="0.25" oninput="calculateDCF(); document.getElementById('dcf-terminal-val').textContent = this.value + '%'" />
                <span id="dcf-terminal-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right; color: var(--brand-accent);">2.5%</span>
              </div>
            </div>
            
            <div class="input-group">
              <label>
                Discount Rate (WACC)
                <span class="tooltip-wrapper">
                  <span class="tooltip-icon">?</span>
                  <span class="tooltip-content">Weighted Average Cost of Capital â€” the required rate of return for investors</span>
                </span>
              </label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="dcf-wacc" min="5" max="25" value="12" step="0.5" oninput="calculateDCF(); document.getElementById('dcf-wacc-val').textContent = this.value + '%'" />
                <span id="dcf-wacc-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right; color: var(--brand-warning);">12%</span>
              </div>
            </div>
            
            <div class="input-group">
              <label>Projection Years</label>
              <select id="dcf-years" onchange="calculateDCF()">
                <option value="5" selected>5 Years</option>
                <option value="7">7 Years</option>
                <option value="10">10 Years</option>
              </select>
            </div>
            
            <div class="input-group">
              <label>Net Debt</label>
              <input type="number" id="dcf-debt" value="0" placeholder="0" oninput="calculateDCF()" />
              <span class="input-help">Total debt minus cash (negative = net cash position)</span>
            </div>
          </div>
          
          <div class="calc-results" id="dcf-results" aria-live="polite">
            <!-- Results populated by JS -->
          </div>
        </div>
        
        <!-- DCF Sensitivity Table -->
        <div class="chart-container" style="margin-top: 2rem;" id="dcf-sensitivity">
          <!-- Populated by JS -->
        </div>
        
        <!-- FCF Projection Chart -->
        <div class="chart-container" style="margin-top: 1rem;" id="dcf-chart">
          <!-- Populated by JS -->
        </div>
      </div>
      
      <!-- Multiples Method -->
      <div id="val-multiples" style="display: none; margin-top: 2rem;">
        <div class="calc-grid">
          <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
            <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Company Metrics</h3>
            
            <div class="input-group">
              <label>Annual Revenue</label>
              <input type="number" id="mult-revenue" value="5000000" oninput="calculateMultiples()" />
            </div>
            
            <div class="input-group">
              <label>EBITDA</label>
              <input type="number" id="mult-ebitda" value="1200000" oninput="calculateMultiples()" />
            </div>
            
            <div class="input-group">
              <label>Net Income</label>
              <input type="number" id="mult-income" value="800000" oninput="calculateMultiples()" />
            </div>
            
            <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin: 1.5rem 0 1rem;">Industry Multiples</h3>
            
            <div class="input-group">
              <label>EV/Revenue Multiple</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="mult-ev-rev" min="0.5" max="15" value="3" step="0.25" oninput="calculateMultiples(); document.getElementById('mult-ev-rev-val').textContent = this.value + 'x'" />
                <span id="mult-ev-rev-val" class="mono" style="font-size: 0.85rem; min-width: 3rem; text-align: right;">3x</span>
              </div>
            </div>
            
            <div class="input-group">
              <label>EV/EBITDA Multiple</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="mult-ev-ebitda" min="3" max="25" value="10" step="0.5" oninput="calculateMultiples(); document.getElementById('mult-ev-ebitda-val').textContent = this.value + 'x'" />
                <span id="mult-ev-ebitda-val" class="mono" style="font-size: 0.85rem; min-width: 3rem; text-align: right;">10x</span>
              </div>
            </div>
            
            <div class="input-group">
              <label>P/E Multiple</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="mult-pe" min="5" max="40" value="15" step="0.5" oninput="calculateMultiples(); document.getElementById('mult-pe-val').textContent = this.value + 'x'" />
                <span id="mult-pe-val" class="mono" style="font-size: 0.85rem; min-width: 3rem; text-align: right;">15x</span>
              </div>
            </div>
          </div>
          
          <div class="calc-results" id="multiples-results" aria-live="polite">
            <!-- Results populated by JS -->
          </div>
        </div>
      </div>
      
      <!-- Asset-Based Method -->
      <div id="val-asset" style="display: none; margin-top: 2rem;">
        <div class="calc-grid">
          <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
            <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Assets</h3>
            
            <div class="input-group">
              <label>Cash & Equivalents</label>
              <input type="number" id="asset-cash" value="500000" oninput="calculateAsset()" />
            </div>
            <div class="input-group">
              <label>Accounts Receivable</label>
              <input type="number" id="asset-ar" value="300000" oninput="calculateAsset()" />
            </div>
            <div class="input-group">
              <label>Inventory</label>
              <input type="number" id="asset-inv" value="200000" oninput="calculateAsset()" />
            </div>
            <div class="input-group">
              <label>Property & Equipment</label>
              <input type="number" id="asset-ppe" value="1000000" oninput="calculateAsset()" />
            </div>
            <div class="input-group">
              <label>Other Assets</label>
              <input type="number" id="asset-other" value="150000" oninput="calculateAsset()" />
            </div>
            
            <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin: 1.5rem 0 1rem;">Liabilities</h3>
            
            <div class="input-group">
              <label>Accounts Payable</label>
              <input type="number" id="asset-ap" value="200000" oninput="calculateAsset()" />
            </div>
            <div class="input-group">
              <label>Loans & Debt</label>
              <input type="number" id="asset-debt" value="400000" oninput="calculateAsset()" />
            </div>
            <div class="input-group">
              <label>Other Liabilities</label>
              <input type="number" id="asset-otherliab" value="100000" oninput="calculateAsset()" />
            </div>
          </div>
          
          <div class="calc-results" id="asset-results" aria-live="polite">
            <!-- Results populated by JS -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MORTGAGE CALCULATOR PAGE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-mortgage" role="region" aria-label="Canadian Mortgage Calculator">
    <div class="calc-container" style="padding-top: 6rem;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>
      
      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ </div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Canadian Mortgage Calculator</h1>
        <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">Calculate payments with OSFI stress test, land transfer tax, and complete amortization schedule.</p>
      </div>
      
      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport('Canadian Mortgage Calculator')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults('Canadian Mortgage Calculator')">ğŸ“‹ Copy Results</button>
      </div>

      <div class="calc-grid" style="margin-top: 2rem;">
        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Mortgage Details</h3>
          
          <div class="input-group">
            <label>Home Price</label>
            <input type="number" id="mort-price" value="800000" oninput="calculateMortgage()" />
          </div>
          
          <div class="input-group">
            <label>Down Payment (%)</label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="mort-down" min="5" max="50" value="20" step="1" oninput="calculateMortgage(); document.getElementById('mort-down-val').textContent = this.value + '%'" />
              <span id="mort-down-val" class="mono" style="font-size: 0.85rem; min-width: 3rem; text-align: right;">20%</span>
            </div>
            <span class="input-help" id="mort-down-help">Down payment: $160,000</span>
          </div>
          
          <div class="input-group">
            <label>Interest Rate (%)</label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="mort-rate" min="1" max="10" value="5.5" step="0.05" oninput="calculateMortgage(); document.getElementById('mort-rate-val').textContent = this.value + '%'" />
              <span id="mort-rate-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right;">5.5%</span>
            </div>
          </div>
          
          <div class="input-group">
            <label>Amortization Period</label>
            <select id="mort-amort" onchange="calculateMortgage()">
              <option value="25" selected>25 Years</option>
              <option value="30">30 Years</option>
              <option value="20">20 Years</option>
              <option value="15">15 Years</option>
            </select>
          </div>
          
          <div class="input-group">
            <label>Payment Frequency</label>
            <select id="mort-freq" onchange="calculateMortgage()">
              <option value="12" selected>Monthly</option>
              <option value="26">Bi-Weekly</option>
              <option value="52">Weekly</option>
              <option value="24">Semi-Monthly</option>
            </select>
          </div>
          
          <div class="input-group">
            <label>Province</label>
            <select id="mort-province" onchange="calculateMortgage()">
              <option value="ON" selected>Ontario</option>
              <option value="BC">British Columbia</option>
              <option value="AB">Alberta</option>
              <option value="QC">Quebec</option>
              <option value="MB">Manitoba</option>
              <option value="SK">Saskatchewan</option>
              <option value="NS">Nova Scotia</option>
              <option value="NB">New Brunswick</option>
              <option value="NL">Newfoundland</option>
              <option value="PE">PEI</option>
            </select>
          </div>
        </div>
        
        <div class="calc-results" id="mortgage-results" aria-live="polite">
          <!-- Results populated by JS -->
        </div>
      </div>
      
      <!-- Stress Test -->
      <div class="chart-container" style="margin-top: 2rem;" id="mortgage-stress">
        <!-- Populated by JS -->
      </div>
      
      <!-- Amortization Schedule -->
      <div class="chart-container" style="margin-top: 1rem;" id="mortgage-amort">
        <!-- Populated by JS -->
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       INVESTMENT RETURNS PAGE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-investment" role="region" aria-label="Investment Returns Calculator">
    <div class="calc-container" style="padding-top: 6rem;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>
      
      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ“ˆ</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Investment Returns Calculator</h1>
        <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">Calculate CAGR, simulate dollar-cost averaging, and project portfolio growth over time.</p>
      </div>
      
      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport(document.getElementById('inv-cagr').style.display!=='none'?'Investment Returns (CAGR)':'Investment Returns (DCA)')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults(document.getElementById('inv-cagr').style.display!=='none'?'Investment Returns (CAGR)':'Investment Returns (DCA)')">ğŸ“‹ Copy Results</button>
      </div>

      <div class="tabs" style="max-width: 300px; margin: 2rem auto;" id="inv-tabs">
        <button class="tab active" onclick="switchInvTab('cagr')">CAGR</button>
        <button class="tab" onclick="switchInvTab('dca')">DCA Sim</button>
      </div>
      
      <!-- CAGR Calculator -->
      <div id="inv-cagr" style="margin-top: 2rem;">
        <div class="calc-grid">
          <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
            <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Investment Details</h3>
            
            <div class="input-group">
              <label>Initial Investment</label>
              <input type="number" id="cagr-initial" value="10000" oninput="calculateCAGR()" />
            </div>
            <div class="input-group">
              <label>Final Value</label>
              <input type="number" id="cagr-final" value="25000" oninput="calculateCAGR()" />
            </div>
            <div class="input-group">
              <label>Time Period (Years)</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="cagr-years" min="1" max="30" value="5" step="1" oninput="calculateCAGR(); document.getElementById('cagr-years-val').textContent = this.value + ' yrs'" />
                <span id="cagr-years-val" class="mono" style="font-size: 0.85rem; min-width: 4rem; text-align: right;">5 yrs</span>
              </div>
            </div>
          </div>
          
          <div class="calc-results" id="cagr-results" aria-live="polite"></div>
        </div>
      </div>
      
      <!-- DCA Simulator -->
      <div id="inv-dca" style="display: none; margin-top: 2rem;">
        <div class="calc-grid">
          <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
            <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">DCA Parameters</h3>
            
            <div class="input-group">
              <label>Monthly Investment</label>
              <input type="number" id="dca-monthly" value="500" oninput="calculateDCA()" />
            </div>
            <div class="input-group">
              <label>Expected Annual Return (%)</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="dca-return" min="1" max="20" value="8" step="0.5" oninput="calculateDCA(); document.getElementById('dca-return-val').textContent = this.value + '%'" />
                <span id="dca-return-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right;">8%</span>
              </div>
            </div>
            <div class="input-group">
              <label>Investment Period (Years)</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="dca-years" min="1" max="40" value="20" step="1" oninput="calculateDCA(); document.getElementById('dca-years-val').textContent = this.value + ' yrs'" />
                <span id="dca-years-val" class="mono" style="font-size: 0.85rem; min-width: 4rem; text-align: right;">20 yrs</span>
              </div>
            </div>
            <div class="input-group">
              <label>Initial Lump Sum (optional)</label>
              <input type="number" id="dca-initial" value="0" oninput="calculateDCA()" />
            </div>
            <div class="input-group">
              <label>Inflation Rate (%) â€” optional</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <input type="range" id="dca-inflation" min="0" max="5" value="2.5" step="0.1" oninput="calculateDCA(); document.getElementById('dca-inflation-val').textContent = this.value + '%'" />
                <span id="dca-inflation-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right; color: var(--brand-warning);">2.5%</span>
              </div>
              <span class="input-help">Shows real (inflation-adjusted) values alongside nominal</span>
            </div>
          </div>
          
          <div class="calc-results" id="dca-results" aria-live="polite"></div>
        </div>
        
        <div class="chart-container" style="margin-top: 2rem;" id="dca-chart"></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RRSP vs TFSA PAGE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-retirement" role="region" aria-label="RRSP vs TFSA Optimizer">
    <div class="calc-container" style="padding-top: 6rem;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>
      
      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ¦</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">RRSP vs TFSA Optimizer</h1>
        <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">Compare tax-sheltered strategies and find your optimal Canadian retirement plan.</p>
      </div>
      
      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport('RRSP vs TFSA Optimizer')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults('RRSP vs TFSA Optimizer')">ğŸ“‹ Copy Results</button>
      </div>

      <div class="calc-grid" style="margin-top: 2rem;">
        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Your Situation</h3>
          
          <div class="input-group">
            <label>Annual Income</label>
            <input type="number" id="ret-income" value="120000" oninput="calculateRetirement()" />
          </div>
          <div class="input-group">
            <label>Annual Contribution</label>
            <input type="number" id="ret-contribution" value="20000" oninput="calculateRetirement()" />
          </div>
          <div class="input-group">
            <label>Current Age</label>
            <input type="number" id="ret-age" value="35" oninput="calculateRetirement()" />
          </div>
          <div class="input-group">
            <label>Retirement Age</label>
            <input type="number" id="ret-retire-age" value="60" oninput="calculateRetirement()" />
          </div>
          <div class="input-group">
            <label>Expected Annual Return (%)</label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="ret-return" min="3" max="12" value="7" step="0.5" oninput="calculateRetirement(); document.getElementById('ret-return-val').textContent = this.value + '%'" />
              <span id="ret-return-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right;">7%</span>
            </div>
          </div>
          <div class="input-group">
            <label>Expected Retirement Income</label>
            <input type="number" id="ret-retire-income" value="60000" oninput="calculateRetirement()" />
            <span class="input-help">Annual income in retirement (for tax bracket comparison)</span>
          </div>
          <div class="input-group">
            <label>Province</label>
            <select id="ret-province" onchange="calculateRetirement()">
              <option value="ON" selected>Ontario</option>
              <option value="BC">British Columbia</option>
              <option value="AB">Alberta</option>
              <option value="QC">Quebec</option>
            </select>
          </div>
        </div>
        
        <div class="calc-results" id="retirement-results" aria-live="polite"></div>
      </div>
      
      <div class="chart-container" style="margin-top: 2rem;" id="retirement-chart"></div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       COMPOUND INTEREST PAGE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-compound" role="region" aria-label="Compound Interest Visualizer">
    <div class="calc-container" style="padding-top: 6rem;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>
      
      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ“Š</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Compound Interest Visualizer</h1>
        <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">See the magic of compound growth. Small contributions today become extraordinary wealth tomorrow.</p>
      </div>
      
      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport('Compound Interest')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults('Compound Interest')">ğŸ“‹ Copy Results</button>
      </div>

      <div class="calc-grid" style="margin-top: 2rem;">
        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <div class="input-group">
            <label>Initial Amount</label>
            <input type="number" id="comp-initial" value="10000" oninput="calculateCompound()" />
          </div>
          <div class="input-group">
            <label>Monthly Contribution</label>
            <input type="number" id="comp-monthly" value="300" oninput="calculateCompound()" />
          </div>
          <div class="input-group">
            <label>Annual Interest Rate (%)</label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="comp-rate" min="1" max="15" value="7" step="0.25" oninput="calculateCompound(); document.getElementById('comp-rate-val').textContent = this.value + '%'" />
              <span id="comp-rate-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right;">7%</span>
            </div>
          </div>
          <div class="input-group">
            <label>Time Period (Years)</label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="comp-years" min="1" max="50" value="25" step="1" oninput="calculateCompound(); document.getElementById('comp-years-val').textContent = this.value + ' yrs'" />
              <span id="comp-years-val" class="mono" style="font-size: 0.85rem; min-width: 4rem; text-align: right;">25 yrs</span>
            </div>
          </div>
          <div class="input-group">
            <label>Compounding Frequency</label>
            <select id="comp-freq" onchange="calculateCompound()">
              <option value="12" selected>Monthly</option>
              <option value="4">Quarterly</option>
              <option value="1">Annually</option>
              <option value="365">Daily</option>
            </select>
          </div>
        </div>
        
        <div class="calc-results" id="compound-results" aria-live="polite"></div>
      </div>
      
      <div class="chart-container" style="margin-top: 2rem;" id="compound-chart"></div>
    </div>
  </div>

  <!-- Placeholder pages for remaining tools -->
  <div class="page" id="page-merger" role="region" aria-label="M&A Deal Analyzer">
    <div class="calc-container" style="padding-top: 6rem;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>
      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ¤</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">M&A Deal Analyzer</h1>
        <p style="color: var(--text-secondary);">Accretion/dilution analysis, synergy modeling, and deal structuring.</p>
      </div>

      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport('M&A Deal Analyzer')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults('M&A Deal Analyzer')">ğŸ“‹ Copy Results</button>
      </div>

      <div class="calc-grid animate-fade-up" style="margin-top: 2rem;">
        <!-- Inputs -->
        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Acquirer</h3>

          <div class="input-group">
            <label>Earnings Per Share (EPS)
              <span class="tooltip-wrapper"><span class="tooltip-icon">?</span><span class="tooltip-content">Acquirer's current diluted EPS</span></span>
            </label>
            <input type="number" id="ma-acq-eps" value="5.00" step="0.01" oninput="calculateMA()" />
          </div>
          <div class="input-group">
            <label>Share Price ($)</label>
            <input type="number" id="ma-acq-price" value="100" step="0.01" oninput="calculateMA()" />
          </div>
          <div class="input-group">
            <label>Shares Outstanding (M)</label>
            <input type="number" id="ma-acq-shares" value="500" step="1" oninput="calculateMA()" />
          </div>
          <div class="input-group">
            <label>P/E Multiple
              <span class="tooltip-wrapper"><span class="tooltip-icon">?</span><span class="tooltip-content">Acquirer's current price-to-earnings ratio</span></span>
            </label>
            <input type="number" id="ma-acq-pe" value="20" step="0.1" oninput="calculateMA()" />
          </div>

          <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin: 1.5rem 0 1rem;">Target</h3>

          <div class="input-group">
            <label>Earnings Per Share (EPS)</label>
            <input type="number" id="ma-tgt-eps" value="2.50" step="0.01" oninput="calculateMA()" />
          </div>
          <div class="input-group">
            <label>Share Price ($)</label>
            <input type="number" id="ma-tgt-price" value="40" step="0.01" oninput="calculateMA()" />
          </div>
          <div class="input-group">
            <label>Shares Outstanding (M)</label>
            <input type="number" id="ma-tgt-shares" value="200" step="1" oninput="calculateMA()" />
          </div>
          <div class="input-group">
            <label>Offer Premium</label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="ma-premium" min="10" max="50" value="25" step="1" oninput="calculateMA(); document.getElementById('ma-premium-val').textContent = this.value + '%'" />
              <span id="ma-premium-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right; color: var(--brand-primary);">25%</span>
            </div>
          </div>

          <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin: 1.5rem 0 1rem;">Deal Structure</h3>

          <div class="input-group">
            <label>Cash Portion</label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="ma-cash-pct" min="0" max="100" value="50" step="5" oninput="calculateMA(); document.getElementById('ma-cash-val').textContent = this.value + '% Cash / ' + (100 - this.value) + '% Stock'" />
              <span id="ma-cash-val" class="mono" style="font-size: 0.85rem; min-width: 10rem; text-align: right; color: var(--brand-accent);">50% Cash / 50% Stock</span>
            </div>
          </div>
          <div class="input-group">
            <label>Cost of Debt (for Cash Financing)
              <span class="tooltip-wrapper"><span class="tooltip-icon">?</span><span class="tooltip-content">Pre-tax interest rate on new debt raised to fund the cash portion</span></span>
            </label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="ma-debt-cost" min="1" max="12" value="5" step="0.25" oninput="calculateMA(); document.getElementById('ma-debt-cost-val').textContent = this.value + '%'" />
              <span id="ma-debt-cost-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right; color: var(--brand-warning);">5%</span>
            </div>
          </div>
          <div class="input-group">
            <label>Tax Rate</label>
            <div style="display: flex; align-items: center; gap: 1rem;">
              <input type="range" id="ma-tax" min="0" max="40" value="25" step="1" oninput="calculateMA(); document.getElementById('ma-tax-val').textContent = this.value + '%'" />
              <span id="ma-tax-val" class="mono" style="font-size: 0.85rem; min-width: 3.5rem; text-align: right; color: var(--brand-danger);">25%</span>
            </div>
          </div>

          <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin: 1.5rem 0 1rem;">Synergies</h3>

          <div class="input-group">
            <label>Expected Revenue Synergies ($M)</label>
            <input type="number" id="ma-rev-syn" value="0" step="1" oninput="calculateMA()" />
          </div>
          <div class="input-group">
            <label>Expected Cost Synergies ($M)</label>
            <input type="number" id="ma-cost-syn" value="50" step="1" oninput="calculateMA()" />
          </div>
        </div>

        <!-- Results -->
        <div class="calc-results" id="ma-results" aria-live="polite">
          <!-- Populated by JS -->
        </div>
      </div>

      <!-- Sensitivity Table -->
      <div class="chart-container animate-fade-up" style="margin-top: 2rem;" id="ma-sensitivity">
        <!-- Populated by JS -->
      </div>

      <!-- Sources & Uses -->
      <div class="chart-container animate-fade-up" style="margin-top: 1rem;" id="ma-sources-uses">
        <!-- Populated by JS -->
      </div>
    </div>
  </div>
  
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       STARTUP RUNWAY CALCULATOR
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-runway" role="region" aria-label="Startup Runway Calculator">
    <div class="calc-container" style="padding-top: 6rem; max-width: 1000px;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>

      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸš€</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Startup Runway Calculator</h1>
        <p style="color: var(--text-secondary); max-width: 540px; margin: 0 auto;">Calculate your burn rate, runway, and break-even point. Plan with multiple scenarios.</p>
      </div>

      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport('Startup Runway')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults('Startup Runway')">ğŸ“‹ Copy Results</button>
      </div>

      <!-- Scenario Tabs -->
      <div class="tabs" id="runway-tabs" style="max-width: 420px; margin: 0 auto 2rem;">
        <button class="tab" onclick="switchRunwayTab('conservative')" id="runway-tab-conservative">Conservative</button>
        <button class="tab active" onclick="switchRunwayTab('base')" id="runway-tab-base">Base Case</button>
        <button class="tab" onclick="switchRunwayTab('aggressive')" id="runway-tab-aggressive">Aggressive</button>
      </div>

      <div class="calc-grid">
        <!-- Inputs -->
        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 0.95rem; margin-bottom: 1rem;">ğŸ“¥ Financial Inputs</h3>

          <div class="input-group">
            <label>Cash in Bank ($)</label>
            <input type="number" id="rw-cash" value="500000" oninput="calculateRunway()" placeholder="500000" />
          </div>

          <div class="input-group">
            <label>Monthly Revenue ($)</label>
            <input type="number" id="rw-revenue" value="20000" oninput="calculateRunway()" placeholder="20000" />
          </div>

          <div class="input-group">
            <label>Monthly Revenue Growth Rate: <span id="rw-growth-val" class="mono" style="color:var(--brand-primary);">5%</span></label>
            <input type="range" id="rw-growth" min="0" max="30" step="0.5" value="5" oninput="document.getElementById('rw-growth-val').textContent=this.value+'%'; calculateRunway();" />
            <div class="input-help">0% â€” 30% monthly growth</div>
          </div>

          <div class="input-group">
            <label>Monthly Fixed Costs ($)</label>
            <input type="number" id="rw-fixed" value="45000" oninput="calculateRunway()" placeholder="Rent, salaries, tools" />
            <div class="input-help">Rent, salaries, tools, subscriptions</div>
          </div>

          <div class="input-group">
            <label>Monthly Variable Costs ($)</label>
            <input type="number" id="rw-variable" value="8000" oninput="calculateRunway()" placeholder="8000" />
          </div>

          <div class="input-group">
            <label>One-Time Upcoming Expenses ($)</label>
            <input type="number" id="rw-onetime" value="0" oninput="calculateRunway()" placeholder="0" />
          </div>

          <div class="input-group">
            <label>Monthly Hiring Cost Increases ($)</label>
            <input type="number" id="rw-hiring" value="2000" oninput="calculateRunway()" placeholder="Planned monthly increase" />
            <div class="input-help">Added to costs each month cumulatively</div>
          </div>
        </div>

        <!-- Results -->
        <div class="calc-results">
          <div class="result-card" style="text-align: center;">
            <div class="result-label">Monthly Burn Rate</div>
            <div class="result-value" id="rw-burn">$0</div>
            <div class="input-help">Current costs âˆ’ revenue</div>
          </div>

          <div class="result-card" style="text-align: center;">
            <div class="result-label">Runway (No Growth)</div>
            <div class="result-value" id="rw-runway-flat" style="font-size: 1.5rem;">0 months</div>
          </div>

          <div class="result-card" style="text-align: center;">
            <div class="result-label">Runway (With Growth)</div>
            <div class="result-value" id="rw-runway-growth" style="font-size: 1.5rem;">0 months</div>
          </div>

          <div class="result-card" style="text-align: center;">
            <div class="result-label">Cash Zero Date</div>
            <div class="result-value" id="rw-zero-date" style="font-size: 1.25rem;">â€”</div>
          </div>

          <div id="rw-safe-zone" class="result-card" style="text-align: center;">
            <div class="result-label">Safety Zone</div>
            <div class="result-value" id="rw-safe-text" style="font-size: 1.5rem;">â€”</div>
          </div>

          <div class="result-card" style="text-align: center;">
            <div class="result-label">Break-Even Month</div>
            <div class="result-value" id="rw-breakeven" style="font-size: 1.25rem;">â€”</div>
          </div>
        </div>
      </div>

      <!-- Chart -->
      <div class="chart-container" style="margin-top: 2rem;">
        <h3 style="font-size: 0.95rem; margin-bottom: 1rem;">ğŸ“Š Monthly Cash Balance Projection</h3>
        <div id="rw-scenario-label" style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em;">Base Case Scenario</div>
        <div id="rw-chart" style="display: flex; align-items: flex-end; gap: 3px; height: 220px; position: relative; padding-bottom: 24px;">
          <!-- bars injected by JS -->
        </div>
        <div style="display: flex; align-items: center; gap: 1rem; margin-top: 0.75rem; font-size: 0.72rem; color: var(--text-muted);">
          <span style="display:flex;align-items:center;gap:4px;"><span style="width:12px;height:12px;border-radius:2px;background:linear-gradient(135deg,var(--brand-primary),var(--brand-accent));display:inline-block;"></span> Positive Balance</span>
          <span style="display:flex;align-items:center;gap:4px;"><span style="width:12px;height:12px;border-radius:2px;background:var(--brand-danger);display:inline-block;"></span> Negative / Danger</span>
          <span style="display:flex;align-items:center;gap:4px;"><span style="width:12px;height:12px;border-radius:2px;background:var(--brand-success);display:inline-block;"></span> Break-Even Reached</span>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       NET WORTH TRACKER
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-networth" role="region" aria-label="Net Worth Tracker">
    <div class="calc-container" style="padding-top: 6rem; max-width: 1000px;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>

      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ’°</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Net Worth Tracker</h1>
        <p style="color: var(--text-secondary); max-width: 540px; margin: 0 auto;">Track your complete financial picture. Save snapshots to monitor progress over time.</p>
      </div>

      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport('Net Worth Tracker')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults('Net Worth Tracker')">ğŸ“‹ Copy Results</button>
      </div>

      <div class="calc-grid">
        <!-- Assets Column -->
        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 0.95rem; margin-bottom: 1rem; color: var(--brand-success);">ğŸ“ˆ Assets</h3>

          <div class="input-group">
            <label>Cash & Savings ($)</label>
            <input type="number" id="nw-cash" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>TFSA ($)</label>
            <input type="number" id="nw-tfsa" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>RRSP ($)</label>
            <input type="number" id="nw-rrsp" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>Non-Registered Investments ($)</label>
            <input type="number" id="nw-nonreg" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>Real Estate ($)</label>
            <input type="number" id="nw-realestate" value="0" oninput="calculateNetWorth()" />
            <div class="input-help">Primary residence market value</div>
          </div>
          <div class="input-group">
            <label>Vehicles ($)</label>
            <input type="number" id="nw-vehicles" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>Other Assets ($)</label>
            <input type="number" id="nw-other-assets" value="0" oninput="calculateNetWorth()" />
            <div class="input-help">Business equity, crypto, collectibles</div>
          </div>
        </div>

        <!-- Liabilities Column -->
        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 0.95rem; margin-bottom: 1rem; color: var(--brand-danger);">ğŸ“‰ Liabilities</h3>

          <div class="input-group">
            <label>Mortgage Balance ($)</label>
            <input type="number" id="nw-mortgage" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>Car Loans ($)</label>
            <input type="number" id="nw-carloans" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>Student Loans ($)</label>
            <input type="number" id="nw-student" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>Credit Card Debt ($)</label>
            <input type="number" id="nw-cc" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>Line of Credit ($)</label>
            <input type="number" id="nw-loc" value="0" oninput="calculateNetWorth()" />
          </div>
          <div class="input-group">
            <label>Other Debt ($)</label>
            <input type="number" id="nw-other-debt" value="0" oninput="calculateNetWorth()" />
          </div>
        </div>
      </div>

      <!-- Results -->
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-top: 2rem;">
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Total Assets</div>
          <div class="result-value" id="nw-total-assets" style="font-size: 1.5rem; color: var(--brand-success); -webkit-text-fill-color: var(--brand-success);">$0</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Total Liabilities</div>
          <div class="result-value" id="nw-total-liabilities" style="font-size: 1.5rem; color: var(--brand-danger); -webkit-text-fill-color: var(--brand-danger);">$0</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Liquid Net Worth</div>
          <div class="result-value" id="nw-liquid" style="font-size: 1.5rem;">$0</div>
          <div class="input-help">Excludes real estate & vehicles</div>
        </div>
      </div>

      <!-- Big Net Worth Card -->
      <div class="result-card" style="text-align: center; margin-top: 1.5rem; padding: var(--space-2xl);">
        <div class="result-label" style="font-size: 0.9rem;">Net Worth</div>
        <div class="result-value" id="nw-networth" style="font-size: 3rem;">$0</div>
        <div id="nw-dta" style="margin-top: 0.75rem;"></div>
      </div>

      <!-- Pie Chart + Snapshot -->
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
        <!-- Asset Allocation Pie -->
        <div class="chart-container">
          <h3 style="font-size: 0.95rem; margin-bottom: 1rem;">ğŸ¥§ Asset Allocation</h3>
          <div style="display: flex; align-items: center; gap: 1.5rem;">
            <div id="nw-pie" style="width: 150px; height: 150px; border-radius: 50%; flex-shrink: 0; background: var(--border-primary);"></div>
            <div id="nw-pie-legend" style="font-size: 0.75rem; display: flex; flex-direction: column; gap: 0.375rem;"></div>
          </div>
        </div>

        <!-- Snapshots -->
        <div class="chart-container">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
            <h3 style="font-size: 0.95rem;">ğŸ“¸ Snapshots</h3>
            <button class="btn btn-primary btn-sm" onclick="saveNetWorthSnapshot()">Save Snapshot</button>
          </div>
          <div id="nw-snapshots" style="max-height: 250px; overflow-y: auto; font-size: 0.8rem;"></div>
        </div>
      </div>
    </div>
  </div>

  </main>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SALARY & COMPENSATION ANALYZER
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-salary">
    <div class="calc-container" style="padding-top: 6rem; max-width: 1000px;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>

      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ’¼</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Salary & Compensation Analyzer</h1>
        <p style="color: var(--text-secondary); max-width: 540px; margin: 0 auto;">Analyze your total compensation package including base, bonus, equity, and benefits with Canadian tax estimates.</p>
      </div>

      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport('Salary & Compensation Analyzer')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults('Salary & Compensation Analyzer')">ğŸ“‹ Copy Results</button>
      </div>

      <div class="calc-grid">
        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 0.95rem; margin-bottom: 1rem; color: #14b8a6;">ğŸ’° Cash Compensation</h3>
          <div class="input-group">
            <label>Annual Base Salary ($)</label>
            <input type="number" id="sal-base" value="85000" oninput="calculateSalary()" />
          </div>
          <div class="input-group">
            <label>Bonus (%)</label>
            <input type="number" id="sal-bonus-pct" value="10" step="1" oninput="calculateSalary()" />
            <div class="input-help">Annual bonus as % of base salary</div>
          </div>

          <h3 style="font-size: 0.95rem; margin: 1.5rem 0 1rem; color: #14b8a6;">ğŸ“Š Stock Options / Equity</h3>
          <div class="input-group">
            <label>Number of Shares</label>
            <input type="number" id="sal-shares" value="1000" oninput="calculateSalary()" />
          </div>
          <div class="input-group">
            <label>Strike Price ($)</label>
            <input type="number" id="sal-strike" value="10" step="0.01" oninput="calculateSalary()" />
          </div>
          <div class="input-group">
            <label>Current Share Price ($)</label>
            <input type="number" id="sal-current-price" value="25" step="0.01" oninput="calculateSalary()" />
          </div>
          <div class="input-group">
            <label>Vesting Period (years)</label>
            <input type="number" id="sal-vesting" value="4" min="1" oninput="calculateSalary()" />
          </div>
        </div>

        <div class="calc-inputs glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 0.95rem; margin-bottom: 1rem; color: #14b8a6;">ğŸ¥ Benefits</h3>
          <div class="input-group">
            <label>Health Benefits Value ($/yr)</label>
            <input type="number" id="sal-health" value="5000" oninput="calculateSalary()" />
            <div class="input-help">Employer-paid health, dental, vision</div>
          </div>
          <div class="input-group">
            <label>Pension / RRSP Match ($/yr)</label>
            <input type="number" id="sal-pension" value="4000" oninput="calculateSalary()" />
          </div>

          <h3 style="font-size: 0.95rem; margin: 1.5rem 0 1rem; color: #14b8a6;">ğŸ Tax Province</h3>
          <div class="input-group">
            <label>Province</label>
            <select id="sal-province" onchange="calculateSalary()">
              <option value="ON" selected>Ontario</option>
              <option value="BC">British Columbia</option>
              <option value="AB">Alberta</option>
              <option value="QC">Quebec</option>
              <option value="MB">Manitoba</option>
              <option value="SK">Saskatchewan</option>
              <option value="NS">Nova Scotia</option>
              <option value="NB">New Brunswick</option>
              <option value="NL">Newfoundland & Labrador</option>
              <option value="PE">Prince Edward Island</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Results -->
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 2rem;">
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Total Compensation</div>
          <div class="result-value" id="sal-total-comp" style="font-size: 1.5rem;">$0</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">After-Tax Take-Home</div>
          <div class="result-value" id="sal-take-home" style="font-size: 1.5rem; color: var(--brand-success); -webkit-text-fill-color: var(--brand-success);">$0</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Effective Tax Rate</div>
          <div class="result-value" id="sal-eff-tax" style="font-size: 1.5rem;">0%</div>
        </div>
      </div>

      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem;">
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Hourly Rate Equivalent</div>
          <div class="result-value" id="sal-hourly" style="font-size: 1.5rem;">$0</div>
          <div class="input-help">Based on 2,080 hrs/yr</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Stock Option Value</div>
          <div class="result-value" id="sal-equity-val" style="font-size: 1.5rem;">$0</div>
          <div class="input-help">Intrinsic value (annualized)</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Annual Bonus</div>
          <div class="result-value" id="sal-bonus-val" style="font-size: 1.5rem;">$0</div>
        </div>
      </div>

      <!-- Comparison + Pie -->
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem;">
        <div class="chart-container">
          <h3 style="font-size: 0.95rem; margin-bottom: 1rem;">ğŸ¥§ Compensation Breakdown</h3>
          <div style="display: flex; align-items: center; gap: 1.5rem;">
            <div id="sal-pie" style="width: 150px; height: 150px; border-radius: 50%; flex-shrink: 0; background: var(--border-primary);"></div>
            <div id="sal-pie-legend" style="font-size: 0.75rem; display: flex; flex-direction: column; gap: 0.375rem;"></div>
          </div>
        </div>
        <div class="chart-container">
          <h3 style="font-size: 0.95rem; margin-bottom: 1rem;">ğŸ“Š How You Compare</h3>
          <div id="sal-comparison" style="font-size: 0.85rem;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DEBT PAYOFF CALCULATOR
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-debt">
    <div class="calc-container" style="padding-top: 6rem; max-width: 1000px;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>

      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ’³</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Debt Payoff Calculator</h1>
        <p style="color: var(--text-secondary); max-width: 540px; margin: 0 auto;">Compare Avalanche vs Snowball strategies. See your debt-free date and how extra payments save you money.</p>
      </div>

      <div class="action-buttons" style="justify-content: center;">
        <button class="btn btn-secondary btn-sm" onclick="generatePDFReport('Debt Payoff Calculator')">ğŸ“„ Download PDF Report</button>
        <button class="btn btn-secondary btn-sm" onclick="copyResults('Debt Payoff Calculator')">ğŸ“‹ Copy Results</button>
      </div>

      <div class="calc-inputs glass-card" style="padding: var(--space-xl); margin-top: 1.5rem;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
          <h3 style="font-size: 0.95rem; color: #ef4444;">ğŸ“‹ Your Debts</h3>
          <button class="btn btn-primary btn-sm" onclick="addDebtRow()">+ Add Debt</button>
        </div>
        <div id="debt-rows">
          <div class="debt-row" style="display: grid; grid-template-columns: 2fr 1.5fr 1fr 1.5fr auto; gap: 0.5rem; align-items: end; margin-bottom: 0.5rem;">
            <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Name</label><input type="text" value="Credit Card" oninput="calculateDebt()" /></div>
            <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Balance ($)</label><input type="number" value="8000" oninput="calculateDebt()" /></div>
            <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Rate (%)</label><input type="number" value="19.99" step="0.01" oninput="calculateDebt()" /></div>
            <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Min Payment ($)</label><input type="number" value="200" oninput="calculateDebt()" /></div>
            <button class="btn btn-secondary btn-sm" onclick="removeDebtRow(this)" style="padding:0.25rem 0.5rem;margin-bottom:2px;">âœ•</button>
          </div>
          <div class="debt-row" style="display: grid; grid-template-columns: 2fr 1.5fr 1fr 1.5fr auto; gap: 0.5rem; align-items: end; margin-bottom: 0.5rem;">
            <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Name</label><input type="text" value="Car Loan" oninput="calculateDebt()" /></div>
            <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Balance ($)</label><input type="number" value="15000" oninput="calculateDebt()" /></div>
            <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Rate (%)</label><input type="number" value="6.5" step="0.01" oninput="calculateDebt()" /></div>
            <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Min Payment ($)</label><input type="number" value="350" oninput="calculateDebt()" /></div>
            <button class="btn btn-secondary btn-sm" onclick="removeDebtRow(this)" style="padding:0.25rem 0.5rem;margin-bottom:2px;">âœ•</button>
          </div>
        </div>
      </div>

      <div class="calc-inputs glass-card" style="padding: var(--space-xl); margin-top: 1rem;">
        <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
          <div>
            <h3 style="font-size: 0.95rem; margin-bottom: 0.5rem;">âš”ï¸ Strategy</h3>
            <div style="display: flex; gap: 0.5rem;">
              <button class="btn btn-primary btn-sm" id="debt-btn-avalanche" onclick="setDebtStrategy('avalanche')">ğŸ”ï¸ Avalanche</button>
              <button class="btn btn-secondary btn-sm" id="debt-btn-snowball" onclick="setDebtStrategy('snowball')">â›„ Snowball</button>
            </div>
            <div class="input-help" style="margin-top:0.25rem" id="debt-strategy-help">Highest interest rate first â€” saves the most money</div>
          </div>
          <div style="flex:1; min-width: 200px;">
            <h3 style="font-size: 0.95rem; margin-bottom: 0.5rem;">ğŸ’ª Extra Monthly Payment</h3>
            <input type="range" id="debt-extra" min="0" max="2000" step="25" value="200" oninput="document.getElementById('debt-extra-val').textContent='$'+this.value; calculateDebt();" style="width:100%;" />
            <div style="display:flex;justify-content:space-between;font-size:0.75rem;color:var(--text-secondary)"><span>$0</span><span id="debt-extra-val">$200</span><span>$2,000</span></div>
          </div>
        </div>
      </div>

      <!-- Results -->
      <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 2rem;">
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Total Interest Paid</div>
          <div class="result-value" id="debt-total-interest" style="font-size: 1.5rem; color: var(--brand-danger); -webkit-text-fill-color: var(--brand-danger);">$0</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Debt-Free Date</div>
          <div class="result-value" id="debt-free-date" style="font-size: 1.3rem;">â€”</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Months to Debt-Free</div>
          <div class="result-value" id="debt-months" style="font-size: 1.5rem;">0</div>
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
        <div class="result-card" style="text-align: center;">
          <div class="result-label">Savings vs Minimum Only</div>
          <div class="result-value" id="debt-savings" style="font-size: 1.5rem; color: var(--brand-success); -webkit-text-fill-color: var(--brand-success);">$0</div>
        </div>
        <div class="result-card" style="text-align: center; padding: var(--space-xl);">
          <div class="result-label" style="font-size: 1rem;">ğŸ¯ Debt-Free Countdown</div>
          <div class="result-value" id="debt-countdown" style="font-size: 2rem;">â€”</div>
        </div>
      </div>

      <!-- Timeline Chart -->
      <div class="chart-container" style="margin-top: 1.5rem;">
        <h3 style="font-size: 0.95rem; margin-bottom: 1rem;">ğŸ“ˆ Payoff Timeline</h3>
        <div id="debt-timeline-chart" style="height: 250px; position: relative;"></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SIDE-BY-SIDE COMPARISON
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-compare" role="region" aria-label="Side-by-Side Comparison">
    <div class="calc-container" style="padding-top: 6rem; max-width: 1100px;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>

      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">âš–ï¸</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Side-by-Side Comparison</h1>
        <p style="color: var(--text-secondary); max-width: 540px; margin: 0 auto;">Compare two mortgage scenarios to see which option saves you more money.</p>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 2rem;">
        <!-- Scenario A -->
        <div class="glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 1rem; margin-bottom: 1rem; color: var(--brand-primary);">ğŸ…°ï¸ Scenario A</h3>
          <div class="input-group"><label>Home Price ($)</label><input type="number" id="cmp-a-price" value="600000" oninput="calculateComparison()" /></div>
          <div class="input-group"><label>Interest Rate (%)</label><input type="number" id="cmp-a-rate" value="5.5" step="0.01" oninput="calculateComparison()" /></div>
          <div class="input-group"><label>Amortization (years)</label><input type="number" id="cmp-a-amort" value="25" oninput="calculateComparison()" /></div>
          <div class="input-group"><label>Down Payment (%)</label><input type="number" id="cmp-a-down" value="20" oninput="calculateComparison()" /></div>
        </div>
        <!-- Scenario B -->
        <div class="glass-card" style="padding: var(--space-xl);">
          <h3 style="font-size: 1rem; margin-bottom: 1rem; color: var(--brand-accent);">ğŸ…±ï¸ Scenario B</h3>
          <div class="input-group"><label>Home Price ($)</label><input type="number" id="cmp-b-price" value="550000" oninput="calculateComparison()" /></div>
          <div class="input-group"><label>Interest Rate (%)</label><input type="number" id="cmp-b-rate" value="4.8" step="0.01" oninput="calculateComparison()" /></div>
          <div class="input-group"><label>Amortization (years)</label><input type="number" id="cmp-b-amort" value="30" oninput="calculateComparison()" /></div>
          <div class="input-group"><label>Down Payment (%)</label><input type="number" id="cmp-b-down" value="20" oninput="calculateComparison()" /></div>
        </div>
      </div>

      <!-- Results -->
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 2rem;">
        <div class="result-card" style="text-align: center;">
          <div class="result-label">ğŸ…°ï¸ Monthly Payment</div>
          <div class="result-value" id="cmp-a-payment" style="font-size: 1.5rem;">$0</div>
          <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">Total Interest: <span id="cmp-a-interest">$0</span></div>
          <div style="font-size: 0.8rem; color: var(--text-secondary);">Total Cost: <span id="cmp-a-total">$0</span></div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">ğŸ…±ï¸ Monthly Payment</div>
          <div class="result-value" id="cmp-b-payment" style="font-size: 1.5rem;">$0</div>
          <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">Total Interest: <span id="cmp-b-interest">$0</span></div>
          <div style="font-size: 0.8rem; color: var(--text-secondary);">Total Cost: <span id="cmp-b-total">$0</span></div>
        </div>
      </div>

      <!-- Verdict -->
      <div class="result-card" style="margin-top: 1.5rem; text-align: center; padding: var(--space-xl);">
        <div class="result-label" style="font-size: 1.1rem;">ğŸ† Verdict</div>
        <div class="result-value" id="cmp-verdict" style="font-size: 1.2rem; line-height: 1.6;">Enter values to compare</div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CURRENCY CONVERTER
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page" id="page-currency" role="region" aria-label="Currency Converter">
    <div class="calc-container" style="padding-top: 6rem; max-width: 700px;">
      <div class="calc-back" onclick="showPage('home')" role="button" tabindex="0" aria-label="Back to Tools">â† Back to Tools</div>

      <div class="calc-header animate-fade-up">
        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">ğŸ’±</div>
        <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">Currency Converter</h1>
        <p style="color: var(--text-secondary); max-width: 540px; margin: 0 auto;">Convert Canadian Dollars to major world currencies. Rates are approximate.</p>
      </div>

      <div class="glass-card" style="padding: var(--space-xl); margin-top: 2rem;">
        <div class="input-group">
          <label>Amount in CAD ($)</label>
          <input type="number" id="currency-amount" value="1000" oninput="convertCurrency()" style="font-size: 1.2rem; text-align: center;" />
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem;" id="currency-results">
        <div class="result-card" style="text-align: center;">
          <div class="result-label">ğŸ‡ºğŸ‡¸ US Dollar (USD)</div>
          <div class="result-value" id="cur-usd" style="font-size: 1.4rem;">$0</div>
          <div style="font-size: 0.75rem; color: var(--text-secondary);">1 CAD = 0.7353 USD</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">ğŸ‡ªğŸ‡º Euro (EUR)</div>
          <div class="result-value" id="cur-eur" style="font-size: 1.4rem;">â‚¬0</div>
          <div style="font-size: 0.75rem; color: var(--text-secondary);">1 CAD = 0.6803 EUR</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">ğŸ‡¬ğŸ‡§ British Pound (GBP)</div>
          <div class="result-value" id="cur-gbp" style="font-size: 1.4rem;">Â£0</div>
          <div style="font-size: 0.75rem; color: var(--text-secondary);">1 CAD = 0.5814 GBP</div>
        </div>
        <div class="result-card" style="text-align: center;">
          <div class="result-label">ğŸ‡®ğŸ‡³ Indian Rupee (INR)</div>
          <div class="result-value" id="cur-inr" style="font-size: 1.4rem;">â‚¹0</div>
          <div style="font-size: 0.75rem; color: var(--text-secondary);">1 CAD = 62.50 INR</div>
        </div>
        <div class="result-card" style="text-align: center; grid-column: 1 / -1;">
          <div class="result-label">ğŸ‡¯ğŸ‡µ Japanese Yen (JPY)</div>
          <div class="result-value" id="cur-jpy" style="font-size: 1.4rem;">Â¥0</div>
          <div style="font-size: 0.75rem; color: var(--text-secondary);">1 CAD = 111.11 JPY</div>
        </div>
      </div>

      <p style="text-align: center; font-size: 0.75rem; color: var(--text-muted); margin-top: 1.5rem;">âš ï¸ Rates are approximate and for reference only. Based on: USD 1.36, EUR 1.47, GBP 1.72, INR 0.016, JPY 0.009 per CAD.</p>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       JAVASCRIPT ENGINE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <script>
    console.log('Babaganoush v2.0 loaded â€” run runTests() in console to verify');

    // â”€â”€ Utility Functions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const fmt = (n, decimals = 0) => {
      if (n === undefined || n === null || isNaN(n)) return '$0';
      const abs = Math.abs(n);
      if (abs >= 1e9) return (n < 0 ? '-' : '') + '$' + (abs / 1e9).toFixed(1) + 'B';
      if (abs >= 1e6) return (n < 0 ? '-' : '') + '$' + (abs / 1e6).toFixed(1) + 'M';
      if (abs >= 1e3) return (n < 0 ? '-' : '') + '$' + (abs / 1e3).toFixed(decimals > 0 ? decimals : 0) + 'K';
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: decimals }).format(n);
    };
    
    const fmtFull = (n) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'CAD', maximumFractionDigits: 0 }).format(n || 0);
    
    const fmtPct = (n, decimals = 1) => (n || 0).toFixed(decimals) + '%';
    
    const fmtNum = (n) => new Intl.NumberFormat('en-US', { maximumFractionDigits: 0 }).format(n || 0);
    
    // â”€â”€ Page Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      const target = document.getElementById('page-' + pageId);
      if (target) {
        target.classList.add('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }
      
      // Close mobile menu
      document.getElementById('nav-links').classList.remove('mobile-open');
      
      // Initialize calculators
      if (pageId === 'valuation') calculateDCF();
      if (pageId === 'mortgage') calculateMortgage();
      if (pageId === 'investment') calculateCAGR();
      if (pageId === 'retirement') calculateRetirement();
      if (pageId === 'compound') calculateCompound();
      if (pageId === 'runway') calculateRunway();
      if (pageId === 'networth') { calculateNetWorth(); loadNetWorthSnapshots(); }
      if (pageId === 'salary') calculateSalary();
      if (pageId === 'debt') calculateDebt();
      if (pageId === 'compare') calculateComparison();
      if (pageId === 'currency') convertCurrency();
    }
    
    // â”€â”€ Theme Toggle â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let isDark = localStorage.getItem('theme') === 'dark';
    
    function toggleTheme() {
      isDark = !isDark;
      document.documentElement.classList.toggle('light', !isDark);
      document.querySelector('.theme-toggle').textContent = isDark ? 'ğŸŒ™' : 'â˜€ï¸';
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }
    
    // Initialize theme
    if (!isDark) {
      document.documentElement.classList.add('light');
      document.querySelector('.theme-toggle').textContent = 'â˜€ï¸';
    }
    
    // â”€â”€ Mobile Menu â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function toggleMobileMenu() {
      document.getElementById('nav-links').classList.toggle('mobile-open');
    }
    
    // â”€â”€ Navbar Scroll Effect â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    window.addEventListener('scroll', () => {
      document.getElementById('navbar').classList.toggle('scrolled', window.scrollY > 50);
    });
    
    // â”€â”€ Intersection Observer for Reveals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });
    
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
    
    // â”€â”€ Hero Counter Animation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function animateCounters() {
      document.querySelectorAll('[data-count]').forEach(el => {
        const target = parseInt(el.dataset.count) || 0;
        let current = 0;
        const increment = target / 40;
        const timer = setInterval(() => {
          current += increment;
          if (current >= target) {
            current = target;
            clearInterval(timer);
          }
          el.textContent = Math.floor(current) + (target > 10 ? '+' : '');
        }, 40);
      });
    }
    
    setTimeout(animateCounters, 800);
    
    // â”€â”€ Valuation Tab Switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function switchValTab(tab) {
      document.querySelectorAll('#val-tabs .tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      document.getElementById('val-dcf').style.display = tab === 'dcf' ? 'block' : 'none';
      document.getElementById('val-multiples').style.display = tab === 'multiples' ? 'block' : 'none';
      document.getElementById('val-asset').style.display = tab === 'asset' ? 'block' : 'none';
      
      if (tab === 'dcf') calculateDCF();
      if (tab === 'multiples') calculateMultiples();
      if (tab === 'asset') calculateAsset();
      updateValuationComparison();
    }
    
    // â”€â”€ Investment Tab Switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function switchInvTab(tab) {
      document.querySelectorAll('#inv-tabs .tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      document.getElementById('inv-cagr').style.display = tab === 'cagr' ? 'block' : 'none';
      document.getElementById('inv-dca').style.display = tab === 'dca' ? 'block' : 'none';
      
      if (tab === 'cagr') calculateCAGR();
      if (tab === 'dca') calculateDCA();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // DCF CALCULATOR
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateDCF() {
      const fcf = parseFloat(document.getElementById('dcf-fcf').value) || 0;
      const growth = (parseFloat(document.getElementById('dcf-growth').value) || 0) / 100;
      const terminal = (parseFloat(document.getElementById('dcf-terminal').value) || 0) / 100;
      const wacc = (parseFloat(document.getElementById('dcf-wacc').value) || 0) / 100;
      const years = parseInt(document.getElementById('dcf-years').value) || 5;
      const debt = parseFloat(document.getElementById('dcf-debt').value) || 0;
      
      if (wacc <= terminal) {
        document.getElementById('dcf-results').innerHTML = `
          <div class="result-card" style="border-color: rgba(239, 68, 68, 0.3); background: rgba(239, 68, 68, 0.05);">
            <p style="color: var(--brand-danger); font-weight: 600;">âš ï¸ Discount rate must be higher than terminal growth rate</p>
          </div>`;
        return;
      }
      
      // Project FCFs
      let projections = [];
      let pvSum = 0;
      
      for (let i = 1; i <= years; i++) {
        const projFCF = fcf * Math.pow(1 + growth, i);
        const pvFactor = Math.pow(1 + wacc, i);
        const pvFCF = projFCF / pvFactor;
        pvSum += pvFCF;
        projections.push({ year: i, fcf: projFCF, pv: pvFCF });
      }
      
      // Terminal value (Gordon Growth Model)
      const finalFCF = fcf * Math.pow(1 + growth, years);
      const terminalFCF = finalFCF * (1 + terminal);
      const terminalValue = terminalFCF / (wacc - terminal);
      const pvTerminal = terminalValue / Math.pow(1 + wacc, years);
      
      const enterpriseValue = pvSum + pvTerminal;
      const equityValue = enterpriseValue - debt;
      const tvPct = (pvTerminal / enterpriseValue * 100);
      
      // Results
      document.getElementById('dcf-results').innerHTML = `
        <div class="result-card">
          <div class="result-label">Enterprise Value</div>
          <div class="result-value">${fmt(enterpriseValue)}</div>
          <div style="margin-top: 0.75rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">PV of FCFs: ${fmt(pvSum)}</span>
            <span class="metric-pill neutral">PV Terminal: ${fmt(pvTerminal)}</span>
          </div>
        </div>
        
        <div class="result-card">
          <div class="result-label">Equity Value</div>
          <div class="result-value" style="${equityValue < 0 ? 'background: linear-gradient(135deg, var(--brand-danger), #f97316); -webkit-background-clip: text;' : ''}">${fmt(equityValue)}</div>
          ${debt !== 0 ? `<div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.375rem;">After ${debt > 0 ? 'subtracting' : 'adding'} ${fmtFull(Math.abs(debt))} net debt</div>` : ''}
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Key Metrics</div>
          
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Terminal Value %</div>
              <div class="mono" style="font-size: 1rem; font-weight: 700; color: ${tvPct > 75 ? 'var(--brand-warning)' : 'var(--text-primary)'};">${tvPct.toFixed(1)}%</div>
              ${tvPct > 75 ? '<div style="font-size: 0.65rem; color: var(--brand-warning);">âš ï¸ High TV reliance</div>' : ''}
            </div>
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Implied Multiple</div>
              <div class="mono" style="font-size: 1rem; font-weight: 700;">${(enterpriseValue / fcf).toFixed(1)}x FCF</div>
            </div>
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Year ${years} FCF</div>
              <div class="mono" style="font-size: 1rem; font-weight: 700;">${fmt(finalFCF)}</div>
            </div>
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Terminal Value</div>
              <div class="mono" style="font-size: 1rem; font-weight: 700;">${fmt(terminalValue)}</div>
            </div>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">FCF Projections</div>
          ${projections.map(p => `
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.375rem 0; border-bottom: 1px solid var(--border-primary);">
              <span style="font-size: 0.8rem; color: var(--text-muted);">Year ${p.year}</span>
              <span class="mono" style="font-size: 0.8rem;">${fmt(p.fcf)}</span>
              <span class="mono" style="font-size: 0.75rem; color: var(--text-muted);">PV: ${fmt(p.pv)}</span>
            </div>
          `).join('')}
        </div>
      `;
      
      // Sensitivity table
      const waccRange = [-2, -1, 0, 1, 2].map(d => wacc * 100 + d);
      const growthRange = [-1, -0.5, 0, 0.5, 1].map(d => terminal * 100 + d).filter(g => g >= 0);
      
      let tableHTML = `
        <div style="font-size: 0.85rem; font-weight: 700; margin-bottom: 1rem;">Sensitivity Analysis: Enterprise Value</div>
        <div style="overflow-x: auto;">
        <table class="sensitivity-table">
          <tr>
            <th>WACC \\ Terminal G</th>
            ${growthRange.map(g => `<th>${g.toFixed(1)}%</th>`).join('')}
          </tr>
      `;
      
      waccRange.forEach(w => {
        tableHTML += `<tr><td>${w.toFixed(1)}%</td>`;
        growthRange.forEach(g => {
          if (w / 100 <= g / 100) {
            tableHTML += '<td style="color: var(--text-muted);">N/A</td>';
            return;
          }
          let pv = 0;
          for (let i = 1; i <= years; i++) {
            pv += (fcf * Math.pow(1 + growth, i)) / Math.pow(1 + w / 100, i);
          }
          const tFCF = fcf * Math.pow(1 + growth, years) * (1 + g / 100);
          const tv = tFCF / (w / 100 - g / 100);
          const pvTV = tv / Math.pow(1 + w / 100, years);
          const ev = pv + pvTV;
          const isBase = Math.abs(w - wacc * 100) < 0.01 && Math.abs(g - terminal * 100) < 0.01;
          tableHTML += `<td class="${isBase ? 'highlight' : ''}">${fmt(ev)}</td>`;
        });
        tableHTML += '</tr>';
      });
      
      tableHTML += '</table></div>';
      document.getElementById('dcf-sensitivity').innerHTML = tableHTML;
      updateValuationComparison();
      
      // Bar chart
      const maxFCF = Math.max(...projections.map(p => p.fcf));
      document.getElementById('dcf-chart').innerHTML = `
        <div style="font-size: 0.85rem; font-weight: 700; margin-bottom: 1rem;">Projected Free Cash Flow</div>
        <div style="display: flex; align-items: flex-end; gap: 0.5rem; height: 200px; padding: 0 0.5rem;">
          ${projections.map(p => `
            <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 0.25rem;">
              <span class="mono" style="font-size: 0.65rem; color: var(--text-muted);">${fmt(p.fcf)}</span>
              <div style="width: 100%; height: ${(p.fcf / maxFCF * 150)}px; background: linear-gradient(180deg, var(--brand-primary), var(--brand-accent)); border-radius: 4px 4px 0 0; transition: height 1s ease; min-height: 4px;"></div>
              <span style="font-size: 0.7rem; color: var(--text-muted);">Y${p.year}</span>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // MULTIPLES CALCULATOR
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateMultiples() {
      const revenue = parseFloat(document.getElementById('mult-revenue').value) || 0;
      const ebitda = parseFloat(document.getElementById('mult-ebitda').value) || 0;
      const income = parseFloat(document.getElementById('mult-income').value) || 0;
      const evRev = parseFloat(document.getElementById('mult-ev-rev').value) || 0;
      const evEbitda = parseFloat(document.getElementById('mult-ev-ebitda').value) || 0;
      const pe = parseFloat(document.getElementById('mult-pe').value) || 0;
      
      const valRevenue = revenue * evRev;
      const valEbitda = ebitda * evEbitda;
      const valEarnings = income * pe;
      const average = (valRevenue + valEbitda + valEarnings) / 3;
      const median = [valRevenue, valEbitda, valEarnings].sort((a, b) => a - b)[1];
      const low = Math.min(valRevenue, valEbitda, valEarnings);
      const high = Math.max(valRevenue, valEbitda, valEarnings);
      
      // Football field chart
      const maxVal = high * 1.1;
      const barWidth = (v) => (v / maxVal * 100).toFixed(1);
      
      document.getElementById('multiples-results').innerHTML = `
        <div class="result-card">
          <div class="result-label">Blended Valuation</div>
          <div class="result-value">${fmt(average)}</div>
          <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.375rem;">Average of three methodologies</div>
        </div>
        
        <div class="result-card">
          <div class="result-label">Median Valuation</div>
          <div class="result-value">${fmt(median)}</div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Valuation Range (Football Field)</div>
          
          <div style="margin-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
              <span style="font-size: 0.8rem; font-weight: 600;">EV/Revenue (${evRev}x)</span>
              <span class="mono" style="font-size: 0.8rem;">${fmt(valRevenue)}</span>
            </div>
            <div class="chart-bar">
              <div class="chart-bar-fill" style="width: ${barWidth(valRevenue)}%; background: linear-gradient(90deg, #6366f1, #818cf8);"></div>
            </div>
          </div>
          
          <div style="margin-bottom: 1rem;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
              <span style="font-size: 0.8rem; font-weight: 600;">EV/EBITDA (${evEbitda}x)</span>
              <span class="mono" style="font-size: 0.8rem;">${fmt(valEbitda)}</span>
            </div>
            <div class="chart-bar">
              <div class="chart-bar-fill" style="width: ${barWidth(valEbitda)}%; background: linear-gradient(90deg, #8b5cf6, #a78bfa);"></div>
            </div>
          </div>
          
          <div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
              <span style="font-size: 0.8rem; font-weight: 600;">P/E (${pe}x)</span>
              <span class="mono" style="font-size: 0.8rem;">${fmt(valEarnings)}</span>
            </div>
            <div class="chart-bar">
              <div class="chart-bar-fill" style="width: ${barWidth(valEarnings)}%; background: linear-gradient(90deg, #06b6d4, #22d3ee);"></div>
            </div>
          </div>
          
          <div class="divider"></div>
          <div style="display: flex; justify-content: space-between; font-size: 0.8rem;">
            <span style="color: var(--text-muted);">Range: ${fmt(low)} â€” ${fmt(high)}</span>
            <span style="color: var(--text-muted);">Spread: ${((high - low) / average * 100).toFixed(0)}%</span>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Implied Metrics</div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">EBITDA Margin</div>
              <div class="mono" style="font-weight: 700;">${revenue > 0 ? (ebitda / revenue * 100).toFixed(1) + '%' : 'N/A'}</div>
            </div>
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Net Margin</div>
              <div class="mono" style="font-weight: 700;">${revenue > 0 ? (income / revenue * 100).toFixed(1) + '%' : 'N/A'}</div>
            </div>
          </div>
        </div>
      `;
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // MULTIPLES - hook comparison
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // (comparison updated via tab switch)

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ASSET-BASED CALCULATOR
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateAsset() {
      const cash = parseFloat(document.getElementById('asset-cash').value) || 0;
      const ar = parseFloat(document.getElementById('asset-ar').value) || 0;
      const inv = parseFloat(document.getElementById('asset-inv').value) || 0;
      const ppe = parseFloat(document.getElementById('asset-ppe').value) || 0;
      const other = parseFloat(document.getElementById('asset-other').value) || 0;
      const ap = parseFloat(document.getElementById('asset-ap').value) || 0;
      const debt = parseFloat(document.getElementById('asset-debt').value) || 0;
      const otherLiab = parseFloat(document.getElementById('asset-otherliab').value) || 0;
      
      const totalAssets = cash + ar + inv + ppe + other;
      const totalLiab = ap + debt + otherLiab;
      const nav = totalAssets - totalLiab;
      const currentRatio = (ap + otherLiab) > 0 ? (cash + ar + inv) / (ap + otherLiab) : 0;
      
      document.getElementById('asset-results').innerHTML = `
        <div class="result-card">
          <div class="result-label">Net Asset Value (NAV)</div>
          <div class="result-value">${fmtFull(nav)}</div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Balance Sheet</div>
          <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-primary);">
            <span style="font-size: 0.85rem; color: var(--brand-success);">Total Assets</span>
            <span class="mono" style="font-size: 0.85rem;">${fmtFull(totalAssets)}</span>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-primary);">
            <span style="font-size: 0.85rem; color: var(--brand-danger);">Total Liabilities</span>
            <span class="mono" style="font-size: 0.85rem;">${fmtFull(totalLiab)}</span>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; font-weight: 700;">
            <span style="font-size: 0.85rem;">Net Asset Value</span>
            <span class="mono" style="font-size: 0.85rem; color: ${nav >= 0 ? 'var(--brand-success)' : 'var(--brand-danger)'};">${fmtFull(nav)}</span>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Ratios</div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Current Ratio</div>
              <div class="mono" style="font-weight: 700; color: ${currentRatio >= 1.5 ? 'var(--brand-success)' : currentRatio >= 1 ? 'var(--brand-warning)' : 'var(--brand-danger)'};">${currentRatio.toFixed(2)}x</div>
            </div>
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Debt Ratio</div>
              <div class="mono" style="font-weight: 700;">${totalAssets > 0 ? (totalLiab / totalAssets * 100).toFixed(1) + '%' : 'N/A'}</div>
            </div>
          </div>
        </div>
      `;
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // MORTGAGE CALCULATOR
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateMortgage() {
      const price = parseFloat(document.getElementById('mort-price').value) || 0;
      const downPct = (parseFloat(document.getElementById('mort-down').value) || 0) / 100;
      const rate = (parseFloat(document.getElementById('mort-rate').value) || 0) / 100;
      const amort = parseInt(document.getElementById('mort-amort').value) || 25;
      const freq = parseInt(document.getElementById('mort-freq').value) || 12;
      const province = document.getElementById('mort-province').value;
      
      const downPayment = price * downPct;
      const principal = price - downPayment;
      
      // Update down payment help
      document.getElementById('mort-down-help').textContent = `Down payment: ${fmtFull(downPayment)}`;
      
      // CMHC Insurance (if down < 20%)
      let cmhcPremium = 0;
      if (downPct < 0.20) {
        if (downPct >= 0.15) cmhcPremium = principal * 0.028;
        else if (downPct >= 0.10) cmhcPremium = principal * 0.031;
        else cmhcPremium = principal * 0.04;
      }
      
      const totalMortgage = principal + cmhcPremium;
      
      // Canadian mortgage: semi-annual compounding
      const semiAnnualRate = Math.pow(1 + rate / 2, 2) - 1;
      const periodicRate = Math.pow(1 + semiAnnualRate, 1 / freq) - 1;
      const totalPayments = amort * freq;
      
      // Payment calculation
      const payment = totalMortgage * (periodicRate * Math.pow(1 + periodicRate, totalPayments)) / (Math.pow(1 + periodicRate, totalPayments) - 1);
      const monthlyEquiv = payment * freq / 12;
      const totalCost = payment * totalPayments;
      const totalInterest = totalCost - totalMortgage;
      
      // OSFI Stress Test
      const stressRate = Math.max(rate + 0.02, 0.0525);
      const stressSemiAnnual = Math.pow(1 + stressRate / 2, 2) - 1;
      const stressPeriodic = Math.pow(1 + stressSemiAnnual, 1 / 12) - 1;
      const stressPayment = totalMortgage * (stressPeriodic * Math.pow(1 + stressPeriodic, amort * 12)) / (Math.pow(1 + stressPeriodic, amort * 12) - 1);
      
      // Land Transfer Tax
      let ltt = 0;
      if (province === 'ON') {
        // Ontario LTT
        if (price <= 55000) ltt = price * 0.005;
        else if (price <= 250000) ltt = 275 + (price - 55000) * 0.01;
        else if (price <= 400000) ltt = 2225 + (price - 250000) * 0.015;
        else if (price <= 2000000) ltt = 4475 + (price - 400000) * 0.02;
        else ltt = 36475 + (price - 2000000) * 0.025;
      } else if (province === 'BC') {
        if (price <= 200000) ltt = price * 0.01;
        else if (price <= 2000000) ltt = 2000 + (price - 200000) * 0.02;
        else ltt = 38000 + (price - 2000000) * 0.03;
      }
      
      const freqLabel = { 12: 'Monthly', 26: 'Bi-Weekly', 52: 'Weekly', 24: 'Semi-Monthly' }[freq];
      
      document.getElementById('mortgage-results').innerHTML = `
        <div class="result-card">
          <div class="result-label">${freqLabel} Payment</div>
          <div class="result-value">${fmtFull(payment)}</div>
          <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.375rem;">Monthly equivalent: ${fmtFull(monthlyEquiv)}</div>
        </div>
        
        <div class="result-card">
          <div class="result-label">Total Cost of Mortgage</div>
          <div class="result-value">${fmt(totalCost)}</div>
          <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Principal: ${fmt(totalMortgage)}</span>
            <span class="metric-pill negative">Interest: ${fmt(totalInterest)}</span>
          </div>
        </div>
        
        ${cmhcPremium > 0 ? `
        <div class="glass-card" style="padding: var(--space-lg); border-color: rgba(245, 158, 11, 0.3);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--brand-warning); margin-bottom: 0.375rem;">âš ï¸ CMHC INSURANCE REQUIRED</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary);">Down payment is less than 20%. CMHC premium of <span class="mono" style="font-weight: 700;">${fmtFull(cmhcPremium)}</span> added to mortgage.</div>
        </div>
        ` : ''}
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Closing Costs</div>
          <div style="display: flex; justify-content: space-between; padding: 0.375rem 0; border-bottom: 1px solid var(--border-primary);">
            <span style="font-size: 0.85rem;">Down Payment</span>
            <span class="mono" style="font-size: 0.85rem;">${fmtFull(downPayment)}</span>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.375rem 0; border-bottom: 1px solid var(--border-primary);">
            <span style="font-size: 0.85rem;">Land Transfer Tax</span>
            <span class="mono" style="font-size: 0.85rem;">${fmtFull(ltt)}</span>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.375rem 0; border-bottom: 1px solid var(--border-primary);">
            <span style="font-size: 0.85rem;">Legal Fees (est.)</span>
            <span class="mono" style="font-size: 0.85rem;">${fmtFull(2000)}</span>
          </div>
          <div style="display: flex; justify-content: space-between; padding: 0.5rem 0; font-weight: 700;">
            <span style="font-size: 0.85rem;">Total Cash Needed</span>
            <span class="mono" style="font-size: 0.85rem;">${fmtFull(downPayment + ltt + 2000)}</span>
          </div>
        </div>
        <div class="affiliate-cta">
          <span class="ad-label">Sponsored</span>
          Looking for the best mortgage rates? <a href="#">Compare rates at [Partner Name]</a>
        </div>
      `;
      
      // Stress test
      document.getElementById('mortgage-stress').innerHTML = `
        <div style="font-size: 0.85rem; font-weight: 700; margin-bottom: 1rem;">ğŸ›ï¸ OSFI Stress Test (B-20)</div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
          <div class="glass-card" style="padding: var(--space-lg); text-align: center;">
            <div style="font-size: 0.72rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em;">Your Rate</div>
            <div class="mono" style="font-size: 1.5rem; font-weight: 700; color: var(--brand-success);">${(rate * 100).toFixed(2)}%</div>
            <div class="mono" style="font-size: 1rem; margin-top: 0.375rem;">${fmtFull(monthlyEquiv)}/mo</div>
          </div>
          <div class="glass-card" style="padding: var(--space-lg); text-align: center;">
            <div style="font-size: 0.72rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em;">Stress Test Rate</div>
            <div class="mono" style="font-size: 1.5rem; font-weight: 700; color: var(--brand-warning);">${(stressRate * 100).toFixed(2)}%</div>
            <div class="mono" style="font-size: 1rem; margin-top: 0.375rem;">${fmtFull(stressPayment)}/mo</div>
          </div>
        </div>
        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 1rem; text-align: center;">
          You must qualify at the stress test rate (contract rate + 2% or 5.25%, whichever is higher). Monthly payment increases by ${fmtFull(stressPayment - monthlyEquiv)}.
        </div>
      `;
      
      // Simple amortization visualization
      let balance = totalMortgage;
      const monthlyRate = Math.pow(1 + semiAnnualRate, 1 / 12) - 1;
      const monthlyPmt = totalMortgage * (monthlyRate * Math.pow(1 + monthlyRate, amort * 12)) / (Math.pow(1 + monthlyRate, amort * 12) - 1);
      let yearlyData = [];
      
      for (let year = 1; year <= amort; year++) {
        let yearInterest = 0;
        let yearPrincipal = 0;
        for (let m = 0; m < 12; m++) {
          const interestPmt = balance * monthlyRate;
          const principalPmt = monthlyPmt - interestPmt;
          yearInterest += interestPmt;
          yearPrincipal += principalPmt;
          balance -= principalPmt;
          if (balance < 0) balance = 0;
        }
        yearlyData.push({ year, balance, interest: yearInterest, principal: yearPrincipal });
      }
      
      let amortTableRows = yearlyData.map(d => `
          <tr>
            <td>${d.year}</td>
            <td>${fmtFull(d.year === 1 ? totalMortgage : yearlyData[d.year-2].balance)}</td>
            <td>${fmtFull(monthlyPmt * 12)}</td>
            <td>${fmtFull(d.principal)}</td>
            <td>${fmtFull(d.interest)}</td>
            <td>${fmtFull(d.balance)}</td>
          </tr>`).join('');

      document.getElementById('mortgage-amort').innerHTML = `
        <div style="font-size: 0.85rem; font-weight: 700; margin-bottom: 1rem;">Amortization â€” Balance Over Time</div>
        <div style="display: flex; align-items: flex-end; gap: 2px; height: 200px; padding: 0;">
          ${yearlyData.map(d => `
            <div style="flex: 1; height: ${(d.balance / totalMortgage * 190)}px; background: linear-gradient(180deg, var(--brand-primary), var(--brand-accent)); border-radius: 2px 2px 0 0; min-height: 2px; position: relative;" title="Year ${d.year}: ${fmtFull(d.balance)} remaining"></div>
          `).join('')}
        </div>
        <div style="display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--text-muted); margin-top: 0.5rem;">
          <span>Year 1</span>
          <span>Year ${Math.floor(amort / 2)}</span>
          <span>Year ${amort}</span>
        </div>
        <div class="accordion-item" style="margin-top: 1.5rem;">
          <div class="accordion-header" onclick="this.parentElement.classList.toggle('open')">
            <span>ğŸ“‹ View Full Amortization Schedule</span>
            <span class="accordion-arrow">â–¼</span>
          </div>
          <div class="accordion-body">
            <div class="accordion-body-inner" style="overflow-x: auto; padding: 0.5rem;">
              <table class="sensitivity-table">
                <thead>
                  <tr>
                    <th>Year</th>
                    <th>Opening Balance</th>
                    <th>Annual Payment</th>
                    <th>Principal</th>
                    <th>Interest</th>
                    <th>Closing Balance</th>
                  </tr>
                </thead>
                <tbody>${amortTableRows}</tbody>
              </table>
            </div>
          </div>
        </div>
      `;
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // CAGR CALCULATOR
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateCAGR() {
      const initial = parseFloat(document.getElementById('cagr-initial').value) || 0;
      const final_ = parseFloat(document.getElementById('cagr-final').value) || 0;
      const years = parseFloat(document.getElementById('cagr-years').value) || 1;
      
      if (initial <= 0) {
        document.getElementById('cagr-results').innerHTML = `<div class="result-card"><p style="color: var(--text-muted);">Enter a positive initial investment.</p></div>`;
        return;
      }
      
      const cagr = (Math.pow(final_ / initial, 1 / years) - 1) * 100;
      const totalReturn = ((final_ - initial) / initial) * 100;
      const gain = final_ - initial;
      
      document.getElementById('cagr-results').innerHTML = `
        <div class="result-card">
          <div class="result-label">CAGR</div>
          <div class="result-value">${cagr.toFixed(2)}%</div>
          <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.375rem;">Compound Annual Growth Rate</div>
        </div>
        
        <div class="result-card">
          <div class="result-label">Total Return</div>
          <div class="result-value" style="${totalReturn >= 0 ? '' : 'background: linear-gradient(135deg, var(--brand-danger), #f97316); -webkit-background-clip: text;'}">${totalReturn.toFixed(1)}%</div>
          <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
            <span class="metric-pill ${gain >= 0 ? 'positive' : 'negative'}">${gain >= 0 ? '+' : ''}${fmtFull(gain)}</span>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Rule of 72</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary);">
            At ${cagr.toFixed(1)}% CAGR, your money doubles every <strong style="color: var(--text-primary);">${cagr > 0 ? (72 / cagr).toFixed(1) : 'âˆ'} years</strong>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Benchmarks</div>
          <div style="font-size: 0.8rem; color: var(--text-secondary); display: flex; flex-direction: column; gap: 0.5rem;">
            <div style="display: flex; justify-content: space-between;">
              <span>S&P 500 (30yr avg)</span>
              <span class="mono" style="color: ${cagr > 10.7 ? 'var(--brand-success)' : 'var(--text-muted)'};">~10.7%</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span>Warren Buffett</span>
              <span class="mono" style="color: ${cagr > 20 ? 'var(--brand-success)' : 'var(--text-muted)'};">~20%</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span>GIC (Canada)</span>
              <span class="mono">~4-5%</span>
            </div>
          </div>
        </div>
      `;
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // DCA SIMULATOR
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateDCA() {
      const monthly = parseFloat(document.getElementById('dca-monthly').value) || 0;
      const annualReturn = (parseFloat(document.getElementById('dca-return').value) || 0) / 100;
      const years = parseInt(document.getElementById('dca-years').value) || 1;
      const initial = parseFloat(document.getElementById('dca-initial').value) || 0;
      
      const monthlyRate = Math.pow(1 + annualReturn, 1 / 12) - 1;
      const totalMonths = years * 12;
      
      let balance = initial;
      let totalContributed = initial;
      let yearlyData = [];
      
      for (let m = 1; m <= totalMonths; m++) {
        balance = balance * (1 + monthlyRate) + monthly;
        totalContributed += monthly;
        if (m % 12 === 0) {
          yearlyData.push({ year: m / 12, balance, contributed: totalContributed, earnings: balance - totalContributed });
        }
      }
      
      const totalEarnings = balance - totalContributed;
      const inflationRate = (parseFloat(document.getElementById('dca-inflation').value) || 0) / 100;
      const realValue = balance / Math.pow(1 + inflationRate, years);
      
      document.getElementById('dca-results').innerHTML = `
        <div class="result-card">
          <div class="result-label">Final Portfolio Value (Nominal)</div>
          <div class="result-value">${fmtFull(balance)}</div>
        </div>
        
        <div class="result-card" style="border-color: rgba(245, 158, 11, 0.3); background: linear-gradient(135deg, rgba(245, 158, 11, 0.08), rgba(245, 158, 11, 0.03));">
          <div class="result-label">Real Value (Inflation-Adjusted)</div>
          <div class="result-value" style="background: linear-gradient(135deg, var(--brand-warning), #f97316); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${fmtFull(realValue)}</div>
          <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: 0.375rem;">In today's dollars at ${(inflationRate*100).toFixed(1)}% inflation</div>
          <div style="font-size: 0.75rem; color: var(--text-muted);">Purchasing power erosion: ${fmtFull(balance - realValue)}</div>
        </div>
        
        <div class="result-card">
          <div class="result-label">Investment Earnings</div>
          <div class="result-value" style="background: linear-gradient(135deg, var(--brand-success), #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${fmtFull(totalEarnings)}</div>
          <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem; flex-wrap: wrap;">
            <span class="metric-pill neutral">Contributed: ${fmtFull(totalContributed)}</span>
            <span class="metric-pill positive">Earned: ${fmtFull(totalEarnings)}</span>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Breakdown</div>
          <div style="margin-bottom: 0.75rem;">
            <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
              <span>Contributions</span>
              <span class="mono">${(totalContributed / balance * 100).toFixed(0)}%</span>
            </div>
            <div class="chart-bar">
              <div class="chart-bar-fill" style="width: ${(totalContributed / balance * 100)}%; background: var(--brand-primary);"></div>
            </div>
          </div>
          <div>
            <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
              <span>Earnings (Compound Growth)</span>
              <span class="mono">${(totalEarnings / balance * 100).toFixed(0)}%</span>
            </div>
            <div class="chart-bar">
              <div class="chart-bar-fill" style="width: ${(totalEarnings / balance * 100)}%; background: linear-gradient(90deg, var(--brand-success), var(--brand-accent));"></div>
            </div>
          </div>
        </div>
      `;
      
      // Growth chart
      if (yearlyData.length > 0) {
        const maxVal = yearlyData[yearlyData.length - 1].balance;
        document.getElementById('dca-chart').innerHTML = `
          <div style="font-size: 0.85rem; font-weight: 700; margin-bottom: 1rem;">Portfolio Growth Over Time</div>
          <div style="display: flex; align-items: flex-end; gap: 3px; height: 220px;">
            ${yearlyData.map(d => `
              <div style="flex: 1; display: flex; flex-direction: column; justify-content: flex-end; height: 100%;">
                <div style="display: flex; flex-direction: column; justify-content: flex-end; height: ${(d.balance / maxVal * 200)}px;">
                  <div style="height: ${(d.earnings / maxVal * 200)}px; background: linear-gradient(180deg, var(--brand-success), rgba(16,185,129,0.3)); border-radius: 3px 3px 0 0; min-height: 1px;" title="Earnings: ${fmtFull(d.earnings)}"></div>
                  <div style="height: ${(d.contributed / maxVal * 200)}px; background: linear-gradient(180deg, var(--brand-primary), rgba(99,102,241,0.3)); min-height: 1px;" title="Contributed: ${fmtFull(d.contributed)}"></div>
                </div>
                ${d.year % 5 === 0 || d.year === years ? `<span style="font-size: 0.6rem; color: var(--text-muted); text-align: center; margin-top: 4px;">Y${d.year}</span>` : ''}
              </div>
            `).join('')}
          </div>
          <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem; font-size: 0.75rem;">
            <div style="display: flex; align-items: center; gap: 0.375rem;"><div style="width: 12px; height: 12px; border-radius: 2px; background: var(--brand-primary);"></div> Contributions</div>
            <div style="display: flex; align-items: center; gap: 0.375rem;"><div style="width: 12px; height: 12px; border-radius: 2px; background: var(--brand-success);"></div> Earnings</div>
          </div>
        `;
      }
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // RETIREMENT (RRSP vs TFSA)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateRetirement() {
      const income = parseFloat(document.getElementById('ret-income').value) || 0;
      const contribution = parseFloat(document.getElementById('ret-contribution').value) || 0;
      const age = parseInt(document.getElementById('ret-age').value) || 30;
      const retireAge = parseInt(document.getElementById('ret-retire-age').value) || 65;
      const annualReturn = (parseFloat(document.getElementById('ret-return').value) || 0) / 100;
      const retireIncome = parseFloat(document.getElementById('ret-retire-income').value) || 0;
      const province = document.getElementById('ret-province').value;
      
      const years = retireAge - age;
      if (years <= 0) {
        document.getElementById('retirement-results').innerHTML = '<div class="result-card"><p style="color: var(--text-muted);">Retirement age must be greater than current age.</p></div>';
        return;
      }
      
      // Canadian federal tax brackets (2025)
      const fedTax = (inc) => {
        if (inc <= 0) return 0;
        let tax = 0;
        const brackets = [
          [55867, 0.15], [55867, 0.205], [61942, 0.26], [70000, 0.29], [Infinity, 0.33]
        ];
        let remaining = inc;
        for (const [limit, rate] of brackets) {
          const taxable = Math.min(remaining, limit);
          tax += taxable * rate;
          remaining -= taxable;
          if (remaining <= 0) break;
        }
        return tax;
      };
      
      // Provincial tax (simplified â€” Ontario)
      const provTax = (inc) => {
        if (province !== 'ON' || inc <= 0) return inc * 0.05; // Simplified for non-ON
        let tax = 0;
        const brackets = [
          [51446, 0.0505], [51446, 0.0915], [47046, 0.1116], [100000, 0.1216], [Infinity, 0.1316]
        ];
        let remaining = inc;
        for (const [limit, rate] of brackets) {
          const taxable = Math.min(remaining, limit);
          tax += taxable * rate;
          remaining -= taxable;
          if (remaining <= 0) break;
        }
        return tax;
      };
      
      const marginalRate = (inc) => {
        const tax1 = fedTax(inc) + provTax(inc);
        const tax2 = fedTax(inc + 1) + provTax(inc + 1);
        return tax2 - tax1;
      };
      
      const currentMarginal = marginalRate(income);
      const retireMarginal = marginalRate(retireIncome);
      
      // RRSP: Tax deduction now, taxed on withdrawal
      const rrspTaxSavings = contribution * currentMarginal;
      const rrspGross = contribution; // Full amount invested
      let rrspBalance = 0;
      for (let y = 0; y < years; y++) {
        rrspBalance = (rrspBalance + rrspGross) * (1 + annualReturn);
      }
      const rrspAfterTax = rrspBalance * (1 - retireMarginal);
      
      // TFSA: No deduction, tax-free growth and withdrawal
      const tfsaNet = contribution; // Same contribution amount
      let tfsaBalance = 0;
      for (let y = 0; y < years; y++) {
        tfsaBalance = (tfsaBalance + tfsaNet) * (1 + annualReturn);
      }
      
      // RRSP with reinvested refund
      const rrspWithRefund = contribution + rrspTaxSavings;
      let rrspRefundBalance = 0;
      for (let y = 0; y < years; y++) {
        rrspRefundBalance = (rrspRefundBalance + rrspWithRefund) * (1 + annualReturn);
      }
      const rrspRefundAfterTax = rrspRefundBalance * (1 - retireMarginal);
      
      const winner = rrspRefundAfterTax > tfsaBalance ? 'RRSP' : 'TFSA';
      const advantage = Math.abs(rrspRefundAfterTax - tfsaBalance);
      
      document.getElementById('retirement-results').innerHTML = `
        <div class="gradient-border-card">
          <div class="gradient-border-card-inner" style="text-align: center;">
            <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.5rem;">Recommendation</div>
            <div style="font-size: 1.75rem; font-weight: 800; margin-bottom: 0.25rem;">${winner} Wins</div>
            <div style="font-size: 0.85rem; color: var(--text-secondary);">by ${fmtFull(advantage)} over ${years} years</div>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div style="text-align: center; padding: 1rem; border-radius: var(--radius-md); background: ${winner === 'RRSP' ? 'rgba(99, 102, 241, 0.1)' : 'transparent'};">
              <div style="font-size: 0.72rem; color: var(--text-muted); text-transform: uppercase;">RRSP (After Tax)</div>
              <div class="mono" style="font-size: 1.25rem; font-weight: 700; color: var(--brand-primary);">${fmtFull(rrspRefundAfterTax)}</div>
              <div style="font-size: 0.72rem; color: var(--text-muted); margin-top: 0.25rem;">Pre-tax: ${fmtFull(rrspRefundBalance)}</div>
            </div>
            <div style="text-align: center; padding: 1rem; border-radius: var(--radius-md); background: ${winner === 'TFSA' ? 'rgba(6, 182, 212, 0.1)' : 'transparent'};">
              <div style="font-size: 0.72rem; color: var(--text-muted); text-transform: uppercase;">TFSA (Tax-Free)</div>
              <div class="mono" style="font-size: 1.25rem; font-weight: 700; color: var(--brand-accent);">${fmtFull(tfsaBalance)}</div>
              <div style="font-size: 0.72rem; color: var(--text-muted); margin-top: 0.25rem;">100% tax-free</div>
            </div>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Tax Analysis</div>
          <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.85rem;">
            <div style="display: flex; justify-content: space-between;">
              <span style="color: var(--text-secondary);">Current Marginal Rate</span>
              <span class="mono" style="font-weight: 700;">${(currentMarginal * 100).toFixed(1)}%</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="color: var(--text-secondary);">Retirement Marginal Rate</span>
              <span class="mono" style="font-weight: 700;">${(retireMarginal * 100).toFixed(1)}%</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="color: var(--text-secondary);">RRSP Tax Refund (Annual)</span>
              <span class="mono" style="font-weight: 700; color: var(--brand-success);">${fmtFull(rrspTaxSavings)}</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="color: var(--text-secondary);">Tax Rate Arbitrage</span>
              <span class="mono" style="font-weight: 700; color: ${currentMarginal > retireMarginal ? 'var(--brand-success)' : 'var(--brand-danger)'};">${((currentMarginal - retireMarginal) * 100).toFixed(1)}%</span>
            </div>
          </div>
          <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 1rem; padding: 0.75rem; background: rgba(99,102,241,0.05); border-radius: var(--radius-sm);">
            ğŸ’¡ <strong>Rule of thumb:</strong> RRSP wins when your current tax rate is higher than your expected retirement tax rate. TFSA wins when rates are the same or lower now.
          </div>
        </div>
        <div class="affiliate-cta">
          <span class="ad-label">Ad</span>
          Open a TFSA with <a href="#">Canada's top-rated platforms</a>
        </div>
      `;
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // COMPOUND INTEREST
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateCompound() {
      const initial = parseFloat(document.getElementById('comp-initial').value) || 0;
      const monthly = parseFloat(document.getElementById('comp-monthly').value) || 0;
      const rate = (parseFloat(document.getElementById('comp-rate').value) || 0) / 100;
      const years = parseInt(document.getElementById('comp-years').value) || 1;
      const freq = parseInt(document.getElementById('comp-freq').value) || 1;
      
      const periodicRate = rate / freq;
      const totalPeriods = years * freq;
      const monthlyPeriods = freq / 12;
      
      // Calculate with contributions
      let balance = initial;
      let totalContributed = initial;
      let yearlyData = [];
      
      for (let month = 1; month <= years * 12; month++) {
        // Apply interest for the month
        const monthlyRate = Math.pow(1 + rate, 1 / 12) - 1;
        balance = balance * (1 + monthlyRate) + monthly;
        totalContributed += monthly;
        
        if (month % 12 === 0) {
          yearlyData.push({
            year: month / 12,
            balance,
            contributed: totalContributed,
            interest: balance - totalContributed
          });
        }
      }
      
      // Without contributions (initial only)
      const withoutContrib = initial * Math.pow(1 + rate, years);
      
      const totalInterest = balance - totalContributed;
      const effectiveRate = (Math.pow(balance / totalContributed, 1 / years) - 1) * 100;
      
      document.getElementById('compound-results').innerHTML = `
        <div class="result-card">
          <div class="result-label">Future Value</div>
          <div class="result-value">${fmtFull(balance)}</div>
        </div>
        
        <div class="result-card">
          <div class="result-label">Interest Earned</div>
          <div class="result-value" style="background: linear-gradient(135deg, var(--brand-success), var(--brand-accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${fmtFull(totalInterest)}</div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">Summary</div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; font-size: 0.85rem;">
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Total Contributed</div>
              <div class="mono" style="font-weight: 700;">${fmtFull(totalContributed)}</div>
            </div>
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Growth Multiple</div>
              <div class="mono" style="font-weight: 700;">${(balance / totalContributed).toFixed(2)}x</div>
            </div>
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Without Contributions</div>
              <div class="mono" style="font-weight: 700;">${fmtFull(withoutContrib)}</div>
            </div>
            <div>
              <div style="font-size: 0.72rem; color: var(--text-muted);">Contribution Impact</div>
              <div class="mono" style="font-weight: 700; color: var(--brand-success);">+${fmtFull(balance - withoutContrib)}</div>
            </div>
          </div>
        </div>
        
        <div class="glass-card" style="padding: var(--space-lg);">
          <div style="font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 0.75rem;">The Power of Compound Interest</div>
          <div style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.7;">
            Your ${fmtFull(monthly)}/month contributions turn into <strong style="color: var(--text-primary);">${fmtFull(balance)}</strong> over ${years} years.
            That's <strong style="color: var(--brand-success);">${fmtFull(totalInterest)}</strong> in pure compound growth â€” money your money earned for you.
          </div>
        </div>
        <div class="affiliate-cta">
          <span class="ad-label">Sponsored</span>
          Start investing with <a href="#">$0 commissions</a>
        </div>
      `;
      
      // Growth chart
      if (yearlyData.length > 0) {
        const maxVal = yearlyData[yearlyData.length - 1].balance;
        document.getElementById('compound-chart').innerHTML = `
          <div style="font-size: 0.85rem; font-weight: 700; margin-bottom: 1rem;">Growth Visualization</div>
          <div style="display: flex; align-items: flex-end; gap: 3px; height: 240px;">
            ${yearlyData.map(d => `
              <div style="flex: 1; display: flex; flex-direction: column; justify-content: flex-end; height: 100%;">
                <div style="display: flex; flex-direction: column; justify-content: flex-end; height: ${(d.balance / maxVal * 220)}px;">
                  <div style="height: ${(d.interest / maxVal * 220)}px; background: linear-gradient(180deg, var(--brand-success), rgba(16,185,129,0.2)); border-radius: 3px 3px 0 0; min-height: 1px;" title="Interest: ${fmtFull(d.interest)}"></div>
                  <div style="height: ${(d.contributed / maxVal * 220)}px; background: linear-gradient(180deg, var(--brand-primary), rgba(99,102,241,0.2)); min-height: 1px;" title="Contributed: ${fmtFull(d.contributed)}"></div>
                </div>
                ${d.year % Math.ceil(years / 10) === 0 || d.year === years ? `<span style="font-size: 0.55rem; color: var(--text-muted); text-align: center; margin-top: 4px;">Y${d.year}</span>` : ''}
              </div>
            `).join('')}
          </div>
          <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1rem; font-size: 0.75rem;">
            <div style="display: flex; align-items: center; gap: 0.375rem;"><div style="width: 12px; height: 12px; border-radius: 2px; background: var(--brand-primary);"></div> Contributions</div>
            <div style="display: flex; align-items: center; gap: 0.375rem;"><div style="width: 12px; height: 12px; border-radius: 2px; background: var(--brand-success);"></div> Compound Interest</div>
          </div>
        `;
      }
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TEST SUITE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function runTests() {
      const results = [];
      let passed = 0;
      let failed = 0;
      
      function assert(name, condition, detail) {
        if (condition) {
          passed++;
          results.push({ name, status: 'PASS', detail });
        } else {
          failed++;
          results.push({ name, status: 'FAIL', detail });
        }
      }
      
      // â”€â”€ Formatting Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      assert('fmt: millions', fmt(5000000) === '$5.0M', fmt(5000000));
      assert('fmt: billions', fmt(2500000000) === '$2.5B', fmt(2500000000));
      assert('fmt: thousands', fmt(50000) === '$50.0K', fmt(50000));
      assert('fmt: zero', fmt(0) === '$0.00', fmt(0));
      assert('fmt: negative', fmt(-3000000).includes('-'), fmt(-3000000));
      assert('fmt: NaN guard', fmt(NaN) === '$0', fmt(NaN));
      assert('fmt: undefined guard', fmt(undefined) === '$0', fmt(undefined));
      assert('fmtPct: basic', fmtPct(12.345) === '12.3%', fmtPct(12.345));
      assert('fmtFull: formats number', fmtFull(1234).length > 0, fmtFull(1234));
      
      // â”€â”€ DCF Calculation Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const fcf = 1000000;
      const growth = 0.10;
      const terminal = 0.025;
      const wacc = 0.12;
      const years = 5;
      
      let pvSum = 0;
      for (let i = 1; i <= years; i++) {
        pvSum += (fcf * Math.pow(1 + growth, i)) / Math.pow(1 + wacc, i);
      }
      const finalFCF = fcf * Math.pow(1 + growth, years);
      const tv = finalFCF * (1 + terminal) / (wacc - terminal);
      const pvTV = tv / Math.pow(1 + wacc, years);
      const ev = pvSum + pvTV;
      
      assert('DCF: PV of FCFs > 0', pvSum > 0, `PV sum = ${pvSum.toFixed(0)}`);
      assert('DCF: Terminal value > 0', tv > 0, `TV = ${tv.toFixed(0)}`);
      assert('DCF: EV > initial FCF', ev > fcf, `EV = ${ev.toFixed(0)}`);
      assert('DCF: EV reasonable range', ev > 5000000 && ev < 50000000, `EV = ${fmt(ev)}`);
      
      // â”€â”€ M&A Accretion/Dilution Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const acqEPS = 5.00, acqShares = 100, acqPrice = 50;
      const tgtEPS = 2.00, tgtShares = 50, tgtPrice = 20;
      const maPremium = 0.25, maCashPct = 0.50, maDebtCost = 0.05, maTaxRate = 0.25;
      const maOfferPrice = tgtPrice * (1 + maPremium);
      const maDealValue = maOfferPrice * tgtShares;
      const maCashPortion = maDealValue * maCashPct;
      const maStockPortion = maDealValue * (1 - maCashPct);
      const maNewShares = maStockPortion / acqPrice;
      const maProFormaShares = acqShares + maNewShares;
      const maAcqNI = acqEPS * acqShares;
      const maTgtNI = tgtEPS * tgtShares;
      const maInterest = maCashPortion * maDebtCost * (1 - maTaxRate);
      const maProFormaNI = maAcqNI + maTgtNI - maInterest;
      const maProFormaEPS = maProFormaNI / maProFormaShares;
      const maAccDil = ((maProFormaEPS - acqEPS) / acqEPS) * 100;
      assert('M&A: offer price includes premium', maOfferPrice === 25, `Offer = ${maOfferPrice}`);
      assert('M&A: deal value correct', maDealValue === 1250, `Deal = ${maDealValue}`);
      assert('M&A: accretive deal detected', maAccDil > 0, `Accretion = ${maAccDil.toFixed(2)}%`);
      // Dilutive scenario: high premium
      const dilOfferPrice = tgtPrice * 3;
      const dilDealValue = dilOfferPrice * tgtShares;
      const dilNewShares = dilDealValue / acqPrice;
      const dilProFormaShares = acqShares + dilNewShares;
      const dilProFormaEPS = (maAcqNI + maTgtNI) / dilProFormaShares;
      const dilAccDil = ((dilProFormaEPS - acqEPS) / acqEPS) * 100;
      assert('M&A: dilutive with high premium', dilAccDil < 0, `Dilution = ${dilAccDil.toFixed(2)}%`);
      
      // â”€â”€ Mortgage Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const price = 800000;
      const mortDownPct = 0.20;
      const rate = 0.055;
      const principal = price * (1 - mortDownPct);
      const semiRate = Math.pow(1 + rate / 2, 2) - 1;
      const mRate = Math.pow(1 + semiRate, 1 / 12) - 1;
      const mPayment = principal * (mRate * Math.pow(1 + mRate, 300)) / (Math.pow(1 + mRate, 300) - 1);
      
      assert('Mortgage: payment > 0', mPayment > 0, `Payment = ${mPayment.toFixed(2)}`);
      assert('Mortgage: payment reasonable', mPayment > 2000 && mPayment < 6000, `Payment = ${fmtFull(mPayment)}`);
      assert('Mortgage: semi-annual compounding', semiRate > rate, `Effective = ${(semiRate * 100).toFixed(3)}%`);
      
      // â”€â”€ CMHC Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      assert('CMHC: not required at 20% down', mortDownPct >= 0.20, 'Down 20% = no CMHC');
      const cmhc10Down = 0.10;
      const cmhc10Principal = price * (1 - cmhc10Down);
      const cmhc10Premium = cmhc10Principal * 0.031;
      assert('CMHC: premium applies at 10% down', cmhc10Premium > 0, `CMHC = ${cmhc10Premium.toFixed(0)}`);
      assert('CMHC: 10% down premium > 0', cmhc10Down < 0.20 && cmhc10Premium > 20000, `Premium = ${cmhc10Premium.toFixed(0)}`);
      assert('CMHC: no premium at 20%+', mortDownPct >= 0.20, '20% down = exempt');
      
      // â”€â”€ CAGR Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const cagr = (Math.pow(25000 / 10000, 1 / 5) - 1) * 100;
      assert('CAGR: basic calc', Math.abs(cagr - 20.11) < 0.1, `CAGR = ${cagr.toFixed(2)}%`);
      
      // â”€â”€ Compound Interest Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      let balance = 10000;
      for (let m = 0; m < 12; m++) {
        balance *= (1 + 0.07 / 12);
      }
      assert('Compound: 1yr @7%', Math.abs(balance - 10722.9) < 5, `Balance = ${balance.toFixed(2)}`);
      
      // â”€â”€ DCA Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      let dcaBalance = 0;
      const dcaMonthly = 500;
      const dcaRate = Math.pow(1.08, 1 / 12) - 1;
      for (let m = 0; m < 240; m++) {
        dcaBalance = dcaBalance * (1 + dcaRate) + dcaMonthly;
      }
      const dcaTotalContributed = 500 * 240;
      assert('DCA: 20yr result > contributions', dcaBalance > dcaTotalContributed, `Balance = ${dcaBalance.toFixed(0)} > ${dcaTotalContributed}`);
      
      // â”€â”€ DCA with Inflation Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const dcaInflation = 0.03;
      const dcaNominal = dcaBalance;
      const dcaReal = dcaNominal / Math.pow(1 + dcaInflation, 20);
      assert('DCA inflation: real < nominal', dcaReal < dcaNominal, `Real = ${dcaReal.toFixed(0)} < Nominal = ${dcaNominal.toFixed(0)}`);
      assert('DCA inflation: real still positive', dcaReal > 0, `Real = ${dcaReal.toFixed(0)}`);
      
      // â”€â”€ Startup Runway Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const rwCosts = 50000;
      const rwRevenue = 20000;
      const rwBurnRate = rwCosts - rwRevenue;
      assert('Runway: burn rate = costs - revenue', rwBurnRate === 30000, `Burn = ${rwBurnRate}`);
      const rwCash = 300000;
      const rwMonths = rwCash / rwBurnRate;
      assert('Runway: months = cash / burn', rwMonths === 10, `Months = ${rwMonths}`);
      assert('Runway: zero burn when revenue >= costs', (50000 - 50000) === 0, 'Break-even');
      
      // â”€â”€ Net Worth Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const nwAssets = 500000;
      const nwLiabilities = 200000;
      const nwNetWorth = nwAssets - nwLiabilities;
      assert('Net worth: assets - liabilities', nwNetWorth === 300000, `NW = ${nwNetWorth}`);
      assert('Net worth: negative when liabilities > assets', (100000 - 300000) < 0, 'Negative NW');
      
      // â”€â”€ Tax Bracket Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const fedTaxResult = fedTax(120000);
      assert('Fed tax: positive for 120K', fedTaxResult > 0, `Tax = ${fedTaxResult.toFixed(0)}`);
      assert('Fed tax: reasonable', fedTaxResult > 15000 && fedTaxResult < 35000, `Tax = ${fedTaxResult.toFixed(0)}`);
      
      // â”€â”€ Page Navigation Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const allPages = ['home', 'valuation', 'mortgage', 'investment', 'retirement', 'compound', 'merger', 'runway', 'networth', 'salary', 'debt'];
      allPages.forEach(p => {
        assert(`Nav: page-${p} exists`, !!document.getElementById('page-' + p), '');
      });
      
      // â”€â”€ Theme Tests â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const wasDark = isDark;
      const wasCls = document.documentElement.classList.contains('light');
      toggleTheme();
      assert('Theme: toggles isDark', isDark !== wasDark, `isDark changed to ${isDark}`);
      assert('Theme: light class toggles', document.documentElement.classList.contains('light') !== wasCls, '');
      const themeStored = localStorage.getItem('babaganoush-theme');
      assert('Theme: persists to localStorage', themeStored !== null, `Stored: ${themeStored}`);
      toggleTheme(); // Reset
      const themeReset = localStorage.getItem('babaganoush-theme');
      assert('Theme: localStorage updates on re-toggle', themeReset !== themeStored, `Now: ${themeReset}`);
      
      // Print results
      console.log(`\nğŸ§ª BABAGANOUSH TEST SUITE`);
      console.log(`${'â•'.repeat(50)}`);
      results.forEach(r => {
        console.log(`${r.status === 'PASS' ? 'âœ…' : 'âŒ'} ${r.name} ${r.detail ? `(${r.detail})` : ''}`);
      });
      console.log(`${'â•'.repeat(50)}`);
      console.log(`Results: ${passed} passed, ${failed} failed, ${passed + failed} total`);
      console.log(failed === 0 ? 'ğŸ‰ ALL TESTS PASSED!' : `âš ï¸ ${failed} TEST(S) FAILED`);
      
      return { passed, failed, total: passed + failed, results };
    }
    
    // Run tests on load (dev mode)
    if (location.hostname === 'localhost' || location.hostname === '127.0.0.1' || location.search.includes('test=true')) {
      window.addEventListener('load', () => {
        setTimeout(runTests, 500);
      });
    }
    
    // Expose for manual testing
    window.runTests = runTests;

    // â”€â”€ M&A Deal Analyzer â”€â”€
    function calculateMA() {
      const v = id => parseFloat(document.getElementById(id).value) || 0;
      const fmt = (n, d=1) => n.toLocaleString('en-US', {minimumFractionDigits:d, maximumFractionDigits:d});
      const fmtM = n => '$' + fmt(n, 1) + 'M';
      const fmtD = n => '$' + fmt(n, 2);

      // Inputs
      const acqEPS = v('ma-acq-eps'), acqPrice = v('ma-acq-price'), acqShares = v('ma-acq-shares'), acqPE = v('ma-acq-pe');
      const tgtEPS = v('ma-tgt-eps'), tgtPrice = v('ma-tgt-price'), tgtShares = v('ma-tgt-shares');
      const premium = v('ma-premium') / 100;
      const cashPct = v('ma-cash-pct') / 100, stockPct = 1 - cashPct;
      const debtCost = v('ma-debt-cost') / 100, taxRate = v('ma-tax') / 100;
      const revSyn = v('ma-rev-syn'), costSyn = v('ma-cost-syn');

      // Core calcs
      const offerPrice = tgtPrice * (1 + premium);
      const dealValue = offerPrice * tgtShares; // in $M
      const cashPortion = dealValue * cashPct;
      const stockPortion = dealValue * stockPct;
      const newSharesIssued = acqPrice > 0 ? stockPortion / acqPrice : 0;
      const proFormaShares = acqShares + newSharesIssued;

      // Earnings
      const acqNetIncome = acqEPS * acqShares;
      const tgtNetIncome = tgtEPS * tgtShares;
      const synergies = (revSyn + costSyn) * (1 - taxRate);
      const interestExpense = cashPortion * debtCost * (1 - taxRate);
      const proFormaNetIncome = acqNetIncome + tgtNetIncome + synergies - interestExpense;
      const proFormaEPS = proFormaShares > 0 ? proFormaNetIncome / proFormaShares : 0;
      const accretionDilution = acqEPS !== 0 ? ((proFormaEPS - acqEPS) / acqEPS) * 100 : 0;

      // Goodwill
      const tgtBookValue = tgtShares * tgtPrice; // simplified: book â‰ˆ market pre-premium
      const goodwill = dealValue - tgtBookValue;

      // Combined P/E
      const combinedPE = proFormaEPS > 0 ? acqPrice / proFormaEPS : 0;

      // Break-even synergies: find synergies needed so accretion = 0
      // proFormaEPS = acqEPS when synergies = S_be
      // (acqNI + tgtNI + S_be*(1-t) - interest) / proFormaShares = acqEPS
      const beNumerator = acqEPS * proFormaShares - acqNetIncome - tgtNetIncome + interestExpense;
      const breakEvenSyn = (1 - taxRate) > 0 ? beNumerator / (1 - taxRate) : 0;

      // Transaction fees
      const txnFees = dealValue * 0.02;

      const adColor = accretionDilution >= 0 ? 'var(--brand-success)' : 'var(--brand-danger)';
      const adLabel = accretionDilution >= 0 ? 'Accretive' : 'Dilutive';

      // Results
      document.getElementById('ma-results').innerHTML = `
        <div class="result-card glass-card" style="padding: var(--space-lg);">
          <h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Deal Summary</h3>
          <div style="display: grid; gap: 1rem;">
            <div><span style="color: var(--text-secondary); font-size: 0.85rem;">Offer Price / Share</span><div class="mono" style="font-size: 1.3rem; color: var(--brand-primary);">${fmtD(offerPrice)}</div></div>
            <div><span style="color: var(--text-secondary); font-size: 0.85rem;">Total Deal Value</span><div class="mono" style="font-size: 1.3rem; color: var(--brand-primary);">${fmtM(dealValue)}</div></div>
            <div style="border-top: 1px solid rgba(255,255,255,0.06); padding-top: 1rem;">
              <span style="color: var(--text-secondary); font-size: 0.85rem;">Pro Forma EPS</span>
              <div class="mono" style="font-size: 1.3rem; color: var(--brand-accent);">${fmtD(proFormaEPS)}</div>
              <span style="font-size: 0.75rem; color: var(--text-muted);">vs. standalone ${fmtD(acqEPS)}</span>
            </div>
            <div style="background: rgba(${accretionDilution >= 0 ? '46,204,113' : '231,76,60'},0.1); border-radius: 0.75rem; padding: 1rem; text-align: center;">
              <span style="color: var(--text-secondary); font-size: 0.85rem;">${adLabel}</span>
              <div class="mono" style="font-size: 1.8rem; font-weight: 700; color: ${adColor};">${accretionDilution >= 0 ? '+' : ''}${fmt(accretionDilution,2)}%</div>
            </div>
            <div><span style="color: var(--text-secondary); font-size: 0.85rem;">Goodwill Created</span><div class="mono" style="font-size: 1.1rem;">${fmtM(goodwill)}</div></div>
            <div><span style="color: var(--text-secondary); font-size: 0.85rem;">Combined P/E</span><div class="mono" style="font-size: 1.1rem;">${fmt(combinedPE,1)}x</div></div>
            <div><span style="color: var(--text-secondary); font-size: 0.85rem;">Break-even Synergies Needed</span><div class="mono" style="font-size: 1.1rem; color: ${breakEvenSyn > 0 ? 'var(--brand-warning)' : 'var(--brand-success)'};">${fmtM(breakEvenSyn)}</div></div>
          </div>
        </div>
      `;

      // Sensitivity table
      const premiums = [10, 20, 30, 40];
      const cashMixes = [0, 25, 50, 75, 100];
      let tbl = '<h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Sensitivity: Accretion / Dilution %</h3>';
      tbl += '<table class="sensitivity-table"><thead><tr><th>Premium \\ Cash%</th>';
      cashMixes.forEach(c => tbl += `<th>${c}%</th>`);
      tbl += '</tr></thead><tbody>';
      premiums.forEach(p => {
        tbl += `<tr><td style="font-weight:600;">${p}%</td>`;
        cashMixes.forEach(c => {
          const op = tgtPrice * (1 + p/100);
          const dv = op * tgtShares;
          const cp = dv * c/100, sp = dv * (1 - c/100);
          const ns = acqPrice > 0 ? sp / acqPrice : 0;
          const pfs = acqShares + ns;
          const ie = cp * debtCost * (1 - taxRate);
          const pfni = acqNetIncome + tgtNetIncome + synergies - ie;
          const pfeps = pfs > 0 ? pfni / pfs : 0;
          const ad = acqEPS !== 0 ? ((pfeps - acqEPS) / acqEPS) * 100 : 0;
          const cls = ad >= 0 ? 'positive-val' : 'negative-val';
          const hl = (p === v('ma-premium') && c === v('ma-cash-pct')) ? ' highlight' : '';
          tbl += `<td class="${cls}${hl}">${ad >= 0 ? '+' : ''}${ad.toFixed(1)}%</td>`;
        });
        tbl += '</tr>';
      });
      tbl += '</tbody></table>';
      document.getElementById('ma-sensitivity').innerHTML = tbl;

      // Sources & Uses
      const cashOnHand = 0; // simplified
      const newDebt = cashPortion;
      const stockIssued = stockPortion;
      let su = '<h3 style="font-size: 0.85rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 1rem;">Sources & Uses ($M)</h3>';
      su += '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">';
      su += '<div><table class="sensitivity-table"><thead><tr><th colspan="2">Sources</th></tr></thead><tbody>';
      su += `<tr><td>New Debt</td><td class="mono">${fmtM(newDebt)}</td></tr>`;
      su += `<tr><td>Stock Issued</td><td class="mono">${fmtM(stockIssued)}</td></tr>`;
      su += `<tr><td>Cash on Hand</td><td class="mono">${fmtM(cashOnHand)}</td></tr>`;
      su += `<tr style="border-top:2px solid rgba(255,255,255,0.1);"><td style="font-weight:700;">Total Sources</td><td class="mono" style="font-weight:700;">${fmtM(newDebt + stockIssued + cashOnHand)}</td></tr>`;
      su += '</tbody></table></div>';
      su += '<div><table class="sensitivity-table"><thead><tr><th colspan="2">Uses</th></tr></thead><tbody>';
      su += `<tr><td>Purchase Price</td><td class="mono">${fmtM(dealValue)}</td></tr>`;
      su += `<tr><td>Transaction Fees (2%)</td><td class="mono">${fmtM(txnFees)}</td></tr>`;
      su += `<tr><td>Refinancing</td><td class="mono">${fmtM(0)}</td></tr>`;
      su += `<tr style="border-top:2px solid rgba(255,255,255,0.1);"><td style="font-weight:700;">Total Uses</td><td class="mono" style="font-weight:700;">${fmtM(dealValue + txnFees)}</td></tr>`;
      su += '</tbody></table></div></div>';
      document.getElementById('ma-sources-uses').innerHTML = su;
    }

    // Initialize M&A on page load
    document.addEventListener('DOMContentLoaded', function() { if(document.getElementById('ma-acq-eps')) calculateMA(); });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  STARTUP RUNWAY CALCULATOR
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let runwayScenario = 'base';

    function switchRunwayTab(tab) {
      runwayScenario = tab;
      document.querySelectorAll('#runway-tabs .tab').forEach(t => t.classList.remove('active'));
      document.getElementById('runway-tab-' + tab).classList.add('active');
      calculateRunway();
    }

    function calculateRunway() {
      const cash = parseFloat(document.getElementById('rw-cash').value) || 0;
      const revenue = parseFloat(document.getElementById('rw-revenue').value) || 0;
      let growthPct = parseFloat(document.getElementById('rw-growth').value) || 0;
      const fixed = parseFloat(document.getElementById('rw-fixed').value) || 0;
      const variable = parseFloat(document.getElementById('rw-variable').value) || 0;
      const onetime = parseFloat(document.getElementById('rw-onetime').value) || 0;
      const hiring = parseFloat(document.getElementById('rw-hiring').value) || 0;

      let scenarioLabel = 'Base Case Scenario';
      let effectiveGrowth = growthPct;
      if (runwayScenario === 'conservative') { effectiveGrowth = 0; scenarioLabel = 'Conservative Scenario (No Growth)'; }
      if (runwayScenario === 'aggressive') { effectiveGrowth = growthPct * 2; scenarioLabel = 'Aggressive Scenario (' + (growthPct * 2) + '% Growth)'; }

      document.getElementById('rw-scenario-label').textContent = scenarioLabel;

      const totalCosts = fixed + variable;
      const burnRate = totalCosts - revenue;
      document.getElementById('rw-burn').textContent = fmtFull(burnRate);

      const maxMonths = 60;
      let balances = [];
      let flatRunway = 0;
      let growthRunway = 0;
      let breakEvenMonth = null;
      let hitZeroGrowth = false;

      // Flat runway (no growth)
      let flatBal = cash - onetime;
      for (let m = 1; m <= maxMonths; m++) {
        let flatCosts = totalCosts + (hiring * m);
        flatBal -= (flatCosts - revenue);
        if (flatBal <= 0) { flatRunway = m; break; }
        if (m === maxMonths) flatRunway = maxMonths;
      }

      // Growth runway
      let bal = cash - onetime;
      let rev = revenue;
      for (let m = 1; m <= maxMonths; m++) {
        rev = rev * (1 + effectiveGrowth / 100);
        let costs = totalCosts + (hiring * m);
        bal -= (costs - rev);
        balances.push({ month: m, balance: bal, revenue: rev, costs: costs });
        if (!breakEvenMonth && rev >= costs) breakEvenMonth = m;
        if (!hitZeroGrowth && bal <= 0) { growthRunway = m; hitZeroGrowth = true; }
      }
      if (!hitZeroGrowth) growthRunway = maxMonths;

      document.getElementById('rw-runway-flat').textContent = flatRunway >= maxMonths ? '60+ months' : flatRunway + ' months';
      document.getElementById('rw-runway-growth').textContent = growthRunway >= maxMonths ? '60+ months' : growthRunway + ' months';

      const now = new Date();
      if (growthRunway < maxMonths) {
        const zeroDate = new Date(now.getFullYear(), now.getMonth() + growthRunway, 1);
        document.getElementById('rw-zero-date').textContent = zeroDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
      } else {
        document.getElementById('rw-zero-date').textContent = 'N/A (sustainable)';
      }

      const rw = growthRunway;
      const safeEl = document.getElementById('rw-safe-zone');
      const safeText = document.getElementById('rw-safe-text');
      if (rw > 12 || rw >= maxMonths) {
        safeText.textContent = '\u{1F7E2} Safe Zone';
        safeEl.style.borderColor = 'rgba(16, 185, 129, 0.4)';
        safeEl.style.background = 'linear-gradient(135deg, rgba(16, 185, 129, 0.08), rgba(16, 185, 129, 0.03))';
      } else if (rw >= 6) {
        safeText.textContent = '\u{1F7E1} Caution';
        safeEl.style.borderColor = 'rgba(245, 158, 11, 0.4)';
        safeEl.style.background = 'linear-gradient(135deg, rgba(245, 158, 11, 0.08), rgba(245, 158, 11, 0.03))';
      } else {
        safeText.textContent = '\u{1F534} Danger';
        safeEl.style.borderColor = 'rgba(239, 68, 68, 0.4)';
        safeEl.style.background = 'linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(239, 68, 68, 0.03))';
      }

      document.getElementById('rw-breakeven').textContent = breakEvenMonth ? 'Month ' + breakEvenMonth : 'Not within 60 months';

      // Chart
      const chart = document.getElementById('rw-chart');
      const maxBal = Math.max(...balances.map(b => Math.abs(b.balance)), 1);
      const months = Math.min(balances.length, 36);
      let html = '';
      for (let i = 0; i < months; i++) {
        const b = balances[i];
        const pct = Math.min(Math.abs(b.balance) / maxBal * 100, 100);
        const isNeg = b.balance < 0;
        const isBE = breakEvenMonth && i + 1 === breakEvenMonth;
        let color = isNeg ? 'var(--brand-danger)' : (isBE ? 'var(--brand-success)' : 'linear-gradient(to top, var(--brand-primary), var(--brand-accent))');
        const title = 'Month ' + (i + 1) + ': ' + fmtFull(b.balance);
        html += '<div style="flex:1;display:flex;flex-direction:column;align-items:center;justify-content:flex-end;height:100%;position:relative;" title="' + title + '">';
        html += '<div style="width:100%;height:' + Math.max(pct, 2) + '%;background:' + color + ';border-radius:3px 3px 0 0;min-height:2px;transition:height 0.5s ease;"></div>';
        if (i % 6 === 0 || i === months - 1) html += '<span style="font-size:0.55rem;color:var(--text-muted);position:absolute;bottom:-18px;">M' + (i + 1) + '</span>';
        html += '</div>';
      }
      chart.innerHTML = html;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  NET WORTH TRACKER
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function nwVal(id) { return parseFloat(document.getElementById(id).value) || 0; }

    function calculateNetWorth() {
      const assets = {
        'Cash & Savings': nwVal('nw-cash'),
        'TFSA': nwVal('nw-tfsa'),
        'RRSP': nwVal('nw-rrsp'),
        'Non-Registered': nwVal('nw-nonreg'),
        'Real Estate': nwVal('nw-realestate'),
        'Vehicles': nwVal('nw-vehicles'),
        'Other Assets': nwVal('nw-other-assets'),
      };
      const liabilities = {
        'Mortgage': nwVal('nw-mortgage'),
        'Car Loans': nwVal('nw-carloans'),
        'Student Loans': nwVal('nw-student'),
        'Credit Cards': nwVal('nw-cc'),
        'Line of Credit': nwVal('nw-loc'),
        'Other Debt': nwVal('nw-other-debt'),
      };

      const totalAssets = Object.values(assets).reduce((a, b) => a + b, 0);
      const totalLiabilities = Object.values(liabilities).reduce((a, b) => a + b, 0);
      const netWorth = totalAssets - totalLiabilities;
      const liquidNW = totalAssets - assets['Real Estate'] - assets['Vehicles'] - totalLiabilities;

      document.getElementById('nw-total-assets').textContent = fmtFull(totalAssets);
      document.getElementById('nw-total-liabilities').textContent = fmtFull(totalLiabilities);
      document.getElementById('nw-networth').textContent = fmtFull(netWorth);
      document.getElementById('nw-liquid').textContent = fmtFull(liquidNW);

      // Debt-to-asset ratio
      const dtaEl = document.getElementById('nw-dta');
      if (totalAssets > 0) {
        const dta = (totalLiabilities / totalAssets * 100);
        let pillClass = dta > 80 ? 'negative' : dta > 50 ? 'neutral' : 'positive';
        let icon = dta > 80 ? '\u{1F534}' : dta > 50 ? '\u{1F7E1}' : '\u{1F7E2}';
        dtaEl.innerHTML = '<span class="metric-pill ' + pillClass + '">' + icon + ' Debt-to-Asset: ' + dta.toFixed(1) + '%</span>';
      } else {
        dtaEl.innerHTML = '';
      }

      // Pie chart (conic-gradient)
      const colors = ['#6366f1', '#8b5cf6', '#06b6d4', '#10b981', '#f59e0b', '#ef4444', '#ec4899'];
      const assetEntries = Object.entries(assets).filter(function(e) { return e[1] > 0; });
      if (totalAssets > 0 && assetEntries.length > 0) {
        let gradParts = [];
        let cumPct = 0;
        let legendHtml = '';
        assetEntries.forEach(function(entry, i) {
          const name = entry[0], val = entry[1];
          const pct = val / totalAssets * 100;
          const c = colors[i % colors.length];
          gradParts.push(c + ' ' + cumPct.toFixed(1) + '% ' + (cumPct + pct).toFixed(1) + '%');
          legendHtml += '<div style="display:flex;align-items:center;gap:6px;"><span style="width:10px;height:10px;border-radius:2px;background:' + c + ';flex-shrink:0;"></span>' + name + ' <span class="mono" style="color:var(--text-muted);">' + pct.toFixed(0) + '%</span></div>';
          cumPct += pct;
        });
        document.getElementById('nw-pie').style.background = 'conic-gradient(' + gradParts.join(', ') + ')';
        document.getElementById('nw-pie-legend').innerHTML = legendHtml;
      } else {
        document.getElementById('nw-pie').style.background = 'var(--border-primary)';
        document.getElementById('nw-pie-legend').innerHTML = '<span style="color:var(--text-muted);">Enter assets to see allocation</span>';
      }
    }

    function saveNetWorthSnapshot() {
      const snap = {
        date: new Date().toISOString(),
        assets: nwVal('nw-cash') + nwVal('nw-tfsa') + nwVal('nw-rrsp') + nwVal('nw-nonreg') + nwVal('nw-realestate') + nwVal('nw-vehicles') + nwVal('nw-other-assets'),
        liabilities: nwVal('nw-mortgage') + nwVal('nw-carloans') + nwVal('nw-student') + nwVal('nw-cc') + nwVal('nw-loc') + nwVal('nw-other-debt'),
      };
      snap.netWorth = snap.assets - snap.liabilities;
      const snaps = JSON.parse(localStorage.getItem('nw-snapshots') || '[]');
      snaps.push(snap);
      localStorage.setItem('nw-snapshots', JSON.stringify(snaps));
      loadNetWorthSnapshots();
    }

    function loadNetWorthSnapshots() {
      const snaps = JSON.parse(localStorage.getItem('nw-snapshots') || '[]');
      const el = document.getElementById('nw-snapshots');
      if (snaps.length === 0) {
        el.innerHTML = '<p style="color:var(--text-muted);font-size:0.8rem;">No snapshots yet. Save one to start tracking.</p>';
        return;
      }
      let html = '<div style="display:flex;flex-direction:column;gap:0.5rem;">';
      snaps.slice().reverse().forEach(function(s) {
        const d = new Date(s.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit' });
        const nwColor = s.netWorth >= 0 ? 'var(--brand-success)' : 'var(--brand-danger)';
        html += '<div style="display:flex;justify-content:space-between;align-items:center;padding:0.5rem 0.75rem;background:var(--bg-secondary);border-radius:var(--radius-sm);border:1px solid var(--border-primary);">';
        html += '<span style="color:var(--text-secondary);">' + d + '</span>';
        html += '<span class="mono" style="font-weight:600;color:' + nwColor + ';">' + fmtFull(s.netWorth) + '</span>';
        html += '</div>';
      });
      html += '</div>';
      html += '<button class="btn btn-ghost btn-sm" style="margin-top:0.75rem;color:var(--brand-danger);font-size:0.72rem;" onclick="if(confirm(\'Clear all snapshots?\')){localStorage.removeItem(\'nw-snapshots\');loadNetWorthSnapshots();}">Clear All Snapshots</button>';
      el.innerHTML = html;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  NEWSLETTER SIGNUP
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function subscribeNewsletter() {
      const input = document.getElementById('newsletter-email');
      const email = input.value.trim();
      if (!email || !email.includes('@') || !email.includes('.')) {
        input.style.borderColor = 'var(--brand-danger)';
        setTimeout(function() { input.style.borderColor = ''; }, 2000);
        return;
      }
      const subs = JSON.parse(localStorage.getItem('bb-newsletter') || '[]');
      if (!subs.includes(email)) { subs.push(email); localStorage.setItem('bb-newsletter', JSON.stringify(subs)); }
      input.value = '';
      // Show toast
      const toast = document.createElement('div');
      toast.className = 'toast-success';
      toast.innerHTML = 'âœ… You\'re subscribed! Welcome aboard.';
      document.body.appendChild(toast);
      setTimeout(function() { toast.remove(); }, 3500);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  COOKIE CONSENT
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    (function() {
      if (localStorage.getItem('bb-cookie-consent')) return;
      var banner = document.createElement('div');
      banner.className = 'cookie-banner';
      banner.innerHTML = '<span>ğŸª We use cookies to improve your experience.</span><div class="cookie-banner-btns"><button class="btn btn-primary btn-sm" onclick="acceptCookies(true)">Accept</button><button class="btn btn-secondary btn-sm" onclick="acceptCookies(false)">Decline</button></div>';
      document.body.appendChild(banner);
    })();
    function acceptCookies(accepted) {
      localStorage.setItem('bb-cookie-consent', accepted ? 'accepted' : 'declined');
      var b = document.querySelector('.cookie-banner');
      if (b) b.remove();
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  MICRO-INTERACTIONS v1.6
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // 1. Smooth Number Animations
    function animateValue(element, start, end, duration) {
      if (!element || duration <= 0) { element.textContent = end; return; }
      const startTime = performance.now();
      const isFormatted = typeof end === 'string';
      const endNum = isFormatted ? parseFloat(end.replace(/[^0-9.\-]/g, '')) : end;
      const startNum = isFormatted ? parseFloat(start.toString().replace(/[^0-9.\-]/g, '')) || 0 : (start || 0);
      if (isNaN(endNum)) { element.textContent = end; return; }
      const prefix = isFormatted ? (end.match(/^[^0-9.\-]*/)||[''])[0] : '';
      const suffix = isFormatted ? (end.match(/[^0-9.\-]*$/)||[''])[0] : '';
      const hasDecimal = isFormatted && end.includes('.');
      const decimals = hasDecimal ? (end.split('.')[1] || '').replace(/[^0-9]/g, '').length : 0;

      function tick(now) {
        const elapsed = now - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const eased = 1 - Math.pow(1 - progress, 3); // ease-out cubic
        const current = startNum + (endNum - startNum) * eased;
        if (isFormatted) {
          element.textContent = prefix + current.toLocaleString('en-US', {minimumFractionDigits: decimals, maximumFractionDigits: decimals}) + suffix;
        } else {
          element.textContent = Math.round(current);
        }
        if (progress < 1) requestAnimationFrame(tick);
        else element.textContent = end; // ensure exact final value
      }
      requestAnimationFrame(tick);
    }

    // Observe .result-value changes and animate them
    (function() {
      const resultObserver = new MutationObserver(function(mutations) {
        mutations.forEach(function(m) {
          if (m.type === 'childList' || m.type === 'characterData') {
            const el = m.target.nodeType === 1 ? m.target : m.target.parentElement;
            if (!el || !el.classList || !el.classList.contains('result-value')) return;
            const newVal = el.textContent;
            const oldVal = el.getAttribute('data-prev') || '0';
            if (newVal !== oldVal && !el._animating) {
              el._animating = true;
              el.setAttribute('data-prev', newVal);
              animateValue(el, oldVal, newVal, 600);
              setTimeout(function() { el._animating = false; }, 650);
            }
          }
        });
      });
      // Observe the whole body for result-value text changes
      document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.result-value').forEach(function(el) {
          el.setAttribute('data-prev', el.textContent);
        });
      });
      // Use a simpler approach: patch innerHTML setters on result containers
      const origShowPage = window.showPage;
      // We'll hook into calculator functions instead via a post-render observer
      setInterval(function() {
        document.querySelectorAll('.result-value').forEach(function(el) {
          if (!el.hasAttribute('data-prev')) el.setAttribute('data-prev', el.textContent);
        });
      }, 200);
    })();

    // 2. Input Ripple Effect
    document.addEventListener('click', function(e) {
      const input = e.target.closest('.input-group input, .input-group select');
      if (!input) return;
      const group = input.closest('.input-group');
      if (!group) return;
      const ripple = document.createElement('div');
      ripple.className = 'input-ripple';
      const rect = input.getBoundingClientRect();
      const grect = group.getBoundingClientRect();
      const size = 30;
      ripple.style.width = size + 'px';
      ripple.style.height = size + 'px';
      ripple.style.left = (e.clientX - grect.left - size/2) + 'px';
      ripple.style.top = (e.clientY - grect.top - size/2) + 'px';
      group.appendChild(ripple);
      setTimeout(function() { ripple.remove(); }, 600);
    });

    // 3. Page Transition (fade-out / fade-in)
    (function() {
      const origShowPage = window.showPage;
      window.showPage = function(pageId) {
        const currentPage = document.querySelector('.page.active');
        const targetPage = document.getElementById('page-' + pageId);
        if (!targetPage || currentPage === targetPage) {
          origShowPage(pageId);
          return;
        }
        if (currentPage) {
          currentPage.classList.add('fade-out');
          setTimeout(function() {
            currentPage.classList.remove('active', 'fade-out');
            targetPage.classList.add('active', 'fade-in');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            setTimeout(function() { targetPage.classList.remove('fade-in'); }, 250);
            // Close mobile menu & init calculators
            document.getElementById('nav-links').classList.remove('mobile-open');
            if (pageId === 'valuation') calculateDCF();
            if (pageId === 'mortgage') calculateMortgage();
            if (pageId === 'investment') calculateCAGR();
            if (pageId === 'retirement') calculateRetirement();
            if (pageId === 'compound') calculateCompound();
            if (pageId === 'runway') calculateRunway();
            if (pageId === 'networth') { calculateNetWorth(); loadNetWorthSnapshots(); }
          }, 150);
        } else {
          origShowPage(pageId);
        }
      };
    })();

    // 4. Parallax Hero Blobs
    (function() {
      let ticking = false;
      const blobs = document.querySelectorAll('.hero-blob');
      window.addEventListener('scroll', function() {
        if (!ticking) {
          requestAnimationFrame(function() {
            const scrollY = window.scrollY;
            blobs.forEach(function(blob, i) {
              const speed = (i + 1) * 0.05;
              blob.style.transform = 'translateY(' + (scrollY * speed * -1) + 'px)';
            });
            ticking = false;
          });
          ticking = true;
        }
      });
    })();

    // 5. Chart Bar Tooltips â€” handled via CSS class .chart-bar-tooltip + data-tooltip attr
    // The chart rendering functions already use title attrs; we enhance them with CSS tooltips
    // by adding a MutationObserver that converts title attrs on chart bars to our tooltip class
    (function() {
      function enhanceChartBars() {
        document.querySelectorAll('[title]').forEach(function(el) {
          if (el.closest('.chart-container, #rw-chart, #dca-chart, #compound-chart, #dcf-chart')) {
            if (!el.classList.contains('chart-bar-tooltip')) {
              el.classList.add('chart-bar-tooltip');
              el.setAttribute('data-tooltip', el.getAttribute('title'));
              el.removeAttribute('title');
            }
          }
        });
      }
      setInterval(enhanceChartBars, 500);
    })();

    // 6. Loading Skeleton
    (function() {
      const origShowPage2 = window.showPage;
      window.showPage = (function(prev) {
        return function(pageId) {
          prev(pageId);
          if (pageId === 'home') return;
          const page = document.getElementById('page-' + pageId);
          if (!page) return;
          const results = page.querySelectorAll('.calc-results');
          results.forEach(function(r) {
            if (r._skeletonShown) return;
            r._skeletonShown = true;
            r.style.position = 'relative';
            const skel = document.createElement('div');
            skel.className = 'skeleton-overlay';
            skel.innerHTML = '<div class="skeleton-line tall"></div><div class="skeleton-line medium"></div><div class="skeleton-line"></div><div class="skeleton-line short"></div>';
            r.appendChild(skel);
            setTimeout(function() {
              skel.style.transition = 'opacity 0.2s ease';
              skel.style.opacity = '0';
              setTimeout(function() { skel.remove(); r._skeletonShown = false; }, 200);
            }, 300);
          });
        };
      })(window.showPage);
    })();

    // 7. Scroll Progress Bar
    (function() {
      const bar = document.getElementById('scroll-progress');
      let ticking = false;
      window.addEventListener('scroll', function() {
        if (!ticking) {
          requestAnimationFrame(function() {
            const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const pct = scrollHeight > 0 ? (scrollTop / scrollHeight * 100) : 0;
            bar.style.width = pct + '%';
            ticking = false;
          });
          ticking = true;
        }
      });
    })();

    // 8. Easter Egg â€” type "babaganoush" anywhere
    (function() {
      let buffer = '';
      const secret = 'babaganoush';
      document.addEventListener('keypress', function(e) {
        buffer += e.key.toLowerCase();
        if (buffer.length > secret.length) buffer = buffer.slice(-secret.length);
        if (buffer === secret) {
          buffer = '';
          triggerConfetti();
        }
      });

      function triggerConfetti() {
        const container = document.createElement('div');
        container.className = 'confetti-container';
        document.body.appendChild(container);
        const colors = ['#6366f1', '#8b5cf6', '#06b6d4', '#10b981', '#f59e0b', '#ef4444', '#ec4899', '#f97316'];
        for (let i = 0; i < 80; i++) {
          const piece = document.createElement('div');
          piece.className = 'confetti-piece';
          piece.style.left = Math.random() * 100 + 'vw';
          piece.style.background = colors[Math.floor(Math.random() * colors.length)];
          piece.style.animationDelay = (Math.random() * 1.5) + 's';
          piece.style.animationDuration = (2 + Math.random() * 2) + 's';
          piece.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
          piece.style.width = (5 + Math.random() * 8) + 'px';
          piece.style.height = (5 + Math.random() * 8) + 'px';
          container.appendChild(piece);
        }
        setTimeout(function() { container.remove(); }, 5000);
      }
    })();


    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  SALARY & COMPENSATION ANALYZER
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function calculateSalary() {
      const base = parseFloat(document.getElementById('sal-base').value) || 0;
      const bonusPct = parseFloat(document.getElementById('sal-bonus-pct').value) || 0;
      const shares = parseFloat(document.getElementById('sal-shares').value) || 0;
      const strike = parseFloat(document.getElementById('sal-strike').value) || 0;
      const currentPrice = parseFloat(document.getElementById('sal-current-price').value) || 0;
      const vesting = parseFloat(document.getElementById('sal-vesting').value) || 4;
      const health = parseFloat(document.getElementById('sal-health').value) || 0;
      const pension = parseFloat(document.getElementById('sal-pension').value) || 0;
      const province = document.getElementById('sal-province').value;

      const bonus = base * (bonusPct / 100);
      const intrinsicPerShare = Math.max(0, currentPrice - strike);
      const totalEquity = shares * intrinsicPerShare;
      const annualEquity = totalEquity / vesting;
      const benefits = health + pension;
      const totalComp = base + bonus + annualEquity + benefits;

      // Simplified Canadian marginal tax rates (combined federal + provincial, 2024 approx)
      const taxRates = {
        ON: [[ 55867, 0.2005], [111733, 0.2965], [154906, 0.3148], [220000, 0.3389], [Infinity, 0.5353]],
        BC: [[ 45654, 0.2006], [ 91310, 0.2272], [104835, 0.2950], [127299, 0.3148], [172602, 0.3267], [240716, 0.4070], [Infinity, 0.5350]],
        AB: [[ 55867, 0.2500], [111733, 0.3050], [154906, 0.3600], [208000, 0.4200], [Infinity, 0.4800]],
        QC: [[ 49275, 0.2753], [ 55867, 0.3253], [ 98540, 0.3802], [111733, 0.4397], [154906, 0.4797], [Infinity, 0.5331]],
        MB: [[ 36842, 0.2580], [ 55867, 0.2775], [ 79625, 0.3340], [111733, 0.3783], [154906, 0.4340], [Infinity, 0.5040]],
        SK: [[ 49720, 0.2550], [ 55867, 0.2775], [111733, 0.3577], [142058, 0.3577], [Infinity, 0.4477]],
        NS: [[ 29590, 0.2379], [ 55867, 0.2995], [ 59180, 0.3495], [ 93000, 0.3695], [111733, 0.4295], [150000, 0.4595], [Infinity, 0.5400]],
        NB: [[ 47715, 0.2440], [ 55867, 0.2682], [ 95524, 0.3182], [111733, 0.3552], [154906, 0.3952], [176756, 0.4352], [Infinity, 0.5302]],
        NL: [[ 41457, 0.2350], [ 55867, 0.2850], [ 82913, 0.3150], [111733, 0.3350], [148027, 0.3850], [154906, 0.4350], [207239, 0.4580], [Infinity, 0.5180]],
        PE: [[ 31984, 0.2480], [ 55867, 0.2880], [ 63969, 0.3330], [111733, 0.3530], [140000, 0.3730], [154906, 0.4430], [Infinity, 0.5130]]
      };

      const brackets = taxRates[province] || taxRates['ON'];
      const taxableIncome = base + bonus; // equity/benefits not directly taxed this way
      let tax = 0, prev = 0;
      for (const [limit, rate] of brackets) {
        if (taxableIncome <= prev) break;
        const taxable = Math.min(taxableIncome, limit) - prev;
        tax += taxable * rate;
        prev = limit;
      }
      const takeHome = taxableIncome - tax + annualEquity + benefits; // simplified
      const effTaxRate = taxableIncome > 0 ? (tax / taxableIncome) * 100 : 0;
      const hourly = totalComp / 2080;

      document.getElementById('sal-total-comp').textContent = fmtFull(totalComp);
      document.getElementById('sal-take-home').textContent = fmtFull(takeHome);
      document.getElementById('sal-eff-tax').textContent = fmtPct(effTaxRate);
      document.getElementById('sal-hourly').textContent = fmtFull(hourly);
      document.getElementById('sal-equity-val').textContent = fmtFull(annualEquity);
      document.getElementById('sal-bonus-val').textContent = fmtFull(bonus);

      // Pie chart
      const parts = [
        { label: 'Base Salary', value: base, color: '#14b8a6' },
        { label: 'Bonus', value: bonus, color: '#f59e0b' },
        { label: 'Equity', value: annualEquity, color: '#8b5cf6' },
        { label: 'Benefits', value: benefits, color: '#3b82f6' }
      ].filter(p => p.value > 0);

      const total = parts.reduce((s, p) => s + p.value, 0);
      let gradParts = [], cumPct = 0;
      parts.forEach(p => {
        const pct = (p.value / total) * 100;
        gradParts.push(`${p.color} ${cumPct}% ${cumPct + pct}%`);
        cumPct += pct;
      });
      document.getElementById('sal-pie').style.background = total > 0
        ? `conic-gradient(${gradParts.join(', ')})`
        : 'var(--border-primary)';
      document.getElementById('sal-pie-legend').innerHTML = parts.map(p =>
        `<div style="display:flex;align-items:center;gap:0.5rem;"><span style="width:10px;height:10px;border-radius:50%;background:${p.color};display:inline-block;"></span>${p.label}: ${fmtFull(p.value)} (${((p.value/total)*100).toFixed(0)}%)</div>`
      ).join('');

      // Comparison
      const canadianMedian = 55000;
      const techMedian = 95000;
      const compEl = document.getElementById('sal-comparison');
      const bar = (label, val, max) => {
        const pct = Math.min(100, (val / max) * 100);
        return `<div style="margin-bottom:0.75rem;">
          <div style="display:flex;justify-content:space-between;margin-bottom:0.25rem;"><span>${label}</span><span>${fmtFull(val)}</span></div>
          <div style="height:8px;background:var(--border-primary);border-radius:4px;overflow:hidden;">
            <div style="height:100%;width:${pct}%;background:linear-gradient(90deg,#14b8a6,#0d9488);border-radius:4px;transition:width 0.5s;"></div>
          </div>
        </div>`;
      };
      const maxVal = Math.max(totalComp, canadianMedian, techMedian) * 1.1;
      compEl.innerHTML = bar('Your Total Comp', totalComp, maxVal)
        + bar('Canadian Median', canadianMedian, maxVal)
        + bar('Tech Median', techMedian, maxVal)
        + `<div style="margin-top:0.5rem;font-size:0.8rem;color:var(--text-secondary);">You earn <strong>${totalComp > canadianMedian ? ((totalComp/canadianMedian - 1)*100).toFixed(0) + '% more' : ((1 - totalComp/canadianMedian)*100).toFixed(0) + '% less'}</strong> than the Canadian median</div>`;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  DEBT PAYOFF CALCULATOR
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let debtStrategy = 'avalanche';

    function setDebtStrategy(s) {
      debtStrategy = s;
      document.getElementById('debt-btn-avalanche').className = s === 'avalanche' ? 'btn btn-primary btn-sm' : 'btn btn-secondary btn-sm';
      document.getElementById('debt-btn-snowball').className = s === 'snowball' ? 'btn btn-primary btn-sm' : 'btn btn-secondary btn-sm';
      document.getElementById('debt-strategy-help').textContent = s === 'avalanche'
        ? 'Highest interest rate first â€” saves the most money'
        : 'Lowest balance first â€” quick wins for motivation';
      calculateDebt();
    }

    function addDebtRow() {
      const container = document.getElementById('debt-rows');
      const row = document.createElement('div');
      row.className = 'debt-row';
      row.style.cssText = 'display:grid;grid-template-columns:2fr 1.5fr 1fr 1.5fr auto;gap:0.5rem;align-items:end;margin-bottom:0.5rem;';
      row.innerHTML = `
        <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Name</label><input type="text" value="New Debt" oninput="calculateDebt()" /></div>
        <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Balance ($)</label><input type="number" value="5000" oninput="calculateDebt()" /></div>
        <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Rate (%)</label><input type="number" value="12" step="0.01" oninput="calculateDebt()" /></div>
        <div class="input-group" style="margin:0"><label style="font-size:0.7rem">Min Payment ($)</label><input type="number" value="150" oninput="calculateDebt()" /></div>
        <button class="btn btn-secondary btn-sm" onclick="removeDebtRow(this)" style="padding:0.25rem 0.5rem;margin-bottom:2px;">âœ•</button>`;
      container.appendChild(row);
      calculateDebt();
    }

    function removeDebtRow(btn) {
      const rows = document.querySelectorAll('#debt-rows .debt-row');
      if (rows.length <= 1) return;
      btn.closest('.debt-row').remove();
      calculateDebt();
    }

    function getDebts() {
      const rows = document.querySelectorAll('#debt-rows .debt-row');
      return Array.from(rows).map(row => {
        const inputs = row.querySelectorAll('input');
        return {
          name: inputs[0].value || 'Debt',
          balance: parseFloat(inputs[1].value) || 0,
          rate: parseFloat(inputs[2].value) || 0,
          minPayment: parseFloat(inputs[3].value) || 0
        };
      }).filter(d => d.balance > 0);
    }

    function simulatePayoff(debts, extraMonthly, strategy) {
      let balances = debts.map(d => ({ ...d }));
      let totalInterest = 0;
      let months = 0;
      const maxMonths = 600; // 50 year cap
      const timeline = [{ month: 0, total: balances.reduce((s, d) => s + d.balance, 0) }];

      while (balances.some(d => d.balance > 0.01) && months < maxMonths) {
        months++;
        let extraLeft = extraMonthly;

        // Apply interest
        balances.forEach(d => {
          if (d.balance > 0) {
            const interest = d.balance * (d.rate / 100 / 12);
            d.balance += interest;
            totalInterest += interest;
          }
        });

        // Make minimum payments
        balances.forEach(d => {
          if (d.balance > 0) {
            const payment = Math.min(d.balance, d.minPayment);
            d.balance -= payment;
          }
        });

        // Sort for strategy and apply extra payment
        const sorted = balances.filter(d => d.balance > 0.01);
        if (strategy === 'avalanche') sorted.sort((a, b) => b.rate - a.rate);
        else sorted.sort((a, b) => a.balance - b.balance);

        for (const d of sorted) {
          if (extraLeft <= 0) break;
          const payment = Math.min(d.balance, extraLeft);
          d.balance -= payment;
          extraLeft -= payment;
        }

        timeline.push({ month: months, total: balances.reduce((s, d) => s + Math.max(0, d.balance), 0) });
      }

      return { totalInterest, months, timeline };
    }

    function calculateDebt() {
      const debts = getDebts();
      if (debts.length === 0) return;

      const extra = parseFloat(document.getElementById('debt-extra').value) || 0;
      const result = simulatePayoff(debts, extra, debtStrategy);
      const minOnly = simulatePayoff(debts, 0, debtStrategy);

      document.getElementById('debt-total-interest').textContent = fmtFull(result.totalInterest);
      document.getElementById('debt-months').textContent = result.months;

      const now = new Date();
      const freeDate = new Date(now.getFullYear(), now.getMonth() + result.months, 1);
      document.getElementById('debt-free-date').textContent = freeDate.toLocaleDateString('en-US', { year: 'numeric', month: 'short' });

      const savings = minOnly.totalInterest - result.totalInterest;
      document.getElementById('debt-savings').textContent = fmtFull(Math.max(0, savings));

      const yrs = Math.floor(result.months / 12);
      const mos = result.months % 12;
      document.getElementById('debt-countdown').textContent = yrs > 0 ? `${yrs}y ${mos}m` : `${mos} months`;

      // Timeline chart (simple bar chart)
      const chart = document.getElementById('debt-timeline-chart');
      const tl = result.timeline;
      const maxBalance = tl[0].total || 1;
      const step = Math.max(1, Math.floor(tl.length / 30));
      const sampled = tl.filter((_, i) => i % step === 0 || i === tl.length - 1);

      chart.innerHTML = `
        <div style="display:flex;align-items:flex-end;gap:2px;height:200px;">
          ${sampled.map(p => {
            const h = Math.max(1, (p.total / maxBalance) * 100);
            return `<div title="Month ${p.month}: ${fmtFull(p.total)}" style="flex:1;height:${h}%;background:linear-gradient(to top,#ef4444,#f97316);border-radius:2px 2px 0 0;min-width:3px;transition:height 0.3s;cursor:pointer;"></div>`;
          }).join('')}
        </div>
        <div style="display:flex;justify-content:space-between;font-size:0.7rem;color:var(--text-secondary);margin-top:0.5rem;">
          <span>Month 0</span><span>Month ${result.months}</span>
        </div>`;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  PDF EXPORT & COPY RESULTS (All Calculators)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function generatePDFReport(calcName) {
      const date = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
      let assumptions = '';
      let resultsText = '';
      const gv = (id) => { const el = document.getElementById(id); return el ? (el.value || el.textContent || '') : ''; };
      const gvf = (id) => fmtFull(parseFloat(gv(id)) || 0);

      const calcMap = {
        'Business Valuation (DCF)': () => {
          assumptions = `<tr><td>Annual FCF</td><td>${gvf('dcf-fcf')}</td></tr><tr><td>Growth Rate</td><td>${gv('dcf-growth')}%</td></tr><tr><td>Terminal Growth</td><td>${gv('dcf-terminal')}%</td></tr><tr><td>WACC</td><td>${gv('dcf-wacc')}%</td></tr><tr><td>Years</td><td>${gv('dcf-years')}</td></tr><tr><td>Net Debt</td><td>${gvf('dcf-debt')}</td></tr>`;
          resultsText = (document.getElementById('dcf-results') || {}).innerText || '';
        },
        'Business Valuation (Multiples)': () => {
          assumptions = `<tr><td>Revenue</td><td>${gvf('mult-revenue')}</td></tr><tr><td>EBITDA</td><td>${gvf('mult-ebitda')}</td></tr><tr><td>Net Income</td><td>${gvf('mult-income')}</td></tr><tr><td>EV/Revenue</td><td>${gv('mult-ev-rev')}x</td></tr><tr><td>EV/EBITDA</td><td>${gv('mult-ev-ebitda')}x</td></tr><tr><td>P/E</td><td>${gv('mult-pe')}x</td></tr>`;
          resultsText = (document.getElementById('multiples-results') || {}).innerText || '';
        },
        'Business Valuation (Asset-Based)': () => {
          assumptions = `<tr><td>Cash</td><td>${gvf('asset-cash')}</td></tr><tr><td>A/R</td><td>${gvf('asset-ar')}</td></tr><tr><td>Inventory</td><td>${gvf('asset-inv')}</td></tr><tr><td>PP&E</td><td>${gvf('asset-ppe')}</td></tr><tr><td>A/P</td><td>${gvf('asset-ap')}</td></tr><tr><td>Debt</td><td>${gvf('asset-debt')}</td></tr>`;
          resultsText = (document.getElementById('asset-results') || {}).innerText || '';
        },
        'Canadian Mortgage Calculator': () => {
          assumptions = `<tr><td>Home Price</td><td>${gvf('mort-price')}</td></tr><tr><td>Down Payment</td><td>${gv('mort-down')}%</td></tr><tr><td>Rate</td><td>${gv('mort-rate')}%</td></tr><tr><td>Amortization</td><td>${gv('mort-amort')} yrs</td></tr>`;
          resultsText = (document.getElementById('mortgage-results') || {}).innerText || '';
        },
        'Investment Returns (CAGR)': () => {
          assumptions = `<tr><td>Initial</td><td>${gvf('cagr-initial')}</td></tr><tr><td>Final</td><td>${gvf('cagr-final')}</td></tr><tr><td>Period</td><td>${gv('cagr-years')} yrs</td></tr>`;
          resultsText = (document.getElementById('cagr-results') || {}).innerText || '';
        },
        'Investment Returns (DCA)': () => {
          assumptions = `<tr><td>Monthly</td><td>${gvf('dca-monthly')}</td></tr><tr><td>Return</td><td>${gv('dca-return')}%</td></tr><tr><td>Years</td><td>${gv('dca-years')}</td></tr><tr><td>Initial</td><td>${gvf('dca-initial')}</td></tr><tr><td>Inflation</td><td>${gv('dca-inflation')}%</td></tr>`;
          resultsText = (document.getElementById('dca-results') || {}).innerText || '';
        },
        'RRSP vs TFSA Optimizer': () => {
          assumptions = `<tr><td>Income</td><td>${gvf('ret-income')}</td></tr><tr><td>Contribution</td><td>${gvf('ret-contribution')}</td></tr><tr><td>Age</td><td>${gv('ret-age')}</td></tr><tr><td>Retire Age</td><td>${gv('ret-retire-age')}</td></tr><tr><td>Return</td><td>${gv('ret-return')}%</td></tr>`;
          resultsText = (document.getElementById('retirement-results') || {}).innerText || '';
        },
        'Compound Interest': () => {
          assumptions = `<tr><td>Initial</td><td>${gvf('comp-initial')}</td></tr><tr><td>Monthly</td><td>${gvf('comp-monthly')}</td></tr><tr><td>Rate</td><td>${gv('comp-rate')}%</td></tr><tr><td>Years</td><td>${gv('comp-years')}</td></tr>`;
          resultsText = (document.getElementById('compound-results') || {}).innerText || '';
        },
        'M&A Deal Analyzer': () => {
          assumptions = `<tr><td>Acquirer EPS</td><td>$${gv('ma-acq-eps')}</td></tr><tr><td>Target EPS</td><td>$${gv('ma-tgt-eps')}</td></tr><tr><td>Premium</td><td>${gv('ma-premium')}%</td></tr>`;
          resultsText = (document.getElementById('ma-results') || {}).innerText || '';
        },
        'Startup Runway': () => {
          assumptions = `<tr><td>Cash</td><td>${gvf('rw-cash')}</td></tr><tr><td>Revenue</td><td>${gvf('rw-revenue')}</td></tr><tr><td>Growth</td><td>${gv('rw-growth')}%</td></tr><tr><td>Fixed Costs</td><td>${gvf('rw-fixed')}</td></tr>`;
          resultsText = 'Burn Rate: ' + gv('rw-burn') + '\nRunway: ' + gv('rw-runway-growth') + '\nCash Zero: ' + gv('rw-zero-date');
        },
        'Net Worth Tracker': () => {
          assumptions = `<tr><td>Assets</td><td>${gv('nw-total-assets')}</td></tr><tr><td>Liabilities</td><td>${gv('nw-total-liabilities')}</td></tr>`;
          resultsText = 'Net Worth: ' + gv('nw-networth') + '\nLiquid: ' + gv('nw-liquid');
        }
      };

      if (calcMap[calcName]) calcMap[calcName]();

      const html = '<!DOCTYPE html><html><head><title>Babaganoush - ' + calcName + '</title><style>@media print{body{-webkit-print-color-adjust:exact;print-color-adjust:exact}.no-print{display:none!important}}body{font-family:Segoe UI,Arial,sans-serif;max-width:700px;margin:0 auto;padding:2rem;color:#1a1a2e}.header{text-align:center;border-bottom:3px solid #6366f1;padding-bottom:1rem;margin-bottom:2rem}.header h1{color:#6366f1;margin:0;font-size:1.8rem}.header .brand{font-size:.9rem;color:#888;margin-top:.25rem}.header .date{font-size:.8rem;color:#999;margin-top:.5rem}h2{color:#333;font-size:1.1rem;border-bottom:1px solid #eee;padding-bottom:.5rem}table{width:100%;border-collapse:collapse;margin:1rem 0}td{padding:.5rem .75rem;border-bottom:1px solid #eee;font-size:.9rem}td:first-child{color:#666;width:50%}td:last-child{font-weight:600;text-align:right}.results{background:#f8f8ff;border-radius:8px;padding:1.5rem;margin:1.5rem 0;white-space:pre-line;font-size:.9rem;line-height:1.8}.disclaimer{margin-top:2rem;padding-top:1rem;border-top:1px solid #ddd;font-size:.72rem;color:#999;text-align:center}.print-btn{display:block;margin:1rem auto;padding:.75rem 2rem;background:#6366f1;color:white;border:none;border-radius:8px;font-size:1rem;cursor:pointer}</style></head><body><div class="header"><h1>\ud83e\uddee ' + calcName + '</h1><div class="brand">Babaganoush \u2014 Smart Financial Tools</div><div class="date">Generated: ' + date + '</div></div><h2>\ud83d\udccb Input Assumptions</h2><table>' + assumptions + '</table><h2>\ud83d\udcca Results</h2><div class="results">' + resultsText.replace(/\n/g, '<br>') + '</div><div class="disclaimer"><p><strong>Disclaimer:</strong> This report is for informational and educational purposes only. It does not constitute financial, investment, tax, or legal advice. Consult a qualified professional before making financial decisions.</p><p>\u00a9 ' + new Date().getFullYear() + ' Babaganoush \u00b7 babaganoush.ca</p></div><button class="print-btn no-print" onclick="window.print()">\ud83d\udda8\ufe0f Print / Save as PDF</button></body></html>';

      const w = window.open('', '_blank');
      w.document.write(html);
      w.document.close();
    }

    function copyResults(calcName) {
      let text = '\ud83d\udcca ' + calcName + ' \u2014 Babaganoush Report\n' + '\u2500'.repeat(40) + '\n';
      const resultIds = {
        'Business Valuation (DCF)': 'dcf-results',
        'Business Valuation (Multiples)': 'multiples-results',
        'Business Valuation (Asset-Based)': 'asset-results',
        'Canadian Mortgage Calculator': 'mortgage-results',
        'Investment Returns (CAGR)': 'cagr-results',
        'Investment Returns (DCA)': 'dca-results',
        'RRSP vs TFSA Optimizer': 'retirement-results',
        'Compound Interest': 'compound-results',
        'M&A Deal Analyzer': 'ma-results'
      };
      if (resultIds[calcName]) {
        const el = document.getElementById(resultIds[calcName]);
        if (el) text += el.innerText;
      } else if (calcName === 'Startup Runway') {
        text += 'Burn Rate: ' + document.getElementById('rw-burn').textContent + '\n';
        text += 'Runway: ' + document.getElementById('rw-runway-growth').textContent + '\n';
        text += 'Cash Zero: ' + document.getElementById('rw-zero-date').textContent + '\n';
      } else if (calcName === 'Net Worth Tracker') {
        text += 'Assets: ' + document.getElementById('nw-total-assets').textContent + '\n';
        text += 'Liabilities: ' + document.getElementById('nw-total-liabilities').textContent + '\n';
        text += 'Net Worth: ' + document.getElementById('nw-networth').textContent + '\n';
      }
      text += '\n' + '\u2500'.repeat(40) + '\nGenerated by Babaganoush \u00b7 babaganoush.ca';
      navigator.clipboard.writeText(text).then(showCopyToast).catch(function() {
        const ta = document.createElement('textarea'); ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); showCopyToast();
      });
    }

    function showCopyToast() {
      const existing = document.querySelector('.copy-toast');
      if (existing) existing.remove();
      const toast = document.createElement('div');
      toast.className = 'toast-success copy-toast';
      toast.innerHTML = '\ud83d\udccb Results copied!';
      document.body.appendChild(toast);
      setTimeout(function() { toast.remove(); }, 2500);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  VALUATION COMPARISON CHART
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function updateValuationComparison() {
      const compare = document.getElementById('val-compare');
      const chart = document.getElementById('val-compare-chart');
      if (!compare || !chart) return;

      let values = [];

      // DCF value
      try {
        const fcf = parseFloat(document.getElementById('dcf-fcf').value) || 0;
        const growth = (parseFloat(document.getElementById('dcf-growth').value) || 0) / 100;
        const terminal = (parseFloat(document.getElementById('dcf-terminal').value) || 0) / 100;
        const wacc = (parseFloat(document.getElementById('dcf-wacc').value) || 0) / 100;
        const years = parseInt(document.getElementById('dcf-years').value) || 5;
        const debt = parseFloat(document.getElementById('dcf-debt').value) || 0;
        if (wacc > terminal && fcf > 0) {
          let pv = 0;
          for (let i = 1; i <= years; i++) pv += (fcf * Math.pow(1 + growth, i)) / Math.pow(1 + wacc, i);
          const ff = fcf * Math.pow(1 + growth, years) * (1 + terminal);
          const tv = ff / (wacc - terminal);
          pv += tv / Math.pow(1 + wacc, years);
          values.push({ label: 'DCF', value: pv - debt, color: '#6366f1' });
        }
      } catch(e) {}

      // Multiples
      try {
        const rev = parseFloat(document.getElementById('mult-revenue').value) || 0;
        const ebitda = parseFloat(document.getElementById('mult-ebitda').value) || 0;
        const income = parseFloat(document.getElementById('mult-income').value) || 0;
        const evRev = parseFloat(document.getElementById('mult-ev-rev').value) || 0;
        const evEb = parseFloat(document.getElementById('mult-ev-ebitda').value) || 0;
        const pe = parseFloat(document.getElementById('mult-pe').value) || 0;
        const avg = (rev * evRev + ebitda * evEb + income * pe) / 3;
        if (avg > 0) values.push({ label: 'Multiples (Avg)', value: avg, color: '#8b5cf6' });
      } catch(e) {}

      // Asset
      try {
        const totalA = ['asset-cash','asset-ar','asset-inv','asset-ppe','asset-other'].reduce((s,id) => s + (parseFloat(document.getElementById(id).value)||0), 0);
        const totalL = ['asset-ap','asset-debt','asset-otherliab'].reduce((s,id) => s + (parseFloat(document.getElementById(id).value)||0), 0);
        const nav = totalA - totalL;
        if (nav !== 0) values.push({ label: 'Asset-Based (NAV)', value: nav, color: '#06b6d4' });
      } catch(e) {}

      if (values.length < 2) { compare.style.display = 'none'; return; }
      compare.style.display = 'block';

      const maxVal = Math.max(...values.map(v => Math.abs(v.value)));
      let html = '';
      values.forEach(v => {
        const pct = Math.abs(v.value) / maxVal * 100;
        html += '<div style="margin-bottom: 1rem;"><div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;"><span style="font-size: 0.85rem; font-weight: 600;">' + v.label + '</span><span class="mono" style="font-size: 0.85rem;">' + fmt(v.value) + '</span></div><div class="chart-bar"><div class="chart-bar-fill" style="width: ' + pct.toFixed(1) + '%; background: ' + v.color + ';"></div></div></div>';
      });

      const vals = values.map(v => v.value);
      const low = Math.min(...vals);
      const high = Math.max(...vals);
      const avg = vals.reduce((a,b) => a+b, 0) / vals.length;
      html += '<div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-muted); border-top: 1px solid var(--border-primary); padding-top: 0.75rem; margin-top: 0.5rem;"><span>Low: ' + fmt(low) + '</span><span>Average: ' + fmt(avg) + '</span><span>High: ' + fmt(high) + '</span></div>';

      chart.innerHTML = html;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  DEBOUNCE UTILITY (Performance)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function debounce(fn, ms) {
      let timer;
      return function() {
        const args = arguments, ctx = this;
        clearTimeout(timer);
        timer = setTimeout(function() { fn.apply(ctx, args); }, ms);
      };
    }

    // Debounce all slider inputs (50ms)
    (function() {
      const debouncedHandlers = new WeakMap();
      document.querySelectorAll('input[type="range"]').forEach(function(slider) {
        const origHandler = slider.getAttribute('oninput');
        if (origHandler) {
          const debouncedFn = debounce(function() {
            new Function(origHandler).call(slider);
          }, 50);
          // Keep display updates instant, debounce calculations
          slider.removeAttribute('oninput');
          slider.addEventListener('input', function() {
            // Update display value instantly (the span next to slider)
            const displayPart = origHandler.match(/document\.getElementById\([^)]+\)\.textContent\s*=\s*[^;]+/);
            if (displayPart) { try { new Function(displayPart[0]).call(slider); } catch(e){} }
            debouncedFn();
          });
        }
      });
    })();

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  KEYBOARD SHORTCUTS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    (function() {
      const toolMap = {
        '1': 'valuation',
        '2': 'merger',
        '3': 'mortgage',
        '4': 'investment',
        '5': 'retirement',
        '6': 'compound',
        '7': 'runway',
        '8': 'networth'
      };

      document.addEventListener('keydown', function(e) {
        // Don't trigger when typing in inputs
        const tag = (e.target.tagName || '').toLowerCase();
        if (tag === 'input' || tag === 'textarea' || tag === 'select') return;

        const overlay = document.getElementById('shortcuts-overlay');

        if (e.key === '?') {
          e.preventDefault();
          overlay.classList.toggle('hidden');
          return;
        }

        if (e.key === 'Escape') {
          if (!overlay.classList.contains('hidden')) {
            overlay.classList.add('hidden');
          } else {
            showPage('home');
          }
          return;
        }

        if ((e.key === 'd' || e.key === 'D') && !e.ctrlKey && !e.metaKey) {
          toggleTheme();
          return;
        }

        if (toolMap[e.key]) {
          e.preventDefault();
          showPage(toolMap[e.key]);
        }
      });
    })();

    // â”€â”€ Global Calculation Counter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function incrementCalcCounter() {
      var count = parseInt(localStorage.getItem('babaganoush-calc-count') || '0', 10) + 1;
      localStorage.setItem('babaganoush-calc-count', count.toString());
      var el = document.getElementById('global-calc-counter');
      if (el) el.textContent = count.toLocaleString();
    }
    (function initCounter() {
      var count = parseInt(localStorage.getItem('babaganoush-calc-count') || '0', 10);
      var el = document.getElementById('global-calc-counter');
      if (el) el.textContent = count > 0 ? count.toLocaleString() : '0';
    })();

    // â”€â”€ Side-by-Side Comparison â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function calcMortgagePayment(principal, annualRate, amortYears) {
      // Canadian semi-annual compounding
      var semiRate = annualRate / 100 / 2;
      var monthlyRate = Math.pow(1 + semiRate, 1/6) - 1;
      var n = amortYears * 12;
      if (monthlyRate === 0) return { payment: principal / n, totalInterest: 0, totalCost: principal };
      var payment = principal * monthlyRate * Math.pow(1 + monthlyRate, n) / (Math.pow(1 + monthlyRate, n) - 1);
      var totalCost = payment * n;
      return { payment: payment, totalInterest: totalCost - principal, totalCost: totalCost };
    }

    function calculateComparison() {
      incrementCalcCounter();
      var aPrice = parseFloat(document.getElementById('cmp-a-price').value) || 0;
      var aRate = parseFloat(document.getElementById('cmp-a-rate').value) || 0;
      var aAmort = parseInt(document.getElementById('cmp-a-amort').value) || 25;
      var aDown = parseFloat(document.getElementById('cmp-a-down').value) || 0;
      var bPrice = parseFloat(document.getElementById('cmp-b-price').value) || 0;
      var bRate = parseFloat(document.getElementById('cmp-b-rate').value) || 0;
      var bAmort = parseInt(document.getElementById('cmp-b-amort').value) || 25;
      var bDown = parseFloat(document.getElementById('cmp-b-down').value) || 0;

      var aPrincipal = aPrice * (1 - aDown / 100);
      var bPrincipal = bPrice * (1 - bDown / 100);
      var a = calcMortgagePayment(aPrincipal, aRate, aAmort);
      var b = calcMortgagePayment(bPrincipal, bRate, bAmort);

      document.getElementById('cmp-a-payment').textContent = fmtFull(a.payment);
      document.getElementById('cmp-b-payment').textContent = fmtFull(b.payment);
      document.getElementById('cmp-a-interest').textContent = fmtFull(a.totalInterest);
      document.getElementById('cmp-b-interest').textContent = fmtFull(b.totalInterest);
      document.getElementById('cmp-a-total').textContent = fmtFull(a.totalCost);
      document.getElementById('cmp-b-total').textContent = fmtFull(b.totalCost);

      var diff = Math.abs(a.totalCost - b.totalCost);
      var verdict = '';
      if (a.totalCost < b.totalCost) {
        verdict = 'ğŸ…°ï¸ Scenario A saves you ' + fmtFull(diff) + ' in total cost over its term!';
      } else if (b.totalCost < a.totalCost) {
        verdict = 'ğŸ…±ï¸ Scenario B saves you ' + fmtFull(diff) + ' in total cost over its term!';
      } else {
        verdict = 'Both scenarios have the same total cost.';
      }
      var pmtDiff = Math.abs(a.payment - b.payment);
      verdict += '\nMonthly payment difference: ' + fmtFull(pmtDiff);
      document.getElementById('cmp-verdict').innerHTML = verdict.replace(/\n/g, '<br>');
    }

    // â”€â”€ Currency Converter â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function convertCurrency() {
      incrementCalcCounter();
      var cad = parseFloat(document.getElementById('currency-amount').value) || 0;
      // Rates: how many foreign units per 1 CAD (derived from "how many CAD per 1 foreign")
      var usd = cad / 1.36;
      var eur = cad / 1.47;
      var gbp = cad / 1.72;
      var inr = cad / 0.016;
      var jpy = cad / 0.009;
      document.getElementById('cur-usd').textContent = '$' + usd.toFixed(2);
      document.getElementById('cur-eur').textContent = 'â‚¬' + eur.toFixed(2);
      document.getElementById('cur-gbp').textContent = 'Â£' + gbp.toFixed(2);
      document.getElementById('cur-inr').textContent = 'â‚¹' + Math.round(inr).toLocaleString();
      document.getElementById('cur-jpy').textContent = 'Â¥' + Math.round(jpy).toLocaleString();
    }

    // â”€â”€ Patch existing calculators to increment counter â”€â”€
    (function patchCounters() {
      var fns = ['calculateDCF','calculateMultiples','calculateAsset','calculateMortgage',
        'calculateCAGR','calculateDCA','calculateRetirement','calculateCompound',
        'calculateMA','calculateRunway','calculateNetWorth','calculateSalary','calculateDebt'];
      fns.forEach(function(name) {
        var orig = window[name];
        if (typeof orig === 'function') {
          window[name] = function() {
            incrementCalcCounter();
            return orig.apply(this, arguments);
          };
        }
      });
    })();

    // Register Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(function(){});
    }
  </script>
</body>
</html>